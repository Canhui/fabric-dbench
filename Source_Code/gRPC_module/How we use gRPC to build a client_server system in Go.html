<!DOCTYPE html>
<!-- saved from url=(0095)https://medium.com/pantomath/how-we-use-grpc-to-build-a-client-server-system-in-go-dd20045fa1c2 -->
<html xmlns:cc="http://creativecommons.org/ns#"><head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# medium-com: http://ogp.me/ns/fb/medium-com#"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=contain"><title>How we use gRPC to build a client/server system in Go</title><link rel="canonical" href="https://medium.com/pantomath/how-we-use-grpc-to-build-a-client-server-system-in-go-dd20045fa1c2"><meta name="title" content="How we use gRPC to build a client/server system in Go"><meta name="referrer" content="always"><meta name="description" content="This post is a technical presentation on how we use gRPC (and Protobuf) to build a robust client/server system. I won’t go into the details of why we chose gRPC as the main communication protocol…"><meta name="theme-color" content="#000000"><meta property="og:title" content="How we use gRPC to build a client/server system in Go"><meta property="twitter:title" content="How we use gRPC to build a client/server system in Go"><meta property="og:url" content="https://medium.com/pantomath/how-we-use-grpc-to-build-a-client-server-system-in-go-dd20045fa1c2"><meta property="og:image" content="https://cdn-images-1.medium.com/max/1200/1*QIjD685SfIfFV-xXtdIofg.jpeg"><meta property="fb:app_id" content="542599432471018"><meta property="og:description" content="This post is a technical presentation on how we use gRPC (and Protobuf) to build a robust client/server system."><meta name="twitter:description" content="This post is a technical presentation on how we use gRPC (and Protobuf) to build a robust client/server system."><meta name="twitter:image:src" content="https://cdn-images-1.medium.com/max/1200/1*QIjD685SfIfFV-xXtdIofg.jpeg"><link rel="author" href="https://medium.com/@chilladx"><meta name="author" content="Julien Andrieux"><meta property="og:type" content="article"><meta name="twitter:card" content="summary_large_image"><meta property="article:publisher" content="https://www.facebook.com/medium"><meta property="article:author" content="Julien Andrieux"><meta name="robots" content="index, follow"><meta property="article:published_time" content="2017-10-09T16:01:01.651Z"><meta name="twitter:creator" content="@chilladx"><meta name="twitter:site" content="@Medium"><meta property="og:site_name" content="Medium"><meta name="twitter:label1" value="Reading time"><meta name="twitter:data1" value="19 min read"><meta name="twitter:app:name:iphone" content="Medium"><meta name="twitter:app:id:iphone" content="828256236"><meta name="twitter:app:url:iphone" content="medium://p/dd20045fa1c2"><meta property="al:ios:app_name" content="Medium"><meta property="al:ios:app_store_id" content="828256236"><meta property="al:android:package" content="com.medium.reader"><meta property="al:android:app_name" content="Medium"><meta property="al:ios:url" content="medium://p/dd20045fa1c2"><meta property="al:android:url" content="medium://p/dd20045fa1c2"><meta property="al:web:url" content="https://medium.com/pantomath/how-we-use-grpc-to-build-a-client-server-system-in-go-dd20045fa1c2"><link rel="search" type="application/opensearchdescription+xml" title="Medium" href="https://medium.com/osd.xml"><link rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/dd20045fa1c2"><script async="" src="./How we use gRPC to build a client_server system in Go_files/branch-latest.min.js.download"></script><script type="application/ld+json">{"@context":"http://schema.org","@type":"NewsArticle","image":{"@type":"ImageObject","width":1920,"height":1280,"url":"https://cdn-images-1.medium.com/max/1920/1*QIjD685SfIfFV-xXtdIofg.jpeg"},"url":"https://medium.com/pantomath/how-we-use-grpc-to-build-a-client-server-system-in-go-dd20045fa1c2","dateCreated":"2017-10-09T16:01:01.651Z","datePublished":"2017-10-09T16:01:01.651Z","dateModified":"2018-06-20T01:45:10.767Z","headline":"How we use gRPC to build a client/server system in Go","name":"How we use gRPC to build a client/server system in Go","articleId":"dd20045fa1c2","thumbnailUrl":"https://cdn-images-1.medium.com/max/1920/1*QIjD685SfIfFV-xXtdIofg.jpeg","keywords":["Tag:Golang","Tag:Grpc","Tag:Protobuf","Tag:Tutorial","Tag:API","Publication:pantomath","LockedPostSource:0","Elevated:false","LayerCake:0"],"author":{"@type":"Person","name":"Julien Andrieux","url":"https://medium.com/@chilladx"},"creator":["Julien Andrieux"],"publisher":{"@type":"Organization","name":"Pantomath","url":"https://medium.com/pantomath","logo":{"@type":"ImageObject","width":153,"height":60,"url":"https://cdn-images-1.medium.com/max/153/1*pDRgSnGnZl4rzF0vBdo1FA.png"}},"mainEntityOfPage":"https://medium.com/pantomath/how-we-use-grpc-to-build-a-client-server-system-in-go-dd20045fa1c2"}</script><meta name="parsely-link" content="https://medium.com/pantomath/how-we-use-grpc-to-build-a-client-server-system-in-go-dd20045fa1c2"><link rel="stylesheet" type="text/css" class="js-glyph-" id="glyph-8" href="./How we use gRPC to build a client_server system in Go_files/m2.css"><link rel="stylesheet" href="./How we use gRPC to build a client_server system in Go_files/main-branding-base.DUpq82k2YI6OvEW6173IfA.css"><script>!function(n,e){var t,o,i,c=[],f={passive:!0,capture:!0},r=new Date,a="pointerup",u="pointercancel";function p(n,c){t||(t=c,o=n,i=new Date,w(e),s())}function s(){o>=0&&o<i-r&&(c.forEach(function(n){n(o,t)}),c=[])}function l(t){if(t.cancelable){var o=(t.timeStamp>1e12?new Date:performance.now())-t.timeStamp;"pointerdown"==t.type?function(t,o){function i(){p(t,o),r()}function c(){r()}function r(){e(a,i,f),e(u,c,f)}n(a,i,f),n(u,c,f)}(o,t):p(o,t)}}function w(n){["click","mousedown","keydown","touchstart","pointerdown"].forEach(function(e){n(e,l,f)})}w(n),self.perfMetrics=self.perfMetrics||{},self.perfMetrics.onFirstInputDelay=function(n){c.push(n),s()}}(addEventListener,removeEventListener);</script><script>if (window.top !== window.self) window.top.location = window.self.location.href;var OB_startTime = new Date().getTime(); var OB_loadErrors = []; function _onerror(e) { OB_loadErrors.push(e) }; if (document.addEventListener) document.addEventListener("error", _onerror, true); else if (document.attachEvent) document.attachEvent("onerror", _onerror); function _asyncScript(u) {var d = document, f = d.getElementsByTagName("script")[0], s = d.createElement("script"); s.type = "text/javascript"; s.async = true; s.src = u; f.parentNode.insertBefore(s, f);}function _asyncStyles(u) {var d = document, f = d.getElementsByTagName("script")[0], s = d.createElement("link"); s.rel = "stylesheet"; s.href = u; f.parentNode.insertBefore(s, f); return s}(new Image()).src = "/_/stat?event=pixel.load&origin=" + encodeURIComponent(location.origin);</script><script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date; ga("create", "UA-24232453-2", "auto", {"allowLinker": true, "legacyCookieDomain": window.location.hostname}); ga("send", "pageview");</script><script async="" src="./How we use gRPC to build a client_server system in Go_files/analytics.js.download"></script><!--[if lt IE 9]><script charset="UTF-8" src="https://cdn-static-1.medium.com/_/fp/js/shiv.RI2ePTZ5gFmMgLzG5bEVAA.js"></script><![endif]--><link rel="icon" href="https://cdn-static-1.medium.com/_/fp/icons/favicon-rebrand-medium.3Y6xpZ-0FSdWDnPM3hSBIA.ico" class="js-favicon"><link rel="apple-touch-icon" sizes="152x152" href="https://cdn-images-1.medium.com/fit/c/152/152/1*3UOXOjhNOVBhUEeFY6s-aQ.png"><link rel="apple-touch-icon" sizes="120x120" href="https://cdn-images-1.medium.com/fit/c/120/120/1*3UOXOjhNOVBhUEeFY6s-aQ.png"><link rel="apple-touch-icon" sizes="76x76" href="https://cdn-images-1.medium.com/fit/c/76/76/1*3UOXOjhNOVBhUEeFY6s-aQ.png"><link rel="apple-touch-icon" sizes="60x60" href="./How we use gRPC to build a client_server system in Go_files/1_3UOXOjhNOVBhUEeFY6s-aQ(1).png"><link rel="mask-icon" href="https://cdn-static-1.medium.com/_/fp/icons/monogram-mask.KPLCSFEZviQN0jQ7veN2RQ.svg" color="#171717"></head><body itemscope="" class="postShowScreen browser-chrome os-windows is-withMagicUnderlines v-glyph v-glyph--m2 is-js" data-action-scope="_actionscope_0"><script>document.body.className = document.body.className.replace(/(^|\s)is-noJs(\s|$)/, "$1is-js$2")</script><div class="site-main surface-container" id="container"><div class="butterBar butterBar--error" data-action-scope="_actionscope_1"></div><div class="surface" id="_obv.shell._surface_1562849862795" style="display: block; visibility: visible;"><div class="screenContent surface-content is-supplementalPostContentLoaded" data-used="true" data-action-scope="_actionscope_2"><canvas class="canvas-renderer" width="1263" height="913"></canvas><div class="container u-maxWidth740 u-xs-margin0 notesPositionContainer js-notesPositionContainer"><div class="notesMarkers" data-action-scope="_actionscope_4"></div></div><div class="metabar u-clearfix u-boxShadow4px12pxBlackLightest js-metabar is-hiddenWhenMinimized is-maximized"><div class="branch-journeys-top"></div><div class="js-metabarMiddle metabar-inner u-marginAuto u-maxWidth1032 u-flexCenter u-justifyContentSpaceBetween u-height65 u-xs-height56 u-paddingHorizontal20"><div class="metabar-block u-flex1 u-flexCenter"><div class="js-metabarLogoLeft"><a href="https://medium.com/" data-log-event="home" class="siteNav-logo u-fillTransparentBlackDarker u-flex0 u-flexCenter u-paddingTop0"><span class="svgIcon svgIcon--logoMonogram svgIcon--45px"><svg class="svgIcon-use" width="45" height="45"><path d="M5 40V5h35v35H5zm8.56-12.627c0 .555-.027.687-.318 1.03l-2.457 2.985v.396h6.974v-.396l-2.456-2.985c-.291-.343-.344-.502-.344-1.03V18.42l6.127 13.364h.714l5.256-13.364v10.644c0 .29 0 .342-.185.528l-1.848 1.796v.396h9.19v-.396l-1.822-1.796c-.184-.186-.21-.238-.21-.528V15.937c0-.291.026-.344.21-.528l1.823-1.797v-.396h-6.471l-4.622 11.542-5.203-11.542h-6.79v.396l2.14 2.64c.239.292.291.37.291.768v10.353z"></path></svg></span><span class="u-textScreenReader">Homepage</span></a></div><div class="u-flexCenter u-height65 u-xs-height56"><span class="u-inlineBlock u-height28 u-xs-height24 u-verticalAlignTop u-marginRight20 u-marginLeft15 u-borderRightLighter"></span></div><div class="u-flexCenter u-height65 u-xs-height56 u-marginRight18"><div class="u-xs-show"><a class="link u-baseColor--link avatar avatar--roundedRectangle" href="https://medium.com/pantomath?source=avatar-95d118929b4b-cf62d19c744" title="Go to Pantomath" aria-label="Go to Pantomath" data-action-source="avatar-95d118929b4b-cf62d19c744"><img src="./How we use gRPC to build a client_server system in Go_files/1_3UOXOjhNOVBhUEeFY6s-aQ.png" class="avatar-image avatar-image--icon" alt="Pantomath"></a></div><div class="u-xs-hide"><a href="https://medium.com/pantomath?source=logo-95d118929b4b---cf62d19c744" class="u-flexCenter js-collectionLogoOrName"><img height="36" width="92" src="./How we use gRPC to build a client_server system in Go_files/1_pDRgSnGnZl4rzF0vBdo1FA.png" alt="Pantomath"></a></div></div></div><div class="metabar-block u-flex0 u-flexCenter"><div class="u-flexCenter u-height65 u-xs-height56"><div class="buttonSet buttonSet--wide u-lineHeightInherit"><label class="button button--small button--chromeless button--withIcon button--withSvgIcon inputGroup u-sm-hide metabar-predictiveSearch u-baseColor--buttonNormal u-baseColor--placeholderNormal" title="Search Pantomath"><span class="svgIcon svgIcon--search svgIcon--25px u-baseColor--iconLight"><svg class="svgIcon-use" width="25" height="25"><path d="M20.067 18.933l-4.157-4.157a6 6 0 1 0-.884.884l4.157 4.157a.624.624 0 1 0 .884-.884zM6.5 11c0-2.62 2.13-4.75 4.75-4.75S16 8.38 16 11s-2.13 4.75-4.75 4.75S6.5 13.62 6.5 11z"></path></svg></span><input class="js-predictiveSearchInput textInput textInput--rounded textInput--darkText u-baseColor--textNormal textInput--transparent" type="search" placeholder="Search Pantomath" required="true" data-collection-id="cf62d19c744"></label><a class="button button--small button--chromeless u-sm-show is-inSiteNavBar u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--chromeless u-xs-top1" href="https://medium.com/pantomath/search" title="Search" aria-label="Search"><span class="button-defaultState"><span class="svgIcon svgIcon--search svgIcon--25px"><svg class="svgIcon-use" width="25" height="25"><path d="M20.067 18.933l-4.157-4.157a6 6 0 1 0-.884.884l4.157 4.157a.624.624 0 1 0 .884-.884zM6.5 11c0-2.62 2.13-4.75 4.75-4.75S16 8.38 16 11s-2.13 4.75-4.75 4.75S6.5 13.62 6.5 11z"></path></svg></span></span></a><button class="button button--small button--chromeless is-inSiteNavBar u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--activity js-notificationsButton u-marginRight16 u-xs-marginRight10 u-lineHeight0 u-size25x25" title="Notifications" aria-label="Notifications" data-action="open-notifications"><span class="svgIcon svgIcon--bell svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="-293 409 25 25"><path d="M-273.327 423.67l-1.673-1.52v-3.646a5.5 5.5 0 0 0-6.04-5.474c-2.86.273-4.96 2.838-4.96 5.71v3.41l-1.68 1.553c-.204.19-.32.456-.32.734V427a1 1 0 0 0 1 1h3.49a3.079 3.079 0 0 0 3.01 2.45 3.08 3.08 0 0 0 3.01-2.45h3.49a1 1 0 0 0 1-1v-2.59c0-.28-.12-.55-.327-.74zm-7.173 5.63c-.842 0-1.55-.546-1.812-1.3h3.624a1.92 1.92 0 0 1-1.812 1.3zm6.35-2.45h-12.7v-2.347l1.63-1.51c.236-.216.37-.522.37-.843v-3.41c0-2.35 1.72-4.356 3.92-4.565a4.353 4.353 0 0 1 4.78 4.33v3.645c0 .324.137.633.376.85l1.624 1.477v2.373z"></path></svg></span></button><button class="button button--chromeless u-baseColor--buttonNormal is-inSiteNavBar js-userActions" aria-haspopup="true" data-action="open-userActions"><div class="avatar"><img src="./How we use gRPC to build a client_server system in Go_files/0_mvxMeosUAuHk7G38.jpg" class="avatar-image avatar-image--icon" alt="Canhui WANG"></div></button></div></div></div></div></div><div class="metabar metabar--spacer js-metabarSpacer u-height65 u-xs-height56"></div><main role="main"><article class=" u-minHeight100vhOffset65 u-overflowHidden postArticle postArticle--full is-withAccentColors" lang="en"><div class="postArticle-content js-postField js-notesSource js-trackPostScrolls" data-post-id="dd20045fa1c2" data-source="post_page" data-collection-id="cf62d19c744" data-tracking-context="postPage" data-scroll="native"><section name="a6ac" class="section section--body section--first"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h1 name="68d3" id="68d3" class="graf graf--h3 graf--leading graf--title">How we use gRPC to build a client/server system in&nbsp;Go</h1><div class="uiScale uiScale-ui--regular uiScale-caption--regular u-flexCenter u-marginVertical24 u-fontSize15 js-postMetaLockup"><div class="u-flex0"><a class="link u-baseColor--link avatar" href="https://medium.com/@chilladx?source=post_header_lockup" data-action="show-user-card" data-action-source="post_header_lockup" data-action-value="2f5a2cbeb497" data-action-type="hover" data-user-id="2f5a2cbeb497" dir="auto"><img src="./How we use gRPC to build a client_server system in Go_files/1_uZ56OzX2vlJdTqfmMIruUg.jpeg" class="avatar-image u-size50x50" alt="Go to the profile of Julien Andrieux"></a></div><div class="u-flex1 u-paddingLeft15 u-overflowHidden"><div class="u-paddingBottom3"><a class="ds-link ds-link--styleSubtle ui-captionStrong u-inlineBlock link link--darken link--darker" href="https://medium.com/@chilladx" data-action="show-user-card" data-action-value="2f5a2cbeb497" data-action-type="hover" data-user-id="2f5a2cbeb497" dir="auto">Julien Andrieux</a><span class="followState js-followState" data-user-id="2f5a2cbeb497"><button class="button button--smallest u-noUserSelect button--withChrome u-baseColor--buttonNormal button--withHover button--unblock js-unblockButton u-marginLeft10 u-xs-hide" data-action="toggle-block-user" data-action-value="2f5a2cbeb497" data-action-source="post_header_lockup"><span class="button-label  button-defaultState">Blocked</span><span class="button-label button-hoverState">Unblock</span></button><button class="button button--primary button--smallest button--dark u-noUserSelect button--withChrome u-accentColor--buttonDark button--follow js-followButton u-marginLeft10 u-xs-hide" data-action="toggle-subscribe-user" data-action-value="2f5a2cbeb497" data-action-source="post_header_lockup-2f5a2cbeb497-------------------------follow_byline" data-subscribe-source="post_header_lockup" data-follow-context-entity-id="dd20045fa1c2"><span class="button-label  button-defaultState js-buttonLabel">Follow</span><span class="button-label button-activeState">Following</span></button></span></div><div class="ui-caption u-noWrapWithEllipsis js-testPostMetaInlineSupplemental"><time datetime="2017-10-09T16:01:01.651Z">Oct 10, 2017</time><span class="middotDivider u-fontSize12"></span><span class="readingTime" title="19 min read"></span></div></div></div></div><div class="section-inner sectionLayout--outsetColumn"><figure name="2de7" id="2de7" class="graf graf--figure graf--layoutOutsetCenter graf-after--h3" data-scroll="native"><div class="aspectRatioPlaceholder is-locked" style="max-width: 1032px; max-height: 688px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 66.7%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*QIjD685SfIfFV-xXtdIofg.jpeg" data-width="5607" data-height="3738" data-action="zoom" data-action-value="1*QIjD685SfIfFV-xXtdIofg.jpeg" data-scroll="native"><img src="./How we use gRPC to build a client_server system in Go_files/1_QIjD685SfIfFV-xXtdIofg.jpeg" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="50"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1200/1*QIjD685SfIfFV-xXtdIofg.jpeg" src="./How we use gRPC to build a client_server system in Go_files/1_QIjD685SfIfFV-xXtdIofg(1).jpeg"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1200/1*QIjD685SfIfFV-xXtdIofg.jpeg"></noscript></div></div><figcaption class="imageCaption">Photo by <a href="https://unsplash.com/photos/6uWHZ74S5Rk?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" data-href="https://unsplash.com/photos/6uWHZ74S5Rk?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" class="markup--anchor markup--figure-anchor" rel="nofollow noopener" target="_blank">Igor Ovsyannykov</a> on&nbsp;<a href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" data-href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" class="markup--anchor markup--figure-anchor" rel="nofollow noopener" target="_blank">Unsplash</a></figcaption></figure></div><div class="section-inner sectionLayout--insetColumn"><p name="1734" id="1734" class="graf graf--p graf-after--figure">This post is a technical presentation on how we use <a href="https://grpc.io/" data-href="https://grpc.io/" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">gRPC</a> (and <a href="https://developers.google.com/protocol-buffers/" data-href="https://developers.google.com/protocol-buffers/" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">Protobuf</a>) to build a robust client/server system.</p><p name="890a" id="890a" class="graf graf--p graf-after--p">I won’t go into the details of why we chose gRPC as the main communication protocol between our client and server, a lot of great posts already cover the subject (like <a href="https://grpc.io/blog/vendastagrpc" data-href="https://grpc.io/blog/vendastagrpc" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">this one</a>, <a href="https://stackoverflow.com/questions/43682366/how-is-grpc-different-from-rest" data-href="https://stackoverflow.com/questions/43682366/how-is-grpc-different-from-rest" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">this one</a> or <a href="https://thenewstack.io/grpc-lean-mean-communication-protocol-microservices/" data-href="https://thenewstack.io/grpc-lean-mean-communication-protocol-microservices/" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">this one</a>). But just to get the big picture: we are building a client-server system, using <a href="https://golang.org/" data-href="https://golang.org/" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">Go</a>, that needs to be fast, reliable, and that scales (thus we chose gRPC). We wanted the communication between the client and the server to be as small as possible, as secure as possible and fully compliant with both ends (thus we chose <a href="https://developers.google.com/protocol-buffers/" data-href="https://developers.google.com/protocol-buffers/" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">Protobuf</a>).</p><p name="e13c" id="e13c" class="graf graf--p graf-after--p">We also wanted to expose another interface on the server side, just in case we add a client that has no compatible gRPC implementation: a traditional REST interface. And we wanted that at (almost) no cost.</p><h3 name="fd49" id="fd49" class="graf graf--h3 graf-after--p">Context</h3><p name="db00" id="db00" class="graf graf--p graf-after--h3">We will start building a very simple client/server system, in Go, that will just exchange dummy messages. Once both communicate and understand each other, we’ll add extra features, such as TLS support, authentication, and a REST API.</p><p name="fb14" id="fb14" class="graf graf--p graf-after--p">The rest of this articles assumes you understand basic Go programming. It also assumes that you have <code class="markup--code markup--p-code">protobuf</code> package installed, and the <code class="markup--code markup--p-code">protoc</code>command available (once again, many posts cover that topic, and there’s the <a href="https://developers.google.com/protocol-buffers/docs/proto3" data-href="https://developers.google.com/protocol-buffers/docs/proto3" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">official documentation</a>).<br>You will also need to install Go dependencies, such as the <a href="http://github.com/golang/protobuf" data-href="http://github.com/golang/protobuf" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">go implementation for protobuf</a>, and <a href="https://github.com/grpc-ecosystem/grpc-gateway" data-href="https://github.com/grpc-ecosystem/grpc-gateway" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">grpc-gateway</a>.</p><p name="809c" id="809c" class="graf graf--p graf-after--p">All the code shown in this post is available at <a href="https://gitlab.com/pantomath-io/demo-grpc" data-href="https://gitlab.com/pantomath-io/demo-grpc" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">https://gitlab.com/pantomath-io/demo-grpc</a>. So feel free to get the repository, and use the tags to navigate in it. The repository should be placed in the <code class="markup--code markup--p-code">src</code> folder of your <code class="markup--code markup--p-code">$GOPATH</code>:</p><pre name="957b" id="957b" class="graf graf--pre graf-after--p">$ go get -v -d gitlab.com/pantomath-io/demo-grpc<br>$ cd $GOPATH/src/gitlab.com/pantomath-io/demo-grpc</pre><h3 name="d85d" id="d85d" class="graf graf--h3 graf-after--pre">Defining the&nbsp;protocol</h3><p name="dd92" id="dd92" class="graf graf--p graf-after--h3"><em class="markup--em markup--p-em">git tag: </em><a href="https://gitlab.com/pantomath-io/demo-grpc/tree/init-protobuf-definiton" data-href="https://gitlab.com/pantomath-io/demo-grpc/tree/init-protobuf-definiton" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank"><em class="markup--em markup--p-em">init-protobuf-definition</em></a></p><figure name="c539" id="c539" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 465px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 66.4%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*N8g6AM5x4n64RCXYUjwtYQ.jpeg" data-width="4672" data-height="3104" data-action="zoom" data-action-value="1*N8g6AM5x4n64RCXYUjwtYQ.jpeg" data-scroll="native"><img src="./How we use gRPC to build a client_server system in Go_files/1_N8g6AM5x4n64RCXYUjwtYQ.jpeg" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="47"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/800/1*N8g6AM5x4n64RCXYUjwtYQ.jpeg" src="./How we use gRPC to build a client_server system in Go_files/1_N8g6AM5x4n64RCXYUjwtYQ(1).jpeg"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/800/1*N8g6AM5x4n64RCXYUjwtYQ.jpeg"></noscript></div></div><figcaption class="imageCaption">Photo by <a href="https://unsplash.com/photos/yri82tuk2TQ?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" data-href="https://unsplash.com/photos/yri82tuk2TQ?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" class="markup--anchor markup--figure-anchor" rel="nofollow noopener" target="_blank">Mark Rasmuson</a> on&nbsp;<a href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" data-href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" class="markup--anchor markup--figure-anchor" rel="nofollow noopener" target="_blank">Unsplash</a></figcaption></figure><p name="b3fb" id="b3fb" class="graf graf--p graf-after--figure">First of all, you need to define the protocol, i.e. to define what can be said between client and server, and how. This is where Protobuf comes into play. It allows you to define two things: Services and Messages. A <code class="markup--code markup--p-code">service</code> is a collection of actions the server can perform at the client’s request, a <code class="markup--code markup--p-code">message</code> is the content of this request. To simplify, you can say that <code class="markup--code markup--p-code">service</code> defines <strong class="markup--strong markup--p-strong">actions,</strong> while <code class="markup--code markup--p-code">message</code> defines <strong class="markup--strong markup--p-strong">objects</strong>.</p><p name="7cb0" id="7cb0" class="graf graf--p graf-after--p">Write the following in <code class="markup--code markup--p-code"><a href="https://gitlab.com/pantomath-io/demo-grpc/blob/init-protobuf-definition/api/api.proto" data-href="https://gitlab.com/pantomath-io/demo-grpc/blob/init-protobuf-definition/api/api.proto" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">api/api.proto</a></code>:</p><pre name="46bd" id="46bd" class="graf graf--pre graf-after--p">syntax = "proto3";<br>package api;</pre><pre name="2b97" id="2b97" class="graf graf--pre graf-after--pre">message PingMessage {<br>  string greeting = 1;<br>}</pre><pre name="f6ed" id="f6ed" class="graf graf--pre graf-after--pre">service Ping {<br>  rpc SayHello(PingMessage) returns (PingMessage) {}<br>}</pre><p name="8b80" id="8b80" class="graf graf--p graf-after--pre">So, you defined 2 things: a <code class="markup--code markup--p-code">service</code> called <code class="markup--code markup--p-code">Ping</code> that exposes a function called <code class="markup--code markup--p-code">SayHello</code> with an incoming <code class="markup--code markup--p-code">PingMessage</code> and returns a <code class="markup--code markup--p-code">PingMessage</code>&nbsp;; and a <code class="markup--code markup--p-code">message</code> called <code class="markup--code markup--p-code">PingMessage</code> that consists in a single field called <code class="markup--code markup--p-code">greeting</code> which is a <code class="markup--code markup--p-code">string</code>.<br>You also specified that you are using the <code class="markup--code markup--p-code">proto3</code> syntax, as opposed to <code class="markup--code markup--p-code">proto2 </code>(see <a href="https://developers.google.com/protocol-buffers/docs/proto3" data-href="https://developers.google.com/protocol-buffers/docs/proto3" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">documentation</a>).</p><p name="36e3" id="36e3" class="graf graf--p graf-after--p">This file is not usable like this: it needs to get compiled. Compiling the proto file means generating code for your chosen language, that your application will actually call.<br>In a shell, <code class="markup--code markup--p-code">cd</code> to the root directory of your project, and run the following command:</p><pre name="a2a7" id="a2a7" class="graf graf--pre graf-after--p">$ protoc -I api/ \<br>    -I${GOPATH}/src \<br>    --go_out=plugins=grpc:api \<br>    api/api.proto</pre><p name="bf6c" id="bf6c" class="graf graf--p graf-after--pre">This command generates the file <code class="markup--code markup--p-code">api/api.pb.go</code>, a Go source file that implements the gRPC code your application will use. You can look at it, but you shouldn’t change it (as it will be overwritten every time you run <code class="markup--code markup--p-code">protoc</code>).</p><p name="80d3" id="80d3" class="graf graf--p graf-after--p">You also need to define the function called by the <code class="markup--code markup--p-code">service Ping</code>, so create a file named <code class="markup--code markup--p-code">api/handler.go</code>:</p><pre name="0f0f" id="0f0f" class="graf graf--pre graf-after--p">package api</pre><pre name="573e" id="573e" class="graf graf--pre graf-after--pre">import (<br>  "log"</pre><pre name="46f7" id="46f7" class="graf graf--pre graf-after--pre">  "golang.org/x/net/context"<br>)</pre><pre name="8ce2" id="8ce2" class="graf graf--pre graf-after--pre">// Server represents the gRPC server<br>type Server struct {<br>}</pre><pre name="83c8" id="83c8" class="graf graf--pre graf-after--pre">// SayHello generates response to a Ping request<br>func (s *Server) SayHello(ctx context.Context, in *PingMessage) (*PingMessage, error) {<br>  log.Printf("Receive message %s", in.Greeting)<br>  return &amp;PingMessage{Greeting: "bar"}, nil<br>}</pre><ul class="postList"><li name="6a99" id="6a99" class="graf graf--li graf-after--pre">the <code class="markup--code markup--li-code">Server</code> <code class="markup--code markup--li-code">struct</code> is just an abstraction of the server. It allows to “attach” some resources to your server, making them available during the RPC calls;</li><li name="9ce8" id="9ce8" class="graf graf--li graf-after--li">the <code class="markup--code markup--li-code">SayHello</code> function is the one defined in the Protobuf file, as the <code class="markup--code markup--li-code">rpc</code> call for the <code class="markup--code markup--li-code">Ping</code> <code class="markup--code markup--li-code">service</code>. If you don’t define it, you won’t be able to create the gRPC server;</li><li name="215e" id="215e" class="graf graf--li graf-after--li"><code class="markup--code markup--li-code">SayHello</code> takes a <code class="markup--code markup--li-code">PingMessage</code> as parameter, and returns a <code class="markup--code markup--li-code">PingMessage</code>. The <code class="markup--code markup--li-code">PingMessage</code> <code class="markup--code markup--li-code">struct</code> is defined in the <code class="markup--code markup--li-code">api.pb.go</code> file auto-generated from the <code class="markup--code markup--li-code">api.proto</code> definition. The function also has a <code class="markup--code markup--li-code">Context</code> parameter (see further presentation in the official <a href="https://blog.golang.org/context" data-href="https://blog.golang.org/context" class="markup--anchor markup--li-anchor" rel="nofollow noopener" target="_blank">blog post</a>). You’ll see later what use you can do of the <code class="markup--code markup--li-code">Context</code>. On the other side, it also returns an <code class="markup--code markup--li-code">error</code>, in case something bad happens.</li></ul><h3 name="3995" id="3995" class="graf graf--h3 graf-after--li">Creating the simplest&nbsp;server</h3><p name="3df4" id="3df4" class="graf graf--p graf-after--h3"><em class="markup--em markup--p-em">git tag: </em><a href="https://gitlab.com/pantomath-io/demo-grpc/tags/init-server" data-href="https://gitlab.com/pantomath-io/demo-grpc/tags/init-server" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank"><em class="markup--em markup--p-em">init-server</em></a></p><figure name="66f3" id="66f3" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 467px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 66.7%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*Gy5Z3hBbB3r1GUkB75D_eg.jpeg" data-width="5461" data-height="3641" data-action="zoom" data-action-value="1*Gy5Z3hBbB3r1GUkB75D_eg.jpeg" data-scroll="native"><img src="./How we use gRPC to build a client_server system in Go_files/1_Gy5Z3hBbB3r1GUkB75D_eg.jpeg" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="50"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/800/1*Gy5Z3hBbB3r1GUkB75D_eg.jpeg" src="./How we use gRPC to build a client_server system in Go_files/1_Gy5Z3hBbB3r1GUkB75D_eg(1).jpeg"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/800/1*Gy5Z3hBbB3r1GUkB75D_eg.jpeg"></noscript></div></div><figcaption class="imageCaption">Photo by <a href="https://unsplash.com/photos/3CS0Ne4wBPw?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" data-href="https://unsplash.com/photos/3CS0Ne4wBPw?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" class="markup--anchor markup--figure-anchor" rel="nofollow noopener" target="_blank">Nathan Dumlao</a> on&nbsp;<a href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" data-href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" class="markup--anchor markup--figure-anchor" rel="nofollow noopener" target="_blank">Unsplash</a></figcaption></figure><p name="6b58" id="6b58" class="graf graf--p graf-after--figure">Now you have a protocol in place, you can create a simple server that implements the <code class="markup--code markup--p-code">service</code> and understands the <code class="markup--code markup--p-code">message</code>. Take your favorite editor and create the file <code class="markup--code markup--p-code"><a href="https://gitlab.com/pantomath-io/demo-grpc/blob/init-server/server/main.go" data-href="https://gitlab.com/pantomath-io/demo-grpc/blob/init-server/server/main.go" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">server/main.go</a></code>:</p><pre name="b958" id="b958" class="graf graf--pre graf-after--p">package main</pre><pre name="500e" id="500e" class="graf graf--pre graf-after--pre">import (<br>  "fmt"<br>  "log"<br>  "net"</pre><pre name="ae11" id="ae11" class="graf graf--pre graf-after--pre">  "gitlab.com/pantomath-io/demo-grpc/api"<br>  "google.golang.org/grpc"<br>)</pre><pre name="cc0a" id="cc0a" class="graf graf--pre graf-after--pre">// main start a gRPC server and waits for connection<br>func main() {<br>  // create a listener on TCP port 7777<br>  lis, err := net.Listen("tcp", fmt.Sprintf(":%d", 7777))<br>  if err != nil {<br>    log.Fatalf("failed to listen: %v", err)<br>  }</pre><pre name="bac7" id="bac7" class="graf graf--pre graf-after--pre">  // create a server instance<br>  s := api.Server{}</pre><pre name="938a" id="938a" class="graf graf--pre graf-after--pre">  // create a gRPC server object<br>  grpcServer := grpc.NewServer()</pre><pre name="11a7" id="11a7" class="graf graf--pre graf-after--pre">  // attach the Ping service to the server<br>  api.RegisterPingServer(grpcServer, &amp;s)</pre><pre name="7051" id="7051" class="graf graf--pre graf-after--pre">  // start the server<br>  if err := grpcServer.Serve(lis); err != nil {<br>    log.Fatalf("failed to serve: %s", err)<br>  }<br>}</pre><p name="6889" id="6889" class="graf graf--p graf-after--pre">Let me break down to code to make it clearer:</p><ul class="postList"><li name="11f3" id="11f3" class="graf graf--li graf-after--p">note that you import the <code class="markup--code markup--li-code">api</code> package, so that the Protobuf <code class="markup--code markup--li-code">service</code> handlers and the<code class="markup--code markup--li-code">Server</code> <code class="markup--code markup--li-code">struct</code> are available;</li><li name="9948" id="9948" class="graf graf--li graf-after--li">the <code class="markup--code markup--li-code">main</code> function starts by creating a TCP listener on the port you want to bind your gRPC server to;</li><li name="c292" id="c292" class="graf graf--li graf-after--li">then the rest is pretty straight forward: you create an instance of your <code class="markup--code markup--li-code">Server</code>, create an instance of a gRPC server, register the <code class="markup--code markup--li-code">service</code>, and start the gRPC server.</li></ul><p name="f5c6" id="f5c6" class="graf graf--p graf-after--li">You can compile your code to get a server binary:</p><pre name="55a2" id="55a2" class="graf graf--pre graf-after--p">$ go build -i -v -o bin/server gitlab.com/pantomath-io/demo-grpc/server</pre><h3 name="950a" id="950a" class="graf graf--h3 graf-after--pre">Creating the simplest&nbsp;client</h3><p name="9a4f" id="9a4f" class="graf graf--p graf-after--h3"><em class="markup--em markup--p-em">git tag: </em><a href="https://gitlab.com/pantomath-io/demo-grpc/tree/init-client" data-href="https://gitlab.com/pantomath-io/demo-grpc/tree/init-client" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank"><em class="markup--em markup--p-em">init-client</em></a></p><figure name="ca7c" id="ca7c" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 498px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 71.1%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*c6G6qANKUoyZn3awfRii1g.jpeg" data-width="5400" data-height="3841" data-action="zoom" data-action-value="1*c6G6qANKUoyZn3awfRii1g.jpeg" data-scroll="native"><img src="./How we use gRPC to build a client_server system in Go_files/1_c6G6qANKUoyZn3awfRii1g.jpeg" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="52"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/800/1*c6G6qANKUoyZn3awfRii1g.jpeg" src="./How we use gRPC to build a client_server system in Go_files/1_c6G6qANKUoyZn3awfRii1g(1).jpeg"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/800/1*c6G6qANKUoyZn3awfRii1g.jpeg"></noscript></div></div><figcaption class="imageCaption">Photo by <a href="https://unsplash.com/photos/RLJnH4Mt9A0?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" data-href="https://unsplash.com/photos/RLJnH4Mt9A0?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" class="markup--anchor markup--figure-anchor" rel="nofollow noopener" target="_blank">Clem Onojeghuo</a> on&nbsp;<a href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" data-href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" class="markup--anchor markup--figure-anchor" rel="nofollow noopener" target="_blank">Unsplash</a></figcaption></figure><p name="f005" id="f005" class="graf graf--p graf-after--figure">The client also imports the <code class="markup--code markup--p-code">api</code> package, so that the <code class="markup--code markup--p-code">message</code> and the <code class="markup--code markup--p-code">service</code> are available. So create the file <code class="markup--code markup--p-code">client/main.go</code>:</p><pre name="0983" id="0983" class="graf graf--pre graf-after--p">package main</pre><pre name="47dd" id="47dd" class="graf graf--pre graf-after--pre">import (<br>  "log"</pre><pre name="0dbd" id="0dbd" class="graf graf--pre graf-after--pre">  "gitlab.com/pantomath-io/demo-grpc/api"<br>  "golang.org/x/net/context"<br>  "google.golang.org/grpc"<br>)</pre><pre name="56fb" id="56fb" class="graf graf--pre graf-after--pre">func main() {<br>  var conn *grpc.ClientConn</pre><pre name="57b2" id="57b2" class="graf graf--pre graf-after--pre">  conn, err := grpc.Dial(":7777", grpc.WithInsecure())<br>  if err != nil {<br>    log.Fatalf("did not connect: %s", err)<br>  }<br>  defer conn.Close()</pre><pre name="eb5f" id="eb5f" class="graf graf--pre graf-after--pre">  c := api.NewPingClient(conn)</pre><pre name="dbae" id="dbae" class="graf graf--pre graf-after--pre">  response, err := c.SayHello(context.Background(), &amp;api.PingMessage{Greeting: "foo"})<br>  if err != nil {<br>    log.Fatalf("Error when calling SayHello: %s", err)<br>  }<br>  log.Printf("Response from server: %s", response.Greeting)<br>}</pre><p name="9981" id="9981" class="graf graf--p graf-after--pre">Once again, the break down is pretty straight forward:</p><ul class="postList"><li name="8771" id="8771" class="graf graf--li graf-after--p">the <code class="markup--code markup--li-code">main</code> function instantiates a client connection, on the TCP port the server is bound to;</li><li name="a408" id="a408" class="graf graf--li graf-after--li">note the <code class="markup--code markup--li-code">defer</code> call to properly close the connection when the function returns;</li><li name="6c5a" id="6c5a" class="graf graf--li graf-after--li">the <code class="markup--code markup--li-code">c</code> variable is a client for the the <code class="markup--code markup--li-code">Ping</code> service, that calls the <code class="markup--code markup--li-code">SayHello</code> function, passing a <code class="markup--code markup--li-code">PingMessage</code> to it.</li></ul><p name="fd9b" id="fd9b" class="graf graf--p graf-after--li">You can compile your code to get a client binary:</p><pre name="8b13" id="8b13" class="graf graf--pre graf-after--p">$ go build -i -v -o bin/client gitlab.com/pantomath-io/demo-grpc/client</pre><h3 name="9eac" id="9eac" class="graf graf--h3 graf-after--pre">Make them&nbsp;talk</h3><p name="a2b5" id="a2b5" class="graf graf--p graf-after--h3">You’ve just built a client and a server, so fire them in two terminals to test them:</p><pre name="d84f" id="d84f" class="graf graf--pre graf-after--p">$ bin/server<br>2006/01/02 15:04:05 Receive message foo</pre><pre name="8818" id="8818" class="graf graf--pre graf-after--pre">$ bin/client<br>2006/01/02 15:04:05 Response from server: bar</pre><h3 name="2ed5" id="2ed5" class="graf graf--h3 graf-after--pre">Tool to ease your&nbsp;life</h3><p name="1705" id="1705" class="graf graf--p graf-after--h3"><em class="markup--em markup--p-em">git tag: </em><a href="https://gitlab.com/pantomath-io/demo-grpc/blob/init-makefile/Makefile" data-href="https://gitlab.com/pantomath-io/demo-grpc/blob/init-makefile/Makefile" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank"><em class="markup--em markup--p-em">init-makefile</em></a></p><p name="9cd9" id="9cd9" class="graf graf--p graf-after--p">Now the API, the client and the server are working, you may prefer to have a Makefile to compile the code, clean your folder, manage dependencies, etc.</p><p name="9c60" id="9c60" class="graf graf--p graf-after--p">So create this <code class="markup--code markup--p-code"><a href="https://gitlab.com/pantomath-io/demo-grpc/blob/init-makefile/Makefile" data-href="https://gitlab.com/pantomath-io/demo-grpc/blob/init-makefile/Makefile" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">Makefile</a></code> at the root of the project folder. Explaining this file is beyond the scope of this post, and it mostly uses compile command you already spawned previously.</p><p name="f77e" id="f77e" class="graf graf--p graf-after--p">To use the <code class="markup--code markup--p-code">Makefile</code>&nbsp;, try calling the following:</p><pre name="a2eb" id="a2eb" class="graf graf--pre graf-after--p">$ make help<br>api                            Auto-generate grpc go sources<br>build_client                   Build the binary file for client<br>build_server                   Build the binary file for server<br>clean                          Remove previous builds<br>dep                            Get the dependencies<br>help                           Display this help screen</pre><h3 name="9a2d" id="9a2d" class="graf graf--h3 graf-after--pre">Secure the communication</h3><p name="2e9b" id="2e9b" class="graf graf--p graf-after--h3"><em class="markup--em markup--p-em">git tag: </em><a href="https://gitlab.com/pantomath-io/demo-grpc/tree/add-ssl" data-href="https://gitlab.com/pantomath-io/demo-grpc/tree/add-ssl" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank"><em class="markup--em markup--p-em">add-ssl</em></a></p><figure name="467c" id="467c" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 481px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 68.7%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*k_WFayrFR6ciCOLn8fWI7g.jpeg" data-width="4469" data-height="3072" data-action="zoom" data-action-value="1*k_WFayrFR6ciCOLn8fWI7g.jpeg" data-scroll="native"><img src="./How we use gRPC to build a client_server system in Go_files/1_k_WFayrFR6ciCOLn8fWI7g.jpeg" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="50"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/800/1*k_WFayrFR6ciCOLn8fWI7g.jpeg" src="./How we use gRPC to build a client_server system in Go_files/1_k_WFayrFR6ciCOLn8fWI7g(1).jpeg"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/800/1*k_WFayrFR6ciCOLn8fWI7g.jpeg"></noscript></div></div><figcaption class="imageCaption">Photo by <a href="https://unsplash.com/photos/-4AFJ5yujcE?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" data-href="https://unsplash.com/photos/-4AFJ5yujcE?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" class="markup--anchor markup--figure-anchor" rel="nofollow noopener" target="_blank">Nathaniel Tetteh</a> on&nbsp;<a href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" data-href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" class="markup--anchor markup--figure-anchor" rel="nofollow noopener" target="_blank">Unsplash</a></figcaption></figure><p name="84dc" id="84dc" class="graf graf--p graf-after--figure">The client and the servers talk to each other, over <a href="https://http2.github.io/" data-href="https://http2.github.io/" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">HTTP/2</a> (transport layer on gRPC). The messages are binary data(thanks to Protobuf), but the communication is in plaintext. Fortunately, gRPC has SSL/TLS integration, that can be used to authenticate the server (from the client’s perspective), and to encrypt message exchanges.</p><p name="29f5" id="29f5" class="graf graf--p graf-after--p">You don’t need to change anything to the protocol: it remains the same. The changes take place in the gRPC object creation, on both client and server side. Note that if you change only one side, the connection won’t work.</p><p name="bde2" id="bde2" class="graf graf--p graf-after--p">Before you change anything in the code, you need to create a <a href="https://en.wikipedia.org/wiki/Self-signed_certificate" data-href="https://en.wikipedia.org/wiki/Self-signed_certificate" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">self-signed SSL certificate</a>. The purpose of this post is not to explain how to do that, but the <a href="https://www.openssl.org/docs/manmaster/man1/" data-href="https://www.openssl.org/docs/manmaster/man1/" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">official OpenSSL documentation</a> (<code class="markup--code markup--p-code"><a href="https://www.openssl.org/docs/manmaster/man1/genrsa.html" data-href="https://www.openssl.org/docs/manmaster/man1/genrsa.html" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">genrsa</a></code>, <code class="markup--code markup--p-code"><a href="https://www.openssl.org/docs/manmaster/man1/req.html" data-href="https://www.openssl.org/docs/manmaster/man1/req.html" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">req</a></code>, <code class="markup--code markup--p-code"><a href="https://www.openssl.org/docs/manmaster/man1/x509.html" data-href="https://www.openssl.org/docs/manmaster/man1/x509.html" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">x509</a></code>) can answer your question about it (DigitalOcean also has a <a href="https://www.digitalocean.com/community/tutorials/openssl-essentials-working-with-ssl-certificates-private-keys-and-csrs" data-href="https://www.digitalocean.com/community/tutorials/openssl-essentials-working-with-ssl-certificates-private-keys-and-csrs" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">nice and complete tutorial</a> about it). Meanwhile, you can just use the files provided in the <code class="markup--code markup--p-code"><a href="https://gitlab.com/pantomath-io/demo-grpc/tree/add-ssl/cert" data-href="https://gitlab.com/pantomath-io/demo-grpc/tree/add-ssl/cert" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">cert</a></code> folder. The following commands have been used to generate the files:</p><pre name="5bbb" id="5bbb" class="graf graf--pre graf-after--p">$ openssl genrsa -out cert/server.key 2048<br>$ openssl req -new -x509 -sha256 -key cert/server.key -out cert/server.crt -days 3650<br>$ openssl req -new -sha256 -key cert/server.key -out cert/server.csr<br>$ openssl x509 -req -sha256 -in cert/server.csr -signkey cert/server.key -out cert/server.crt -days 3650</pre><p name="29f3" id="29f3" class="graf graf--p graf-after--pre">You can proceed and update the server definition to use the certificate and the key:</p><pre name="db4f" id="db4f" class="graf graf--pre graf-after--p">package main</pre><pre name="3c90" id="3c90" class="graf graf--pre graf-after--pre">import (<br>  "fmt"<br>  "log"<br>  "net"</pre><pre name="105c" id="105c" class="graf graf--pre graf-after--pre">  "gitlab.com/pantomath-io/demo-grpc/api"<br>  "google.golang.org/grpc"<br>  "google.golang.org/grpc/credentials"<br>)</pre><pre name="9b9f" id="9b9f" class="graf graf--pre graf-after--pre">// main starts a gRPC server and waits for connection<br>func main() {<br>  // create a listener on TCP port 7777<br>  lis, err := net.Listen("tcp", fmt.Sprintf("%s:%d", "localhost", 7777))<br>  if err != nil {<br>    log.Fatalf("failed to listen: %v", err)<br>  }</pre><pre name="936b" id="936b" class="graf graf--pre graf-after--pre">  // create a server instance<br>  s := api.Server{}</pre><pre name="ba8c" id="ba8c" class="graf graf--pre graf-after--pre">  // Create the TLS credentials<br>  creds, err := credentials.NewServerTLSFromFile("cert/server.crt", "cert/server.key")<br>  if err != nil {<br>    log.Fatalf("could not load TLS keys: %s", err)<br>  }</pre><pre name="c02d" id="c02d" class="graf graf--pre graf-after--pre">  // Create an array of gRPC options with the credentials<br>  opts := []grpc.ServerOption{grpc.Creds(creds)}</pre><pre name="ad85" id="ad85" class="graf graf--pre graf-after--pre">  // create a gRPC server object<br>  grpcServer := grpc.NewServer(opts...)</pre><pre name="6a90" id="6a90" class="graf graf--pre graf-after--pre">  // attach the Ping service to the server<br>  api.RegisterPingServer(grpcServer, &amp;s)</pre><pre name="af1b" id="af1b" class="graf graf--pre graf-after--pre">  // start the server<br>  if err := grpcServer.Serve(lis); err != nil {<br>    log.Fatalf("failed to serve: %s", err)<br>  }<br>}</pre><p name="925b" id="925b" class="graf graf--p graf-after--pre">So what changed?</p><ul class="postList"><li name="2e16" id="2e16" class="graf graf--li graf-after--p">you created a <a href="https://godoc.org/google.golang.org/grpc/credentials" data-href="https://godoc.org/google.golang.org/grpc/credentials" class="markup--anchor markup--li-anchor" rel="nofollow noopener" target="_blank">credentials</a> object (called <code class="markup--code markup--li-code">creds</code>) from your certificate and key files;</li><li name="1e2a" id="1e2a" class="graf graf--li graf-after--li">you created a <code class="markup--code markup--li-code"><a href="https://godoc.org/google.golang.org/grpc#ServerOption" data-href="https://godoc.org/google.golang.org/grpc#ServerOption" class="markup--anchor markup--li-anchor" rel="nofollow noopener" target="_blank">grpc.ServerOption</a></code> array and placed your credentials object in it;</li><li name="3beb" id="3beb" class="graf graf--li graf-after--li">when creating the grpc server, you provided the constructor with you array of <code class="markup--code markup--li-code">grpc.ServerOption</code>;</li><li name="e92b" id="e92b" class="graf graf--li graf-after--li">you must have noticed that you need to precisely specify the IP you bind your server to, so that the IP matches the FQDN used in the certificate.</li></ul><p name="f540" id="f540" class="graf graf--p graf-after--li">Note that <code class="markup--code markup--p-code">grpc.NewServer()</code> is a variadic function, so you can pass it any number of trailing arguments. You created an array of options so that we can add other options later on.</p><p name="b3dd" id="b3dd" class="graf graf--p graf-after--p">If you compile your <code class="markup--code markup--p-code">server</code> now, and use the <code class="markup--code markup--p-code">client</code> you already have, the connection won’t work, and both sides will throw an error.</p><ul class="postList"><li name="de70" id="de70" class="graf graf--li graf-after--p">the server report the client is not handshaking with TLS:</li></ul><pre name="ca26" id="ca26" class="graf graf--pre graf-after--li">2006/01/02 15:04:05 grpc: Server.Serve failed to complete security handshake from "localhost:64018": tls: first record does not look like a TLS handshake</pre><ul class="postList"><li name="cb77" id="cb77" class="graf graf--li graf-after--pre">the client has its connection closed before it can do anything:</li></ul><pre name="e67a" id="e67a" class="graf graf--pre graf-after--li">2006/01/02 15:04:05 transport: http2Client.notifyError got notified that the client transport was broken read tcp localhost:64018-&gt;127.0.0.1:7777: read: connection reset by peer.<br>2006/01/02 15:04:05 Error when calling SayHello: rpc error: code = Internal desc = transport is closing</pre><p name="bbf1" id="bbf1" class="graf graf--p graf-after--pre">You need to use the exact same certificate file on the client side. So edit the <code class="markup--code markup--p-code">client/main.go</code> file:</p><pre name="160a" id="160a" class="graf graf--pre graf-after--p">package main</pre><pre name="de9b" id="de9b" class="graf graf--pre graf-after--pre">import (<br>  "log"</pre><pre name="7e5f" id="7e5f" class="graf graf--pre graf-after--pre">  "gitlab.com/pantomath-io/demo-grpc/api"<br>  "golang.org/x/net/context"<br>  "google.golang.org/grpc"<br>  "google.golang.org/grpc/credentials"<br>)</pre><pre name="76df" id="76df" class="graf graf--pre graf-after--pre">func main() {<br>  var conn *grpc.ClientConn</pre><pre name="fa88" id="fa88" class="graf graf--pre graf-after--pre">// Create the client TLS credentials<br>  creds, err := credentials.NewClientTLSFromFile("cert/server.crt", "")<br>  if err != nil {<br>    log.Fatalf("could not load tls cert: %s", err)<br>  }</pre><pre name="80fe" id="80fe" class="graf graf--pre graf-after--pre">  // Initiate a connection with the server<br>  conn, err = grpc.Dial("localhost:7777", grpc.WithTransportCredentials(creds))<br>  if err != nil {<br>    log.Fatalf("did not connect: %s", err)<br>  }<br>  defer conn.Close()</pre><pre name="4483" id="4483" class="graf graf--pre graf-after--pre">  c := api.NewPingClient(conn)</pre><pre name="e230" id="e230" class="graf graf--pre graf-after--pre">  response, err := c.SayHello(context.Background(), &amp;api.PingMessage{Greeting: "foo"})<br>  if err != nil {<br>    log.Fatalf("error when calling SayHello: %s", err)<br>  }<br>  log.Printf("Response from server: %s", response.Greeting)<br>}</pre><p name="170e" id="170e" class="graf graf--p graf-after--pre">The changes on the client side are pretty much the same as on the server:</p><ul class="postList"><li name="c01d" id="c01d" class="graf graf--li graf-after--p">you created a <a href="https://godoc.org/google.golang.org/grpc/credentials" data-href="https://godoc.org/google.golang.org/grpc/credentials" class="markup--anchor markup--li-anchor" rel="nofollow noopener" target="_blank">credentials</a> object with the certificate file. Note that the client <strong class="markup--strong markup--li-strong">do not use</strong> the certificate key, the key is private to the server;</li><li name="d1f9" id="d1f9" class="graf graf--li graf-after--li">you added an option to the <code class="markup--code markup--li-code">grpc.Dial()</code> function, using your credentials object. Note that the <code class="markup--code markup--li-code"><a href="https://godoc.org/google.golang.org/grpc#Dial" data-href="https://godoc.org/google.golang.org/grpc#Dial" class="markup--anchor markup--li-anchor" rel="nofollow noopener" target="_blank">grpc.Dial()</a></code> function is also a variadic function, so it accepts any number of options;</li><li name="e6db" id="e6db" class="graf graf--li graf-after--li">same server note applies for the client: you need to use the same FQDN to connect to the server as the one used in the certificate, or the transport authentication handshake will fail.</li></ul><p name="5686" id="5686" class="graf graf--p graf-after--li">Both sides use credentials, so they should be able to talk just as before, but in an encrypted way. You can compile the code:</p><pre name="7c0d" id="7c0d" class="graf graf--pre graf-after--p">$ make</pre><p name="fa67" id="fa67" class="graf graf--p graf-after--pre">And run both sides in separate terminals:</p><pre name="161a" id="161a" class="graf graf--pre graf-after--p">$ bin/server<br>2006/01/02 15:04:05 Receive message foo</pre><pre name="5cce" id="5cce" class="graf graf--pre graf-after--pre">$ bin/client<br>2006/01/02 15:04:05 Response from server: bar</pre><h3 name="771a" id="771a" class="graf graf--h3 graf-after--pre">Identify the&nbsp;client</h3><p name="632d" id="632d" class="graf graf--p graf-after--h3"><em class="markup--em markup--p-em">git tag: </em><a href="https://gitlab.com/pantomath-io/demo-grpc/tree/add-auth" data-href="https://gitlab.com/pantomath-io/demo-grpc/tree/add-auth" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank"><em class="markup--em markup--p-em">add-auth</em></a></p><figure name="3fa1" id="3fa1" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 467px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 66.8%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*9hIUb4TpxYkHehxMb7KpEw.jpeg" data-width="6016" data-height="4016" data-action="zoom" data-action-value="1*9hIUb4TpxYkHehxMb7KpEw.jpeg" data-scroll="native"><img src="./How we use gRPC to build a client_server system in Go_files/1_9hIUb4TpxYkHehxMb7KpEw.jpeg" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="50"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/800/1*9hIUb4TpxYkHehxMb7KpEw.jpeg" src="./How we use gRPC to build a client_server system in Go_files/1_9hIUb4TpxYkHehxMb7KpEw(1).jpeg"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/800/1*9hIUb4TpxYkHehxMb7KpEw.jpeg"></noscript></div></div><figcaption class="imageCaption">Photo by <a href="https://unsplash.com/photos/984e1Fk4E04?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" data-href="https://unsplash.com/photos/984e1Fk4E04?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" class="markup--anchor markup--figure-anchor" rel="nofollow noopener" target="_blank">chuttersnap</a> on&nbsp;<a href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" data-href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" class="markup--anchor markup--figure-anchor" rel="nofollow noopener" target="_blank">Unsplash</a></figcaption></figure><p name="def1" id="def1" class="graf graf--p graf-after--figure">Another interesting feature of the gRPC server is the ability to intercept a request from the client. The client can inject information on the transport layer. You can use that feature to identify your client, because the SSL implementation authenticates the server (via the certificate), but not the client (all your clients are using the same certificate).</p><p name="f173" id="f173" class="graf graf--p graf-after--p">So you’ll update the client side to inject metadata on every call (like a login and password), and the server side to check these credentials for every incoming call.</p><p name="9b50" id="9b50" class="graf graf--p graf-after--p">On the client side, you just need to specify a <code class="markup--code markup--p-code">DialOption</code> on your <code class="markup--code markup--p-code">grpc.Dial()</code> call. But that <code class="markup--code markup--p-code">DialOption</code>has some constraints. Edit your <code class="markup--code markup--p-code">client/main.go</code> file:</p><pre name="f503" id="f503" class="graf graf--pre graf-after--p">package main</pre><pre name="b709" id="b709" class="graf graf--pre graf-after--pre">import (<br>  "log"</pre><pre name="a705" id="a705" class="graf graf--pre graf-after--pre">  "gitlab.com/pantomath-io/demo-grpc/api"<br>  "golang.org/x/net/context"<br>  "google.golang.org/grpc"<br>  "google.golang.org/grpc/credentials"<br>)</pre><pre name="5f10" id="5f10" class="graf graf--pre graf-after--pre">// Authentication holds the login/password<br>type Authentication struct {<br>  Login    string<br>  Password string<br>}</pre><pre name="a79e" id="a79e" class="graf graf--pre graf-after--pre">// GetRequestMetadata gets the current request metadata<br>func (a *Authentication) GetRequestMetadata(context.Context, ...string) (map[string]string, error) {<br>  return map[string]string{<br>    "login":    a.Login,<br>    "password": a.Password,<br>  }, nil<br>}</pre><pre name="3889" id="3889" class="graf graf--pre graf-after--pre">// RequireTransportSecurity indicates whether the credentials requires transport security<br>func (a *Authentication) RequireTransportSecurity() bool {<br>  return true<br>}</pre><pre name="7aac" id="7aac" class="graf graf--pre graf-after--pre">func main() {<br>  var conn *grpc.ClientConn</pre><pre name="b411" id="b411" class="graf graf--pre graf-after--pre">// Create the client TLS credentials<br>  creds, err := credentials.NewClientTLSFromFile("cert/server.crt", "")<br>  if err != nil {<br>    log.Fatalf("could not load tls cert: %s", err)<br> }</pre><pre name="0a66" id="0a66" class="graf graf--pre graf-after--pre">  // Setup the login/pass<br>  auth := Authentication{<br>    Login:    "john",<br>    Password: "doe",<br>  }</pre><pre name="9bb5" id="9bb5" class="graf graf--pre graf-after--pre">  // Initiate a connection with the server<br>  conn, err = grpc.Dial("localhost:7777", grpc.WithTransportCredentials(creds), grpc.WithPerRPCCredentials(&amp;auth))<br>  if err != nil {<br>    log.Fatalf("did not connect: %s", err)<br>   }<br>   defer conn.Close()</pre><pre name="c5c1" id="c5c1" class="graf graf--pre graf-after--pre">  c := api.NewPingClient(conn)</pre><pre name="bd00" id="bd00" class="graf graf--pre graf-after--pre">  response, err := c.SayHello(context.Background(), &amp;api.PingMessage{Greeting: "foo"})<br>  if err != nil {<br>    log.Fatalf("error when calling SayHello: %s", err)<br>  }<br>  log.Printf("Response from server: %s", response.Greeting)<br>}</pre><ul class="postList"><li name="c0cf" id="c0cf" class="graf graf--li graf-after--pre">You define a struct to hold the collection on fields you want to inject in your rcp calls. In our case, just a login and password, but you can imagine any fields you want;</li><li name="df2f" id="df2f" class="graf graf--li graf-after--li">The <code class="markup--code markup--li-code">auth</code> variable holds the values you’ll be using;</li><li name="2dca" id="2dca" class="graf graf--li graf-after--li">You use <code class="markup--code markup--li-code">grpc.WithPerRPCCredentials()</code> function to create a <code class="markup--code markup--li-code">DialOption</code> object to the <code class="markup--code markup--li-code">grpc.Dial()</code> function;</li><li name="725e" id="725e" class="graf graf--li graf-after--li">Note that the <code class="markup--code markup--li-code"><a href="https://godoc.org/google.golang.org/grpc#WithPerRPCCredentials" data-href="https://godoc.org/google.golang.org/grpc#WithPerRPCCredentials" class="markup--anchor markup--li-anchor" rel="nofollow noopener" target="_blank">grpc.WithPerRPCCredentials()</a></code> function takes an interface as parameter, so your <code class="markup--code markup--li-code">Authentication</code> structure should comply to that interface. From the <a href="https://godoc.org/google.golang.org/grpc/credentials#PerRPCCredentials" data-href="https://godoc.org/google.golang.org/grpc/credentials#PerRPCCredentials" class="markup--anchor markup--li-anchor" rel="nofollow noopener" target="_blank">documentation</a>, you know you should implement 2 methods on your structure: <code class="markup--code markup--li-code">GetRequestMetadata</code> and <code class="markup--code markup--li-code">RequireTransportSecurity</code>.</li><li name="aa00" id="aa00" class="graf graf--li graf-after--li">So you define <code class="markup--code markup--li-code">GetRequestMetadata</code> function that just returns a map of your <code class="markup--code markup--li-code">Authentication</code> structure;</li><li name="7ba1" id="7ba1" class="graf graf--li graf-after--li">And finally, you define <code class="markup--code markup--li-code">RequireTransportSecurity</code> function, that tells your <code class="markup--code markup--li-code">grpc</code> client if it should inject metadata at the transport level. In our current case, it always returns true, but you could have it return the value of a configuration boolean, for instance.</li></ul><p name="bf95" id="bf95" class="graf graf--p graf-after--li">The client is up to push extra data during its calls to the server, but the server does not care, right now. So you need to tell him to check these metadata. Open <code class="markup--code markup--p-code">server/main.go</code> and update it:</p><pre name="2cb4" id="2cb4" class="graf graf--pre graf-after--p">package main</pre><pre name="d0d6" id="d0d6" class="graf graf--pre graf-after--pre">import (<br>  "fmt"<br>  "log"<br>  "net"<br>  "strings"</pre><pre name="400a" id="400a" class="graf graf--pre graf-after--pre">  "golang.org/x/net/context"</pre><pre name="88a0" id="88a0" class="graf graf--pre graf-after--pre">  "gitlab.com/pantomath-io/demo-grpc/api"<br>  "google.golang.org/grpc"<br>  "google.golang.org/grpc/credentials"<br>  "google.golang.org/grpc/metadata"<br>)</pre><pre name="9c78" id="9c78" class="graf graf--pre graf-after--pre">// private type for Context keys<br>type contextKey int</pre><pre name="437f" id="437f" class="graf graf--pre graf-after--pre">const (<br>  clientIDKey contextKey = iota<br>)</pre><pre name="b6b0" id="b6b0" class="graf graf--pre graf-after--pre">// authenticateAgent check the client credentials<br>func authenticateClient(ctx context.Context, s *api.Server) (string, error) {<br>  if md, ok := metadata.FromIncomingContext(ctx); ok {<br>    clientLogin := strings.Join(md["login"], "")<br>    clientPassword := strings.Join(md["password"], "")</pre><pre name="c9f4" id="c9f4" class="graf graf--pre graf-after--pre">    if clientLogin != "john" {<br>      return "", fmt.Errorf("unknown user %s", clientLogin)<br>    }<br>    if clientPassword != "doe" {<br>      return "", fmt.Errorf("bad password %s", clientPassword)<br>    }</pre><pre name="bdf6" id="bdf6" class="graf graf--pre graf-after--pre">    log.Printf("authenticated client: %s", clientLogin)<br>    return "42", nil<br>  }</pre><pre name="91ec" id="91ec" class="graf graf--pre graf-after--pre">  return "", fmt.Errorf("missing credentials")<br>}</pre><pre name="8de8" id="8de8" class="graf graf--pre graf-after--pre">// unaryInterceptor calls authenticateClient with current context<br>func unaryInterceptor(ctx context.Context, req interface{}, info *grpc.UnaryServerInfo, handler grpc.UnaryHandler) (interface{}, error) {<br>  s, ok := info.Server.(*api.Server)<br>  if !ok {<br>    return nil, fmt.Errorf("unable to cast server")<br>  }<br>  clientID, err := authenticateClient(ctx, s)<br>  if err != nil {<br>    return nil, err<br>  }</pre><pre name="15cc" id="15cc" class="graf graf--pre graf-after--pre">  ctx = context.WithValue(ctx, clientIDKey, clientID)<br>  return handler(ctx, req)<br>}</pre><pre name="edc7" id="edc7" class="graf graf--pre graf-after--pre">// main start a gRPC server and waits for connection<br>func main() {<br>  // create a listener on TCP port 7777<br>  lis, err := net.Listen("tcp", fmt.Sprintf("%s:%d", "localhost", 7777))<br>  if err != nil {<br>    log.Fatalf("failed to listen: %v", err)<br>  }</pre><pre name="3c7a" id="3c7a" class="graf graf--pre graf-after--pre">  // create a server instance<br>  s := api.Server{}</pre><pre name="3a0d" id="3a0d" class="graf graf--pre graf-after--pre">  // Create the TLS credentials<br>  creds, err := credentials.NewServerTLSFromFile("cert/server.crt", "cert/server.key")<br>  if err != nil {<br>    log.Fatalf("could not load TLS keys: %s", err)<br>  }</pre><pre name="cc13" id="cc13" class="graf graf--pre graf-after--pre">  // Create an array of gRPC options with the credentials<br>  opts := []grpc.ServerOption{grpc.Creds(creds),<br>    grpc.UnaryInterceptor(unaryInterceptor)}</pre><pre name="a608" id="a608" class="graf graf--pre graf-after--pre">  // create a gRPC server object<br>  grpcServer := grpc.NewServer(opts...)</pre><pre name="fb80" id="fb80" class="graf graf--pre graf-after--pre">  // attach the Ping service to the server<br>  api.RegisterPingServer(grpcServer, &amp;s)</pre><pre name="5abb" id="5abb" class="graf graf--pre graf-after--pre">  // start the server<br>  if err := grpcServer.Serve(lis); err != nil {<br>    log.Fatalf("failed to serve: %s", err)<br>  }<br>}</pre><p name="6d99" id="6d99" class="graf graf--p graf-after--pre">Once again, let me break down this for you:</p><ul class="postList"><li name="a860" id="a860" class="graf graf--li graf-after--p">you add a new <code class="markup--code markup--li-code">grpc.ServerOption</code> to the array you created before (see why it’s an array, now?): <code class="markup--code markup--li-code"><a href="https://godoc.org/google.golang.org/grpc#UnaryInterceptor" data-href="https://godoc.org/google.golang.org/grpc#UnaryInterceptor" class="markup--anchor markup--li-anchor" rel="nofollow noopener" target="_blank">grpc.UnaryInterceptor</a></code>. And you pass a <a href="https://godoc.org/google.golang.org/grpc#UnaryServerInterceptor" data-href="https://godoc.org/google.golang.org/grpc#UnaryServerInterceptor" class="markup--anchor markup--li-anchor" rel="nofollow noopener" target="_blank">reference to a function</a> to that function, so it knows who to call. The rest of the main code does not change;</li><li name="8804" id="8804" class="graf graf--li graf-after--li">you have to define the <code class="markup--code markup--li-code">unaryInterceptor</code> function, considering it gets a bunch of parameters:</li></ul><ol class="postList"><li name="0e22" id="0e22" class="graf graf--li graf-after--li">a <code class="markup--code markup--li-code"><a href="https://godoc.org/golang.org/x/net/context" data-href="https://godoc.org/golang.org/x/net/context" class="markup--anchor markup--li-anchor" rel="nofollow noopener" target="_blank">context.Context</a></code> object, containing your data, and that will exist during all the lifetime of the request;</li><li name="1b8b" id="1b8b" class="graf graf--li graf-after--li">an <code class="markup--code markup--li-code">interface{}</code> which is the inbound parameter of the RPC call;</li><li name="7d20" id="7d20" class="graf graf--li graf-after--li">a <code class="markup--code markup--li-code"><a href="https://godoc.org/google.golang.org/grpc#UnaryServerInfo" data-href="https://godoc.org/google.golang.org/grpc#UnaryServerInfo" class="markup--anchor markup--li-anchor" rel="nofollow noopener" target="_blank">UnaryServerInfo</a></code> struct which contains a bunch of information about the call (such as the <code class="markup--code markup--li-code">Server</code> abstraction object, and the method call by the client);</li><li name="37eb" id="37eb" class="graf graf--li graf-after--li">a <code class="markup--code markup--li-code"><a href="https://godoc.org/google.golang.org/grpc#UnaryHandler" data-href="https://godoc.org/google.golang.org/grpc#UnaryHandler" class="markup--anchor markup--li-anchor" rel="nofollow noopener" target="_blank">UnaryHandler</a></code> struct which is the handler invoked by <code class="markup--code markup--li-code">UnaryServerInterceptor</code> to complete the normal execution of a unary RPC (i.e. an handler to what happens when the <code class="markup--code markup--li-code">UnaryInterceptor</code> returns).</li></ol><ul class="postList"><li name="fecb" id="fecb" class="graf graf--li graf-after--li">the <code class="markup--code markup--li-code">unaryInterceptor</code> function makes sure the <code class="markup--code markup--li-code">grpc.UnaryServerInfo</code> has the right server abstraction, and call the authentication function, <code class="markup--code markup--li-code">authenticateClient</code>;</li><li name="346d" id="346d" class="graf graf--li graf-after--li">you define the <code class="markup--code markup--li-code">authenticateClient</code> function with your authentication logic — very very simple in this example. Note that it receives the <code class="markup--code markup--li-code">context.Context</code> as parameter, and extract the metadata from it. It checks the user, and returns its ID (in the form of a <code class="markup--code markup--li-code">string</code>, with a hypothetical error.</li><li name="69c8" id="69c8" class="graf graf--li graf-after--li">if the <code class="markup--code markup--li-code">unaryInterceptor</code> gets no error from the <code class="markup--code markup--li-code">authenticateClient</code> function, it pushes the <code class="markup--code markup--li-code">clientID</code> in the <code class="markup--code markup--li-code">context.Context</code> object, so that the rest of the execution chain can use it (remember the <code class="markup--code markup--li-code">handler</code> gets the <code class="markup--code markup--li-code">context.Context</code> object as parameter?);</li><li name="828a" id="828a" class="graf graf--li graf-after--li">Note that you created your <code class="markup--code markup--li-code">type</code> and <code class="markup--code markup--li-code">const</code> to reference the <code class="markup--code markup--li-code">clientID</code> in the <code class="markup--code markup--li-code">context.Context</code> map. This is just an handy way to avoid naming conflict and to allow constant reference.</li></ul><p name="fa0d" id="fa0d" class="graf graf--p graf-after--li">You can compile the code:</p><pre name="ab49" id="ab49" class="graf graf--pre graf-after--p">$ make</pre><p name="77bf" id="77bf" class="graf graf--p graf-after--pre">And run both sides in separate terminals:</p><pre name="801e" id="801e" class="graf graf--pre graf-after--p">$ bin/server<br>2006/01/02 15:04:05 authenticated client: john<br>2006/01/02 15:04:05 Receive message foo</pre><pre name="3596" id="3596" class="graf graf--pre graf-after--pre">$ bin/client<br>2006/01/02 15:04:05 Response from server: bar</pre><p name="f9ec" id="f9ec" class="graf graf--p graf-after--pre">Obviously, your authentication logic will probably be smarter, comparing credentials against a database. The easy part of it is: your authentication function gets your abstraction of a <code class="markup--code markup--p-code">Server</code>, and this structure can hold your database handler.</p><h3 name="6be6" id="6be6" class="graf graf--h3 graf-after--p">Open to&nbsp;REST</h3><p name="42df" id="42df" class="graf graf--p graf-after--h3"><em class="markup--em markup--p-em">git tag: </em><a href="https://gitlab.com/pantomath-io/demo-grpc/tree/add-rest" data-href="https://gitlab.com/pantomath-io/demo-grpc/tree/add-rest" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank"><em class="markup--em markup--p-em">add-rest</em></a></p><figure name="3ba3" id="3ba3" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 467px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 66.7%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*dpCAELNImICQxw8UxA0bsA.jpeg" data-width="6000" data-height="4000" data-action="zoom" data-action-value="1*dpCAELNImICQxw8UxA0bsA.jpeg" data-scroll="native"><img src="./How we use gRPC to build a client_server system in Go_files/1_dpCAELNImICQxw8UxA0bsA.jpeg" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="50"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/800/1*dpCAELNImICQxw8UxA0bsA.jpeg" src="./How we use gRPC to build a client_server system in Go_files/1_dpCAELNImICQxw8UxA0bsA(1).jpeg"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/800/1*dpCAELNImICQxw8UxA0bsA.jpeg"></noscript></div></div><figcaption class="imageCaption">Photo by <a href="https://unsplash.com/photos/nNPONh2aXeQ?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" data-href="https://unsplash.com/photos/nNPONh2aXeQ?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" class="markup--anchor markup--figure-anchor" rel="nofollow noopener" target="_blank">Rio Hodges</a> on&nbsp;<a href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" data-href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" class="markup--anchor markup--figure-anchor" rel="nofollow noopener" target="_blank">Unsplash</a></figcaption></figure><p name="7b17" id="7b17" class="graf graf--p graf-after--figure">One last thing: you have a pretty neat server, client and protocol; serialized, encrypted and authenticated. But there is a important limit: your client needs to be gRPC compliant, that is be in the list of <a href="https://grpc.io/about/#osp" data-href="https://grpc.io/about/#osp" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">supported platforms</a>. To avoid that limit, we can open the server to a REST gateway, allowing REST clients to perform requests it. Luckily, there is a gRPC <a href="https://github.com/grpc-ecosystem/grpc-gateway" data-href="https://github.com/grpc-ecosystem/grpc-gateway" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">protoc plugin</a> to generate a reverse-proxy server which translates a RESTful JSON API into gRPC. We can use a few line of pure Go code to serve that reverse-proxy.</p><p name="bb49" id="bb49" class="graf graf--p graf-after--p">So edit your <code class="markup--code markup--p-code"><a href="https://gitlab.com/pantomath-io/demo-grpc/blob/add-rest/api/api.proto" data-href="https://gitlab.com/pantomath-io/demo-grpc/blob/add-rest/api/api.proto" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">api/api.proto</a></code> file to add some extra information:</p><pre name="23f1" id="23f1" class="graf graf--pre graf-after--p">syntax = "proto3";<br>package api;</pre><pre name="94d2" id="94d2" class="graf graf--pre graf-after--pre">import "google/api/annotations.proto";</pre><pre name="ea83" id="ea83" class="graf graf--pre graf-after--pre">message PingMessage {<br>  string greeting = 1;<br>}</pre><pre name="0923" id="0923" class="graf graf--pre graf-after--pre">service Ping {<br>  rpc SayHello(PingMessage) returns (PingMessage) {<br>    option (google.api.http) = {<br>      post: "/1/ping"<br>      body: "*"<br>    };<br>  }<br>}</pre><p name="8334" id="8334" class="graf graf--p graf-after--pre">The <code class="markup--code markup--p-code">annotations.proto</code> import allows <code class="markup--code markup--p-code">protoc</code> to understand the <code class="markup--code markup--p-code">option</code> set later in the file. And the <code class="markup--code markup--p-code">option</code> defines that method and the path to the endpoint.</p><p name="a553" id="a553" class="graf graf--p graf-after--p">Update the <code class="markup--code markup--p-code"><a href="https://gitlab.com/pantomath-io/demo-grpc/blob/add-rest/Makefile" data-href="https://gitlab.com/pantomath-io/demo-grpc/blob/add-rest/Makefile" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">Makefile</a></code> to add a target for this new <code class="markup--code markup--p-code">Protobuf</code> compilation:</p><pre name="7edc" id="7edc" class="graf graf--pre graf-after--p">SERVER_OUT := "bin/server"<br>CLIENT_OUT := "bin/client"<br>API_OUT := "api/api.pb.go"<br>API_REST_OUT := "api/api.pb.gw.go"<br>PKG := "gitlab.com/pantomath-io/demo-grpc"<br>SERVER_PKG_BUILD := "${PKG}/server"<br>CLIENT_PKG_BUILD := "${PKG}/client"<br>PKG_LIST := $(shell go list ${PKG}/... | grep -v /vendor/)</pre><pre name="e959" id="e959" class="graf graf--pre graf-after--pre">.PHONY: all api server client</pre><pre name="5865" id="5865" class="graf graf--pre graf-after--pre">all: server client</pre><pre name="4ca7" id="4ca7" class="graf graf--pre graf-after--pre">api/api.pb.go: api/api.proto<br>  <a href="http://twitter.com/protoc" data-href="http://twitter.com/protoc" class="markup--anchor markup--pre-anchor" title="Twitter profile for @protoc" rel="nofollow noopener" target="_blank">@protoc</a> -I api/ \<br>    -I${GOPATH}/src \<br>    -I${GOPATH}/src/github.com/grpc-ecosystem/grpc-gateway/third_party/googleapis \<br>    --go_out=plugins=grpc:api \<br>    api/api.proto</pre><pre name="8d74" id="8d74" class="graf graf--pre graf-after--pre">api/api.pb.gw.go: api/api.proto<br>  <a href="http://twitter.com/protoc" data-href="http://twitter.com/protoc" class="markup--anchor markup--pre-anchor" title="Twitter profile for @protoc" rel="nofollow noopener" target="_blank">@protoc</a> -I api/ \<br>    -I${GOPATH}/src \<br>    -I${GOPATH}/src/github.com/grpc-ecosystem/grpc-gateway/third_party/googleapis \<br>    --grpc-gateway_out=logtostderr=true:api \<br>    api/api.proto</pre><pre name="f9bc" id="f9bc" class="graf graf--pre graf-after--pre">api: api/api.pb.go api/api.pb.gw.go ## Auto-generate grpc go sources</pre><pre name="7d43" id="7d43" class="graf graf--pre graf-after--pre">dep: ## Get the dependencies<br>  <a href="http://twitter.com/go" data-href="http://twitter.com/go" class="markup--anchor markup--pre-anchor" title="Twitter profile for @go" rel="nofollow noopener" target="_blank">@go</a> get -v -d ./...</pre><pre name="dc25" id="dc25" class="graf graf--pre graf-after--pre">server: dep api ## Build the binary file for server<br>  <a href="http://twitter.com/go" data-href="http://twitter.com/go" class="markup--anchor markup--pre-anchor" title="Twitter profile for @go" rel="nofollow noopener" target="_blank">@go</a> build -i -v -o $(SERVER_OUT) $(SERVER_PKG_BUILD)</pre><pre name="a709" id="a709" class="graf graf--pre graf-after--pre">client: dep api ## Build the binary file for client<br>  <a href="http://twitter.com/go" data-href="http://twitter.com/go" class="markup--anchor markup--pre-anchor" title="Twitter profile for @go" rel="nofollow noopener" target="_blank">@go</a> build -i -v -o $(CLIENT_OUT) $(CLIENT_PKG_BUILD)</pre><pre name="de0e" id="de0e" class="graf graf--pre graf-after--pre">clean: ## Remove previous builds<br>  <a href="http://twitter.com/rm" data-href="http://twitter.com/rm" class="markup--anchor markup--pre-anchor" title="Twitter profile for @rm" rel="nofollow noopener" target="_blank">@rm</a> $(SERVER_OUT) $(CLIENT_OUT) $(API_OUT) $(API_REST_OUT)</pre><pre name="a664" id="a664" class="graf graf--pre graf-after--pre">help: ## Display this help screen<br>  <a href="http://twitter.com/grep" data-href="http://twitter.com/grep" class="markup--anchor markup--pre-anchor" title="Twitter profile for @grep" rel="nofollow noopener" target="_blank">@grep</a> -E '^[a-zA-Z_-]+:.*?## .*$$' $(MAKEFILE_LIST) | sort | awk 'BEGIN {FS = ":.*?## "}; {printf "\033[36m%-30s\033[0m %s\n", $$1, $$2}'</pre><p name="4f52" id="4f52" class="graf graf--p graf-after--pre">Generate the Go code for the gateway (the file <code class="markup--code markup--p-code">api/api.pb.gw.go</code> will be generated — just as <code class="markup--code markup--p-code">api/api.pb.go</code>, don’t edit it, it will be updated by compilation):</p><pre name="7be8" id="7be8" class="graf graf--pre graf-after--p">$ make api</pre><p name="868c" id="868c" class="graf graf--p graf-after--pre">The change on the server side is more important. The <code class="markup--code markup--p-code">grpc.Serve()</code> function is a blocking function, that returns only on error (or can get killed by a signal). As we need to start another server (the REST interface), we need this call to be non-blocking. Fortunately, we have <strong class="markup--strong markup--p-strong">goroutines</strong> just for that. And there is a trick on the authentication. As the REST gateway is just a reverse-proxy, it acts as a client from the gRPC perspective. Thus it needs to use a <code class="markup--code markup--p-code">WithPerRPCCredentials</code> option when dialing the server.</p><p name="efae" id="efae" class="graf graf--p graf-after--p">Head to your <code class="markup--code markup--p-code"><a href="https://gitlab.com/pantomath-io/demo-grpc/blob/add-rest/server/main.go" data-href="https://gitlab.com/pantomath-io/demo-grpc/blob/add-rest/server/main.go" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">server/main.go</a></code> file:</p><pre name="ec62" id="ec62" class="graf graf--pre graf-after--p">package main</pre><pre name="0919" id="0919" class="graf graf--pre graf-after--pre">import (<br>  "fmt"<br>  "log"<br>  "net"<br>  "net/http"<br>  "strings"</pre><pre name="2cc3" id="2cc3" class="graf graf--pre graf-after--pre">  "github.com/grpc-ecosystem/grpc-gateway/runtime"<br>  "golang.org/x/net/context"<br>  "gitlab.com/pantomath-io/demo-grpc/api"<br>  "google.golang.org/grpc"<br>  "google.golang.org/grpc/credentials"<br>  "google.golang.org/grpc/metadata"<br>)</pre><pre name="0450" id="0450" class="graf graf--pre graf-after--pre">// private type for Context keys<br>type contextKey int</pre><pre name="712d" id="712d" class="graf graf--pre graf-after--pre">const (<br>  clientIDKey contextKey = iota<br>)</pre><pre name="3e51" id="3e51" class="graf graf--pre graf-after--pre">func credMatcher(headerName string) (mdName string, ok bool) {<br>  if headerName == "Login" || headerName == "Password" {<br>    return headerName, true<br>  }<br>  return "", false<br>}</pre><pre name="f645" id="f645" class="graf graf--pre graf-after--pre">// authenticateAgent check the client credentials<br>func authenticateClient(ctx context.Context, s *api.Server) (string, error) {<br>  if md, ok := metadata.FromIncomingContext(ctx); ok {<br>    clientLogin := strings.Join(md["login"], "")<br>    clientPassword := strings.Join(md["password"], "")</pre><pre name="fec5" id="fec5" class="graf graf--pre graf-after--pre">    if clientLogin != "john" {<br>      return "", fmt.Errorf("unknown user %s", clientLogin)<br>    }<br>    if clientPassword != "doe" {<br>      return "", fmt.Errorf("bad password %s", clientPassword)<br>    }</pre><pre name="5dfa" id="5dfa" class="graf graf--pre graf-after--pre">    log.Printf("authenticated client: %s", clientLogin)<br>    return "42", nil<br>  }<br>  return "", fmt.Errorf("missing credentials")<br>}</pre><pre name="2c1c" id="2c1c" class="graf graf--pre graf-after--pre">// unaryInterceptor call authenticateClient with current context<br>func unaryInterceptor(ctx context.Context, req interface{}, info *grpc.UnaryServerInfo, handler grpc.UnaryHandler) (interface{}, error) {<br>  s, ok := info.Server.(*api.Server)<br>  if !ok {<br>    return nil, fmt.Errorf("unable to cast server")<br>  }<br>  clientID, err := authenticateClient(ctx, s)<br>  if err != nil {<br>    return nil, err<br>  }</pre><pre name="805e" id="805e" class="graf graf--pre graf-after--pre">  ctx = context.WithValue(ctx, clientIDKey, clientID)<br>  return handler(ctx, req)<br>}</pre><pre name="a9b4" id="a9b4" class="graf graf--pre graf-after--pre">func startGRPCServer(address, certFile, keyFile string) error {<br>  // create a listener on TCP port<br>  lis, err := net.Listen("tcp", address)<br>  if err != nil {<br>    return fmt.Errorf("failed to listen: %v", err)<br>  }</pre><pre name="42ca" id="42ca" class="graf graf--pre graf-after--pre">  // create a server instance<br>  s := api.Server{}</pre><pre name="55ec" id="55ec" class="graf graf--pre graf-after--pre">  // Create the TLS credentials<br>  creds, err := credentials.NewServerTLSFromFile(certFile, keyFile)<br>  if err != nil {<br>    return fmt.Errorf("could not load TLS keys: %s", err)<br>  }</pre><pre name="0762" id="0762" class="graf graf--pre graf-after--pre">  // Create an array of gRPC options with the credentials<br>  opts := []grpc.ServerOption{grpc.Creds(creds),<br>    grpc.UnaryInterceptor(unaryInterceptor)}</pre><pre name="ec19" id="ec19" class="graf graf--pre graf-after--pre">  // create a gRPC server object<br>  grpcServer := grpc.NewServer(opts...)</pre><pre name="6788" id="6788" class="graf graf--pre graf-after--pre">  // attach the Ping service to the server<br>  api.RegisterPingServer(grpcServer, &amp;s)</pre><pre name="96a7" id="96a7" class="graf graf--pre graf-after--pre">  // start the server<br>  log.Printf("starting HTTP/2 gRPC server on %s", address)<br>  if err := grpcServer.Serve(lis); err != nil {<br>    return fmt.Errorf("failed to serve: %s", err)<br>  }</pre><pre name="a82b" id="a82b" class="graf graf--pre graf-after--pre">  return nil<br>}</pre><pre name="dae7" id="dae7" class="graf graf--pre graf-after--pre">func startRESTServer(address, grpcAddress, certFile string) error {<br>  ctx := context.Background()<br>  ctx, cancel := context.WithCancel(ctx)<br>  defer cancel()</pre><pre name="2ade" id="2ade" class="graf graf--pre graf-after--pre">  mux := runtime.NewServeMux(runtime.WithIncomingHeaderMatcher(credMatcher))</pre><pre name="bb8c" id="bb8c" class="graf graf--pre graf-after--pre">  creds, err := credentials.NewClientTLSFromFile(certFile, "")<br>  if err != nil {<br>    return fmt.Errorf("could not load TLS certificate: %s", err)<br>  }</pre><pre name="0820" id="0820" class="graf graf--pre graf-after--pre">  // Setup the client gRPC options<br>  opts := []grpc.DialOption{grpc.WithTransportCredentials(creds)}</pre><pre name="cd36" id="cd36" class="graf graf--pre graf-after--pre">  // Register ping<br>  err = api.RegisterPingHandlerFromEndpoint(ctx, mux, grpcAddress, opts)<br>  if err != nil {<br>    return fmt.Errorf("could not register service Ping: %s", err)<br>  }</pre><pre name="7f0b" id="7f0b" class="graf graf--pre graf-after--pre">  log.Printf("starting HTTP/1.1 REST server on %s", address)<br>  http.ListenAndServe(address, mux)</pre><pre name="1b50" id="1b50" class="graf graf--pre graf-after--pre">  return nil<br>}</pre><pre name="872b" id="872b" class="graf graf--pre graf-after--pre">// main start a gRPC server and waits for connection<br>func main() {<br>  grpcAddress := fmt.Sprintf("%s:%d", "localhost", 7777)<br>  restAddress := fmt.Sprintf("%s:%d", "localhost", 7778)<br>  certFile := "cert/server.crt"<br>  keyFile := "cert/server.key"</pre><pre name="c96f" id="c96f" class="graf graf--pre graf-after--pre">  // fire the gRPC server in a goroutine<br>  go func() {<br>    err := startGRPCServer(grpcAddress, certFile, keyFile)<br>    if err != nil {<br>      log.Fatalf("failed to start gRPC server: %s", err)<br>    }<br>  }()</pre><pre name="7670" id="7670" class="graf graf--pre graf-after--pre">  // fire the REST server in a goroutine<br>  go func() {<br>    err := startRESTServer(restAddress, grpcAddress, certFile)<br>    if err != nil {<br>      log.Fatalf("failed to start gRPC server: %s", err)<br>    }<br>  }()</pre><pre name="3793" id="3793" class="graf graf--pre graf-after--pre">  // infinite loop<br>  log.Printf("Entering infinite loop")<br>  select {}<br>}</pre><p name="b471" id="b471" class="graf graf--p graf-after--pre">So what happened?</p><ul class="postList"><li name="9601" id="9601" class="graf graf--li graf-after--p">you moved all the code for the gRPC server creation in a goroutine with a dedicated function (<code class="markup--code markup--li-code">startGRPCServer</code>), so it does not block the <code class="markup--code markup--li-code">main</code>;</li><li name="a5bc" id="a5bc" class="graf graf--li graf-after--li">you create a new goroutine with a dedicated function (<code class="markup--code markup--li-code">startRESTServer</code>) where you create an HTTP/1.1 server;</li><li name="9df8" id="9df8" class="graf graf--li graf-after--li">in <code class="markup--code markup--li-code">startRESTServer</code> where you create the REST gateway, you start by getting the <code class="markup--code markup--li-code">context.Context</code> background object (i.e. the root of the context tree). Then, you create a request multiplexer object, <code class="markup--code markup--li-code">mux</code>, with an option: <code class="markup--code markup--li-code">runtime.WithIncomingHeaderMatcher</code>. This option takes a function reference as parameter, <code class="markup--code markup--li-code">credMatch</code>, and is called for every HTTP header from the incoming request. The function evaluates whether or not the HTTP header should be passed to the gRPC context;</li><li name="615f" id="615f" class="graf graf--li graf-after--li">you defined the <code class="markup--code markup--li-code">credMatch</code> function to match the credentials header, allowing them to be metadata in the gRPC context. This is how you have your authentication working, because the reverse-proxy uses the HTTP headers it receives when it connects to the gRPC server;</li><li name="d29e" id="d29e" class="graf graf--li graf-after--li">you also create a <code class="markup--code markup--li-code">credentials.NewClientTLSFromFile</code>, to be used as a <code class="markup--code markup--li-code">grpc.DialOption</code>, just like you did in the client side;</li><li name="9caf" id="9caf" class="graf graf--li graf-after--li">you register your api endpoint, i.e. you make the link between your multiplexer, you gRPC server, using the context and the gRPC options;</li><li name="869b" id="869b" class="graf graf--li graf-after--li">and finally, you start an HTTP/1.1 server, and wait for incoming connections;</li><li name="2c30" id="2c30" class="graf graf--li graf-after--li">aside to your goroutine, you use a blocking <code class="markup--code markup--li-code">select</code> call, so that your program does not end right away.</li></ul><p name="b097" id="b097" class="graf graf--p graf-after--li">Now build the whole project, so you can test the REST interface:</p><pre name="9f92" id="9f92" class="graf graf--pre graf-after--p">$ make</pre><p name="139f" id="139f" class="graf graf--p graf-after--pre">And run both sides in separate terminals:</p><pre name="e284" id="e284" class="graf graf--pre graf-after--p">$ bin/server<br>2006/01/02 15:04:05 Entering infinite loop<br>2006/01/02 15:04:05 starting HTTP/1.1 REST server on localhost:7778<br>2006/01/02 15:04:05 starting HTTP/2 gRPC server on localhost:7777<br>2006/01/02 15:04:05 authenticated client: john<br>2006/01/02 15:04:05 Receive message foo</pre><pre name="b0f0" id="b0f0" class="graf graf--pre graf-after--pre">$ curl -H "login:john" -H "password:doe" -X POST -d '{"greeting":"foo"}' '<a href="http://localhost:7778/1/ping%27" data-href="http://localhost:7778/1/ping&#39;" class="markup--anchor markup--pre-anchor" rel="nofollow" target="_blank">http://localhost:7778/1/ping'</a><br>{"greeting":"bar"}</pre><h3 name="f6e3" id="f6e3" class="graf graf--h3 graf-after--pre">One last&nbsp;swag…</h3><p name="c4d2" id="c4d2" class="graf graf--p graf-after--h3"><em class="markup--em markup--p-em">git tag: </em><a href="https://gitlab.com/pantomath-io/demo-grpc/tree/add-swagger" data-href="https://gitlab.com/pantomath-io/demo-grpc/tree/add-swagger" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank"><em class="markup--em markup--p-em">add-swagger</em></a></p><figure name="940f" id="940f" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 467px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 66.7%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*lg78b_518eFveLDKDsA5hQ.jpeg" data-width="5472" data-height="3648" data-action="zoom" data-action-value="1*lg78b_518eFveLDKDsA5hQ.jpeg" data-scroll="native"><img src="./How we use gRPC to build a client_server system in Go_files/1_lg78b_518eFveLDKDsA5hQ.jpeg" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="50"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/800/1*lg78b_518eFveLDKDsA5hQ.jpeg" src="./How we use gRPC to build a client_server system in Go_files/1_lg78b_518eFveLDKDsA5hQ(1).jpeg"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/800/1*lg78b_518eFveLDKDsA5hQ.jpeg"></noscript></div></div><figcaption class="imageCaption">Photo by <a href="https://unsplash.com/photos/ETNcibiiWOs?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" data-href="https://unsplash.com/photos/ETNcibiiWOs?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" class="markup--anchor markup--figure-anchor" rel="nofollow noopener" target="_blank">Lorenzo Castagnone</a> on&nbsp;<a href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" data-href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" class="markup--anchor markup--figure-anchor" rel="nofollow noopener" target="_blank">Unsplash</a></figcaption></figure><p name="a08f" id="a08f" class="graf graf--p graf-after--figure">The REST gateway is cool, but it would be even cooler to generate documentation from it, right?</p><p name="bc9e" id="bc9e" class="graf graf--p graf-after--p">You can do that for free, using a <a href="https://github.com/grpc-ecosystem/grpc-gateway" data-href="https://github.com/grpc-ecosystem/grpc-gateway" class="markup--anchor markup--p-anchor" rel="noopener nofollow" target="_blank">protoc plugin</a> to generate a <a href="https://swagger.io/" data-href="https://swagger.io/" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">swagger</a> json file:</p><pre name="23c1" id="23c1" class="graf graf--pre graf-after--p">protoc -I api/ \<br>  -I${GOPATH}/src \<br>  -I${GOPATH}/src/github.com/grpc-ecosystem/grpc-gateway/third_party/googleapis \<br>  --swagger_out=logtostderr=true:api \<br>  api/api.proto</pre><p name="9b4a" id="9b4a" class="graf graf--p graf-after--pre">This will generate a <code class="markup--code markup--p-code">api/api.swagger.json</code> file. As all generated code from Protobuf compilation, you should not edit it, but you can use it, and it can update it when you change your definition file.</p><p name="93f7" id="93f7" class="graf graf--p graf-after--p">You can add the compilation command in the <code class="markup--code markup--p-code"><a href="https://gitlab.com/pantomath-io/demo-grpc/blob/add-swagger/Makefile" data-href="https://gitlab.com/pantomath-io/demo-grpc/blob/add-swagger/Makefile" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">Makefile</a></code>.</p><h3 name="0d18" id="0d18" class="graf graf--h3 graf-after--p">Conclusion</h3><p name="917a" id="917a" class="graf graf--p graf-after--h3">You have a fully functional gRPC client and server, with SSL encryption &amp; authentication, client identification, and a REST gateway (with its swagger file). Where to go from here?</p><p name="13d3" id="13d3" class="graf graf--p graf-after--p">You can push a little on the REST gateway, to make it HTTPS instead of HTTP. You can obviously add more complex data structure on your Protobuf, alongside with more <code class="markup--code markup--p-code">service</code>. You can benefit from HTTP/2 features, such as <a href="https://grpc.io/docs/guides/concepts.html#bidirectional-streaming-rpc" data-href="https://grpc.io/docs/guides/concepts.html#bidirectional-streaming-rpc" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">streaming</a>, either from client to server, or from server to client, or bidirectional (but that’s only for gRPC, not for the REST, based on HTTP/1.1).</p><p name="deb2" id="deb2" class="graf graf--p graf-after--p graf--trailing"><em class="markup--em markup--p-em">Many thanks to </em><a href="https://medium.com/@loderunnr" data-href="https://medium.com/@loderunnr" data-anchor-type="2" data-user-id="177d8b64f64f" data-action-value="177d8b64f64f" data-action="show-user-card" data-action-type="hover" class="markup--user markup--p-user" target="_blank"><em class="markup--em markup--p-em">Charles Francoise</em></a><em class="markup--em markup--p-em"> who co-wrote this paper and </em><a href="https://gitlab.com/pantomath-io/demo-grpc" data-href="https://gitlab.com/pantomath-io/demo-grpc" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank"><em class="markup--em markup--p-em">https://gitlab.com/pantomath-io/demo-grpc</em></a><em class="markup--em markup--p-em">.</em></p></div></div></section><section name="8c8c" class="section section--body section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><p name="04a4" id="04a4" class="graf graf--p graf--leading graf--trailing"><em class="markup--em markup--p-em">We are currently working on Pantomath. Pantomath is a modern, open-source monitoring solution, built for performance, that bridges the gaps across all levels of your company. The well-being of your infrastructure is everyone’s business. Keep up with the project&nbsp;: </em><a href="http://goo.gl/tcxtXq" data-href="http://goo.gl/tcxtXq" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank"><em class="markup--em markup--p-em">goo.gl/tcxtXq</em></a></p></div></div></section></div><footer class="u-paddingTop10"><div class="container u-maxWidth740"><div class="row"><div class="col u-size12of12"></div></div><div class="row"><div class="col u-size12of12 js-postTags"><div class="u-paddingBottom10"><ul class="tags tags--postTags tags--borderless"><li><a class="link u-baseColor--link" href="https://medium.com/tag/golang?source=post" data-action-source="post">Golang</a></li><li><a class="link u-baseColor--link" href="https://medium.com/tag/grpc?source=post" data-action-source="post">Grpc</a></li><li><a class="link u-baseColor--link" href="https://medium.com/tag/protobuf?source=post" data-action-source="post">Protobuf</a></li><li><a class="link u-baseColor--link" href="https://medium.com/tag/tutorial?source=post" data-action-source="post">Tutorial</a></li><li><a class="link u-baseColor--link" href="https://medium.com/tag/api?source=post" data-action-source="post">API</a></li></ul></div></div></div><div class="postActions js-postActionsFooter "><div class="u-flexCenter"><div class="u-flex1"><div class="multirecommend js-actionMultirecommend u-flexCenter" data-post-id="dd20045fa1c2" data-is-icon-29px="true" data-is-circle="true" data-has-recommend-list="true" data-source="post_actions_footer-----dd20045fa1c2---------------------clap_footer" data-clap-string-singular="clap" data-clap-string-plural="claps"><div class="u-relative u-foreground"><button class="button button--large button--circle button--withChrome u-baseColor--buttonNormal button--withIcon button--withSvgIcon clapButton js-actionMultirecommendButton clapButton--darker clapButton--largePill u-relative u-foreground u-xs-paddingLeft13 u-width60 u-height60 u-accentColor--textNormal u-accentColor--buttonNormal clap-onboardingcollection" data-action="multivote" data-action-value="dd20045fa1c2" data-action-type="long-press" data-action-source="post_actions_footer-----dd20045fa1c2---------------------clap_footer" aria-label="Clap"><span class="button-defaultState"><span class="svgIcon svgIcon--clap svgIcon--33px u-relative u-topNegative2 u-xs-top0"><svg class="svgIcon-use" width="33" height="33"><path d="M28.86 17.342l-3.64-6.402c-.292-.433-.712-.729-1.163-.8a1.124 1.124 0 0 0-.889.213c-.63.488-.742 1.181-.33 2.061l1.222 2.587 1.4 2.46c2.234 4.085 1.511 8.007-2.145 11.663-.26.26-.526.49-.797.707 1.42-.084 2.881-.683 4.292-2.094 3.822-3.823 3.565-7.876 2.05-10.395zm-6.252 11.075c3.352-3.35 3.998-6.775 1.978-10.469l-3.378-5.945c-.292-.432-.712-.728-1.163-.8a1.122 1.122 0 0 0-.89.213c-.63.49-.742 1.182-.33 2.061l1.72 3.638a.502.502 0 0 1-.806.568l-8.91-8.91a1.335 1.335 0 0 0-1.887 1.886l5.292 5.292a.5.5 0 0 1-.707.707l-5.292-5.292-1.492-1.492c-.503-.503-1.382-.505-1.887 0a1.337 1.337 0 0 0 0 1.886l1.493 1.492 5.292 5.292a.499.499 0 0 1-.353.854.5.5 0 0 1-.354-.147L5.642 13.96a1.338 1.338 0 0 0-1.887 0 1.338 1.338 0 0 0 0 1.887l2.23 2.228 3.322 3.324a.499.499 0 0 1-.353.853.502.502 0 0 1-.354-.146l-3.323-3.324a1.333 1.333 0 0 0-1.886 0 1.325 1.325 0 0 0-.39.943c0 .356.138.691.39.943l6.396 6.397c3.528 3.53 8.86 5.313 12.821 1.353zM12.73 9.26l5.68 5.68-.49-1.037c-.518-1.107-.426-2.13.224-2.89l-3.303-3.304a1.337 1.337 0 0 0-1.886 0 1.326 1.326 0 0 0-.39.944c0 .217.067.42.165.607zm14.787 19.184c-1.599 1.6-3.417 2.392-5.353 2.392-.349 0-.7-.03-1.058-.082a7.922 7.922 0 0 1-3.667.887c-3.049 0-6.115-1.626-8.359-3.87l-6.396-6.397A2.315 2.315 0 0 1 2 19.724a2.327 2.327 0 0 1 1.923-2.296l-.875-.875a2.339 2.339 0 0 1 0-3.3 2.33 2.33 0 0 1 1.24-.647l-.139-.139c-.91-.91-.91-2.39 0-3.3.884-.884 2.421-.882 3.301 0l.138.14a2.335 2.335 0 0 1 3.948-1.24l.093.092c.091-.423.291-.828.62-1.157a2.336 2.336 0 0 1 3.3 0l3.384 3.386a2.167 2.167 0 0 1 1.271-.173c.534.086 1.03.354 1.441.765.11-.549.415-1.034.911-1.418a2.12 2.12 0 0 1 1.661-.41c.727.117 1.385.565 1.853 1.262l3.652 6.423c1.704 2.832 2.025 7.377-2.205 11.607zM13.217.484l-1.917.882 2.37 2.837-.454-3.719zm8.487.877l-1.928-.86-.44 3.697 2.368-2.837zM16.5 3.293L15.478-.005h2.044L16.5 3.293z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--clapFilled svgIcon--33px u-relative u-topNegative2 u-xs-top0"><svg class="svgIcon-use" width="33" height="33"><g fill-rule="evenodd"><path d="M29.58 17.1l-3.854-6.78c-.365-.543-.876-.899-1.431-.989a1.491 1.491 0 0 0-1.16.281c-.42.327-.65.736-.7 1.207v.001l3.623 6.367c2.46 4.498 1.67 8.802-2.333 12.807-.265.265-.536.505-.81.728 1.973-.222 3.474-1.286 4.45-2.263 4.166-4.165 3.875-8.6 2.215-11.36zm-4.831.82l-3.581-6.3c-.296-.439-.725-.742-1.183-.815a1.105 1.105 0 0 0-.89.213c-.647.502-.755 1.188-.33 2.098l1.825 3.858a.601.601 0 0 1-.197.747.596.596 0 0 1-.77-.067L10.178 8.21c-.508-.506-1.393-.506-1.901 0a1.335 1.335 0 0 0-.393.95c0 .36.139.698.393.95v.001l5.61 5.61a.599.599 0 1 1-.848.847l-5.606-5.606c-.001 0-.002 0-.003-.002L5.848 9.375a1.349 1.349 0 0 0-1.902 0 1.348 1.348 0 0 0 0 1.901l1.582 1.582 5.61 5.61a.6.6 0 0 1-.848.848l-5.61-5.61c-.51-.508-1.393-.508-1.9 0a1.332 1.332 0 0 0-.394.95c0 .36.139.697.393.952l2.363 2.362c.002.001.002.002.002.003l3.52 3.52a.6.6 0 0 1-.848.847l-3.522-3.523h-.001a1.336 1.336 0 0 0-.95-.393 1.345 1.345 0 0 0-.949 2.295l6.779 6.78c3.715 3.713 9.327 5.598 13.49 1.434 3.527-3.528 4.21-7.13 2.086-11.015zM11.817 7.727c.06-.328.213-.64.466-.893.64-.64 1.755-.64 2.396 0l3.232 3.232c-.82.783-1.09 1.833-.764 2.992l-5.33-5.33z"></path><path d="M13.285.48l-1.916.881 2.37 2.837z"></path><path d="M21.719 1.361L19.79.501l-.44 3.697z"></path><path d="M16.502 3.298L15.481 0h2.043z"></path></g></svg></span></span></button><div class="clapUndo u-width60 u-round u-height32 u-absolute u-borderBox u-paddingRight5 u-transition--transform200Springu-backgroundGrayLighter js-clapUndo" style="top: 14px; padding: 2px;"><button class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon u-floatRight" data-action="multivote-undo" data-action-value="dd20045fa1c2"><span class="svgIcon svgIcon--removeThin svgIcon--29px"><svg class="svgIcon-use" width="29" height="29"><path d="M20.13 8.11l-5.61 5.61-5.609-5.61-.801.801 5.61 5.61-5.61 5.61.801.8 5.61-5.609 5.61 5.61.8-.801-5.609-5.61 5.61-5.61" fill-rule="evenodd"></path></svg></span></button></div></div><span class="u-relative u-background js-actionMultirecommendCount u-marginLeft16"><button class="button button--chromeless u-baseColor--buttonNormal js-multirecommendCountButton u-textColorDarker" data-action="show-recommends" data-action-value="dd20045fa1c2">2K claps</button><span class="u-xs-hide"></span></span></div></div><div class="buttonSet u-flex0"><a class="button button--dark button--chromeless u-baseColor--buttonDark button--withIcon button--withSvgIcon button--dark button--chromeless u-xs-hide u-marginRight12" href="https://medium.com/p/dd20045fa1c2/share/twitter" title="Share on Twitter" aria-label="Share on Twitter" target="_blank" data-action-source="post_actions_footer"><span class="button-defaultState"><span class="svgIcon svgIcon--twitterFilled svgIcon--29px"><svg class="svgIcon-use" width="29" height="29"><path d="M22.053 7.54a4.474 4.474 0 0 0-3.31-1.455 4.526 4.526 0 0 0-4.526 4.524c0 .35.04.7.082 1.05a12.9 12.9 0 0 1-9.3-4.77c-.39.69-.61 1.46-.65 2.26.03 1.6.83 2.99 2.02 3.79-.72-.02-1.41-.22-2.02-.57-.01.02-.01.04 0 .08-.01 2.17 1.55 4 3.63 4.44-.39.08-.79.13-1.21.16-.28-.03-.57-.05-.81-.08.54 1.77 2.21 3.08 4.2 3.15a9.564 9.564 0 0 1-5.66 1.94c-.34-.03-.7-.06-1.05-.08 2 1.27 4.38 2.02 6.94 2.02 8.31 0 12.86-6.9 12.84-12.85.02-.24.01-.43 0-.65.89-.62 1.65-1.42 2.26-2.34-.82.38-1.69.62-2.59.72a4.37 4.37 0 0 0 1.94-2.51c-.84.53-1.81.9-2.83 1.13z"></path></svg></span></span></a><a class="button button--dark button--chromeless u-baseColor--buttonDark button--withIcon button--withSvgIcon button--dark button--chromeless u-xs-hide u-marginRight12" href="https://medium.com/p/dd20045fa1c2/share/facebook" title="Share on Facebook" aria-label="Share on Facebook" target="_blank" data-action-source="post_actions_footer"><span class="button-defaultState"><span class="svgIcon svgIcon--facebookSquare svgIcon--29px"><svg class="svgIcon-use" width="29" height="29"><path d="M23.209 5H5.792A.792.792 0 0 0 5 5.791V23.21c0 .437.354.791.792.791h9.303v-7.125H12.72v-2.968h2.375v-2.375c0-2.455 1.553-3.662 3.741-3.662 1.049 0 1.95.078 2.213.112v2.565h-1.517c-1.192 0-1.469.567-1.469 1.397v1.963h2.969l-.594 2.968h-2.375L18.11 24h5.099a.791.791 0 0 0 .791-.791V5.79a.791.791 0 0 0-.791-.79"></path></svg></span></span></a><button class="button button--large button--dark button--chromeless u-baseColor--buttonDark button--withIcon button--withSvgIcon u-xs-show u-marginRight10" title="Share this story on Twitter or Facebook" aria-label="Share this story on Twitter or Facebook" data-action="show-share-popover" data-action-source="post_actions_footer"><span class="svgIcon svgIcon--share svgIcon--29px"><svg class="svgIcon-use" width="29" height="29"><path d="M20.385 8H19a.5.5 0 1 0 .011 1h1.39c.43 0 .84.168 1.14.473.31.305.48.71.48 1.142v10.77c0 .43-.17.837-.47 1.142-.3.305-.71.473-1.14.473H8.62c-.43 0-.84-.168-1.144-.473a1.603 1.603 0 0 1-.473-1.142v-10.77c0-.43.17-.837.48-1.142A1.599 1.599 0 0 1 8.62 9H10a.502.502 0 0 0 0-1H8.615c-.67 0-1.338.255-1.85.766-.51.51-.765 1.18-.765 1.85v10.77c0 .668.255 1.337.766 1.848.51.51 1.18.766 1.85.766h11.77c.668 0 1.337-.255 1.848-.766.51-.51.766-1.18.766-1.85v-10.77c0-.668-.255-1.337-.766-1.848A2.61 2.61 0 0 0 20.384 8zm-8.67-2.508L14 3.207v8.362c0 .27.224.5.5.5s.5-.23.5-.5V3.2l2.285 2.285a.49.49 0 0 0 .704-.001.511.511 0 0 0 0-.708l-3.14-3.14a.504.504 0 0 0-.71 0L11 4.776a.501.501 0 0 0 .71.706" fill-rule="evenodd"></path></svg></span></button><button class="button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon" data-action="respond" data-action-source="post_actions_footer"><span class="svgIcon svgIcon--response svgIcon--29px"><svg class="svgIcon-use" width="29" height="29"><path d="M21.27 20.058c1.89-1.826 2.754-4.17 2.754-6.674C24.024 8.21 19.67 4 14.1 4 8.53 4 4 8.21 4 13.384c0 5.175 4.53 9.385 10.1 9.385 1.007 0 2-.14 2.95-.41.285.25.592.49.918.7 1.306.87 2.716 1.31 4.19 1.31.276-.01.494-.14.6-.36a.625.625 0 0 0-.052-.65c-.61-.84-1.042-1.71-1.282-2.58a5.417 5.417 0 0 1-.154-.75zm-3.85 1.324l-.083-.28-.388.12a9.72 9.72 0 0 1-2.85.424c-4.96 0-8.99-3.706-8.99-8.262 0-4.556 4.03-8.263 8.99-8.263 4.95 0 8.77 3.71 8.77 8.27 0 2.25-.75 4.35-2.5 5.92l-.24.21v.32c0 .07 0 .19.02.37.03.29.1.6.19.92.19.7.49 1.4.89 2.08-.93-.14-1.83-.49-2.67-1.06-.34-.22-.88-.48-1.16-.74z"></path></svg></span></button><button class="button button--chromeless u-baseColor--buttonNormal u-marginRight12" data-action="scroll-to-responses">9</button><button class="button button--large button--dark button--chromeless is-touchIconFadeInPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton" title="Bookmark this story to read later" aria-label="Bookmark this story to read later" data-action="add-to-bookmarks" data-action-value="dd20045fa1c2" data-action-source="post_actions_footer"><span class="button-defaultState"><span class="svgIcon svgIcon--bookmark svgIcon--29px u-marginRight4"><svg class="svgIcon-use" width="29" height="29"><path d="M19.385 4h-9.77A2.623 2.623 0 0 0 7 6.615V23.01a1.022 1.022 0 0 0 1.595.847l5.905-4.004 5.905 4.004A1.022 1.022 0 0 0 22 23.011V6.62A2.625 2.625 0 0 0 19.385 4zM21 23l-5.91-3.955-.148-.107a.751.751 0 0 0-.884 0l-.147.107L8 23V6.615C8 5.725 8.725 5 9.615 5h9.77C20.275 5 21 5.725 21 6.615V23z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--bookmarkFilled svgIcon--29px u-marginRight4"><svg class="svgIcon-use" width="29" height="29"><path d="M19.385 4h-9.77A2.623 2.623 0 0 0 7 6.615V23.01a1.022 1.022 0 0 0 1.595.847l5.905-4.004 5.905 4.004A1.022 1.022 0 0 0 22 23.011V6.62A2.625 2.625 0 0 0 19.385 4z" fill-rule="evenodd"></path></svg></span></span></button><button class="button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon js-moreActionsButton" title="More actions" aria-label="More actions" data-action="more-actions"><span class="svgIcon svgIcon--more svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="-480.5 272.5 21 21"><path d="M-463 284.6c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5zm-7-.9c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5zm-7-.9c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5z"></path></svg></span></button></div></div></div></div><div class="u-maxWidth740 u-paddingTop20 u-marginTop20 u-borderTopLightest container u-paddingBottom20 u-xs-paddingBottom10 js-postAttributionFooterContainer"><div class="row js-postFooterInfo"><div class="col u-size6of12 u-xs-size12of12"><li class="uiScale uiScale-ui--small uiScale-caption--regular u-block u-paddingBottom18 js-cardUser"><div class="u-marginLeft20 u-floatRight"><span class="followState js-followState" data-user-id="2f5a2cbeb497"><button class="button button--small u-noUserSelect button--withChrome u-baseColor--buttonNormal button--withHover button--unblock js-unblockButton" data-action="toggle-block-user" data-action-value="2f5a2cbeb497" data-action-source="footer_card"><span class="button-label  button-defaultState">Blocked</span><span class="button-label button-hoverState">Unblock</span></button><button class="button button--primary button--small u-noUserSelect button--withChrome u-accentColor--buttonNormal button--follow js-followButton" data-action="toggle-subscribe-user" data-action-value="2f5a2cbeb497" data-action-source="footer_card-2f5a2cbeb497-------------------------follow_footer" data-subscribe-source="footer_card" data-follow-context-entity-id="dd20045fa1c2"><span class="button-label  button-defaultState js-buttonLabel">Follow</span><span class="button-label button-activeState">Following</span></button></span></div><div class="u-tableCell"><a class="link u-baseColor--link avatar" href="https://medium.com/@chilladx?source=footer_card" title="Go to the profile of Julien Andrieux" aria-label="Go to the profile of Julien Andrieux" data-action-source="footer_card" data-user-id="2f5a2cbeb497" dir="auto"><img src="./How we use gRPC to build a client_server system in Go_files/1_uZ56OzX2vlJdTqfmMIruUg(1).jpeg" class="avatar-image avatar-image--small" alt="Go to the profile of Julien Andrieux"></a></div><div class="u-tableCell u-verticalAlignMiddle u-breakWord u-paddingLeft15"><h3 class="ui-h3 u-fontSize18 u-lineHeightTighter u-marginBottom4"><a class="link link--primary u-accentColor--hoverTextNormal" href="https://medium.com/@chilladx" property="cc:attributionName" title="Go to the profile of Julien Andrieux" aria-label="Go to the profile of Julien Andrieux" rel="author cc:attributionUrl" data-user-id="2f5a2cbeb497" dir="auto">Julien Andrieux</a></h3><p class="ui-body u-fontSize14 u-lineHeightBaseSans u-textColorDark u-marginBottom4">CTO &amp; Entrepreneur, trying-to-be digital nomad, learner</p></div></li></div><div class="col u-size6of12 u-xs-size12of12 u-xs-marginTop30"><li class="uiScale uiScale-ui--small uiScale-caption--regular u-block u-paddingBottom18 js-cardCollection"><div class="u-marginLeft20 u-floatRight"><button class="button button--primary button--small u-noUserSelect button--withChrome u-accentColor--buttonNormal js-relationshipButton" data-action="toggle-follow-collection" data-action-source="footer_card----cf62d19c744----------------------follow_footer" data-collection-id="cf62d19c744"><span class="button-label  js-buttonLabel">Follow</span></button></div><div class="u-tableCell "><a class="link u-baseColor--link avatar avatar--roundedRectangle" href="https://medium.com/pantomath?source=footer_card" title="Go to Pantomath" aria-label="Go to Pantomath" data-action-source="footer_card"><img src="./How we use gRPC to build a client_server system in Go_files/1_3UOXOjhNOVBhUEeFY6s-aQ(1).png" class="avatar-image u-size60x60" alt="Pantomath"></a></div><div class="u-tableCell u-verticalAlignMiddle u-breakWord u-paddingLeft15"><h3 class="ui-h3 u-fontSize18 u-lineHeightTighter u-marginBottom4"><a class="link link--primary u-accentColor--hoverTextNormal" href="https://medium.com/pantomath?source=footer_card" rel="collection" data-action-source="footer_card">Pantomath</a></h3><p class="ui-body u-fontSize14 u-lineHeightBaseSans u-textColorDark u-marginBottom4">Pantomath is a cutting edge monitoring solution</p><div class="buttonSet"></div></div></li></div></div></div><div class="js-postFooterPlacements" data-post-id="dd20045fa1c2" data-collection-id="cf62d19c744" data-scroll="native"><div class="streamItem streamItem--placementCardGrid js-streamItem"><div class="u-clearfix u-backgroundGrayLightest"><div class="row u-marginAuto u-maxWidth1032 u-paddingTop30 u-paddingBottom40"><div class="col u-padding8 u-xs-size12of12 u-size4of12"><div class="uiScale uiScale-ui--small uiScale-caption--regular u-height280 u-width100pct u-backgroundWhite u-borderCardBorder u-boxShadow u-borderBox u-borderRadius4 js-trackPostPresentation" data-post-id="8af2b639478" data-source="placement_card_footer_grid---------0-60" data-tracking-context="placement" data-scroll="native"><a class="link link--noUnderline u-baseColor--link" href="https://medium.com/rungo/string-data-type-in-go-8af2b639478?source=placement_card_footer_grid---------0-60" data-action-source="placement_card_footer_grid---------0-60"><div class="u-backgroundCover u-backgroundColorGrayLight u-height100 u-width100pct u-borderBottomLight u-borderRadiusTop4" style="background-image: url(&quot;https://cdn-images-1.medium.com/fit/c/400/120/1*bD5d60Qjd13wWasHjniQXw.png&quot;); background-position: 50% 50% !important;"></div></a><div class="u-padding15 u-borderBox u-flexColumn u-height180"><a class="link link--noUnderline u-baseColor--link u-flex1" href="https://medium.com/rungo/string-data-type-in-go-8af2b639478?source=placement_card_footer_grid---------0-60" data-action-source="placement_card_footer_grid---------0-60"><div class="uiScale uiScale-ui--regular uiScale-caption--small u-textColorNormal u-marginBottom7">Related reads</div><div class="ui-h3 ui-clamp2 u-textColorDarkest u-contentSansBold u-fontSize24 u-maxHeight2LineHeightTighter u-lineClamp2 u-textOverflowEllipsis u-letterSpacingTight u-paddingBottom2">String Data Type in Go</div></a><div class="u-paddingBottom10 u-flex0 u-flexCenter"><div class="u-flex1 u-minWidth0 u-marginRight10"><div class="u-flexCenter"><div class="postMetaInline-avatar u-flex0"><a class="link u-baseColor--link avatar" href="https://medium.com/@thatisuday" data-action="show-user-card" data-action-value="647c590c91dc" data-action-type="hover" data-user-id="647c590c91dc" dir="auto"><img src="./How we use gRPC to build a client_server system in Go_files/1_jvf5oJ1Oly9pU0S7QELhWA.jpeg" class="avatar-image u-size36x36 u-xs-size32x32" alt="Go to the profile of Uday Hiwarale"></a></div><div class="postMetaInline postMetaInline-authorLockup ui-captionStrong u-flex1 u-noWrapWithEllipsis"><a class="ds-link ds-link--styleSubtle link link--darken link--darker" href="https://medium.com/@thatisuday?source=placement_card_footer_grid---------0-60" data-action="show-user-card" data-action-source="placement_card_footer_grid---------0-60" data-action-value="647c590c91dc" data-action-type="hover" data-user-id="647c590c91dc" dir="auto">Uday Hiwarale</a><div class="ui-caption u-fontSize12 u-baseColor--textNormal u-textColorNormal js-postMetaInlineSupplemental"><a class="link link--darken" href="https://medium.com/rungo/string-data-type-in-go-8af2b639478?source=placement_card_footer_grid---------0-60" data-action="open-post" data-action-value="https://medium.com/rungo/string-data-type-in-go-8af2b639478?source=placement_card_footer_grid---------0-60" data-action-source="preview-listing"><time datetime="2018-08-05T09:16:23.670Z">Aug 5, 2018</time></a><span class="middotDivider u-fontSize12"></span><span class="readingTime" title="8 min read"></span></div></div></div></div><div class="u-flex0 u-flexCenter"><div class="buttonSet"><div class="multirecommend js-actionMultirecommend u-flexCenter" data-post-id="8af2b639478" data-is-label-padded="true" data-source="placement_card_footer_grid-----8af2b639478----0-60----------------clap_preview"><div class="u-relative u-foreground"><button class="button button--primary button--chromeless u-accentColor--buttonNormal button--withIcon button--withSvgIcon clapButton js-actionMultirecommendButton clapButton--darker" data-action="multivote" data-action-value="8af2b639478" data-action-type="long-press" data-action-source="placement_card_footer_grid-----8af2b639478----0-60----------------clap_preview" aria-label="Clap"><span class="button-defaultState"><span class="svgIcon svgIcon--clap svgIcon--25px"><svg class="svgIcon-use" width="25" height="25"><g fill-rule="evenodd"><path d="M11.739 0l.761 2.966L13.261 0z"></path><path d="M14.815 3.776l1.84-2.551-1.43-.471z"></path><path d="M8.378 1.224l1.84 2.551L9.81.753z"></path><path d="M20.382 21.622c-1.04 1.04-2.115 1.507-3.166 1.608.168-.14.332-.29.492-.45 2.885-2.886 3.456-5.982 1.69-9.211l-1.101-1.937-.955-2.02c-.315-.676-.235-1.185.245-1.556a.836.836 0 0 1 .66-.16c.342.056.66.28.879.605l2.856 5.023c1.179 1.962 1.379 5.119-1.6 8.098m-13.29-.528l-5.02-5.02a1 1 0 0 1 .707-1.701c.255 0 .512.098.707.292l2.607 2.607a.442.442 0 0 0 .624-.624L4.11 14.04l-1.75-1.75a.998.998 0 1 1 1.41-1.413l4.154 4.156a.44.44 0 0 0 .624 0 .44.44 0 0 0 0-.624l-4.152-4.153-1.172-1.171a.998.998 0 0 1 0-1.41 1.018 1.018 0 0 1 1.41 0l1.172 1.17 4.153 4.152a.437.437 0 0 0 .624 0 .442.442 0 0 0 0-.624L6.43 8.222a.988.988 0 0 1-.291-.705.99.99 0 0 1 .29-.706 1 1 0 0 1 1.412 0l6.992 6.993a.443.443 0 0 0 .71-.501l-1.35-2.856c-.315-.676-.235-1.185.246-1.557a.85.85 0 0 1 .66-.16c.342.056.659.28.879.606L18.628 14c1.573 2.876 1.067 5.545-1.544 8.156-1.396 1.397-3.144 1.966-5.063 1.652-1.713-.286-3.463-1.248-4.928-2.714zM10.99 5.976l2.562 2.562c-.497.607-.563 1.414-.155 2.284l.265.562-4.257-4.257a.98.98 0 0 1-.117-.445c0-.267.104-.517.292-.706a1.023 1.023 0 0 1 1.41 0zm8.887 2.06c-.375-.557-.902-.916-1.486-1.011a1.738 1.738 0 0 0-1.342.332c-.376.29-.61.656-.712 1.065a2.1 2.1 0 0 0-1.095-.562 1.776 1.776 0 0 0-.992.128l-2.636-2.636a1.883 1.883 0 0 0-2.658 0 1.862 1.862 0 0 0-.478.847 1.886 1.886 0 0 0-2.671-.012 1.867 1.867 0 0 0-.503.909c-.754-.754-1.992-.754-2.703-.044a1.881 1.881 0 0 0 0 2.658c-.288.12-.605.288-.864.547a1.884 1.884 0 0 0 0 2.659l.624.622a1.879 1.879 0 0 0-.91 3.16l5.019 5.02c1.595 1.594 3.515 2.645 5.408 2.959a7.16 7.16 0 0 0 1.173.098c1.026 0 1.997-.24 2.892-.7.279.04.555.065.828.065 1.53 0 2.969-.628 4.236-1.894 3.338-3.338 3.083-6.928 1.738-9.166l-2.868-5.043z"></path></g></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--clapFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25"><g fill-rule="evenodd"><path d="M11.738 0l.762 2.966L13.262 0z"></path><path d="M16.634 1.224l-1.432-.47-.408 3.022z"></path><path d="M9.79.754l-1.431.47 1.84 2.552z"></path><path d="M22.472 13.307l-3.023-5.32c-.287-.426-.689-.705-1.123-.776a1.16 1.16 0 0 0-.911.221c-.297.231-.474.515-.535.84.017.022.036.04.053.063l2.843 5.001c1.95 3.564 1.328 6.973-1.843 10.144a8.46 8.46 0 0 1-.549.501c1.205-.156 2.328-.737 3.351-1.76 3.268-3.268 3.041-6.749 1.737-8.914"></path><path d="M12.58 9.887c-.156-.83.096-1.569.692-2.142L10.78 5.252c-.5-.504-1.378-.504-1.879 0-.178.18-.273.4-.329.63l4.008 4.005z"></path><path d="M15.812 9.04c-.218-.323-.539-.55-.88-.606a.814.814 0 0 0-.644.153c-.176.137-.713.553-.24 1.566l1.43 3.025a.539.539 0 1 1-.868.612L7.2 6.378a.986.986 0 1 0-1.395 1.395l4.401 4.403a.538.538 0 1 1-.762.762L5.046 8.54 3.802 7.295a.99.99 0 0 0-1.396 0 .981.981 0 0 0 0 1.394L3.647 9.93l4.402 4.403a.537.537 0 0 1 0 .761.535.535 0 0 1-.762 0L2.89 10.696a.992.992 0 0 0-1.399-.003.983.983 0 0 0 0 1.395l1.855 1.854 2.763 2.765a.538.538 0 0 1-.76.761l-2.765-2.764a.982.982 0 0 0-1.395 0 .989.989 0 0 0 0 1.395l5.32 5.32c3.371 3.372 6.64 4.977 10.49 1.126C19.74 19.8 20.271 17 18.62 13.982L15.812 9.04z"></path></g></svg></span></span></button></div><span class="u-relative u-background js-actionMultirecommendCount u-marginLeft5"><button class="button button--chromeless u-baseColor--buttonNormal js-multirecommendCountButton u-disablePointerEvents u-marginLeft4" data-action="show-recommends" data-action-value="8af2b639478">1.2K</button></span></div></div><div class="u-height20 u-borderRightLighter u-inlineBlock u-relative u-marginRight10 u-marginLeft12"></div><div class="buttonSet"><button class="button button--chromeless is-touchIconFadeInPulse u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton" title="Bookmark this story to read later" aria-label="Bookmark this story to read later" data-action="add-to-bookmarks" data-action-value="8af2b639478" data-action-source="placement_card_footer_grid-----8af2b639478----0-60----------------bookmark_preview"><span class="button-defaultState"><span class="svgIcon svgIcon--bookmark svgIcon--25px"><svg class="svgIcon-use" width="25" height="25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126a.508.508 0 0 0 .708-.03.5.5 0 0 0 .118-.285H19V6zm-6.838 9.97L7 19.636V6c0-.55.45-1 1-1h9c.55 0 1 .45 1 1v13.637l-5.162-3.668a.49.49 0 0 0-.676 0z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--bookmarkFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126c.205.183.52.17.708-.03a.5.5 0 0 0 .118-.285H19V6z"></path></svg></span></span></button></div></div></div></div></div></div><div class="col u-padding8 u-xs-size12of12 u-size4of12"><div class="uiScale uiScale-ui--small uiScale-caption--regular u-height280 u-width100pct u-backgroundWhite u-borderCardBorder u-boxShadow u-borderBox u-borderRadius4 js-trackPostPresentation" data-post-id="6450e3bb2b94" data-source="placement_card_footer_grid---------1-60" data-tracking-context="placement" data-scroll="native"><a class="link link--noUnderline u-baseColor--link" href="https://medium.com/rungo/the-anatomy-of-slices-in-go-6450e3bb2b94?source=placement_card_footer_grid---------1-60" data-action-source="placement_card_footer_grid---------1-60"><div class="u-backgroundCover u-backgroundColorGrayLight u-height100 u-width100pct u-borderBottomLight u-borderRadiusTop4" style="background-image: url(&quot;https://cdn-images-1.medium.com/fit/c/400/120/1*GgwaLhYsJbXS-YddbYzrAw.jpeg&quot;); background-position: 50% 50% !important;"></div></a><div class="u-padding15 u-borderBox u-flexColumn u-height180"><a class="link link--noUnderline u-baseColor--link u-flex1" href="https://medium.com/rungo/the-anatomy-of-slices-in-go-6450e3bb2b94?source=placement_card_footer_grid---------1-60" data-action-source="placement_card_footer_grid---------1-60"><div class="uiScale uiScale-ui--regular uiScale-caption--small u-textColorNormal u-marginBottom7">Related reads</div><div class="ui-h3 ui-clamp2 u-textColorDarkest u-contentSansBold u-fontSize24 u-maxHeight2LineHeightTighter u-lineClamp2 u-textOverflowEllipsis u-letterSpacingTight u-paddingBottom2">The anatomy of Slices in Go</div></a><div class="u-paddingBottom10 u-flex0 u-flexCenter"><div class="u-flex1 u-minWidth0 u-marginRight10"><div class="u-flexCenter"><div class="postMetaInline-avatar u-flex0"><a class="link u-baseColor--link avatar" href="https://medium.com/@thatisuday" data-action="show-user-card" data-action-value="647c590c91dc" data-action-type="hover" data-user-id="647c590c91dc" dir="auto"><img src="./How we use gRPC to build a client_server system in Go_files/1_jvf5oJ1Oly9pU0S7QELhWA.jpeg" class="avatar-image u-size36x36 u-xs-size32x32" alt="Go to the profile of Uday Hiwarale"></a></div><div class="postMetaInline postMetaInline-authorLockup ui-captionStrong u-flex1 u-noWrapWithEllipsis"><a class="ds-link ds-link--styleSubtle link link--darken link--darker" href="https://medium.com/@thatisuday?source=placement_card_footer_grid---------1-60" data-action="show-user-card" data-action-source="placement_card_footer_grid---------1-60" data-action-value="647c590c91dc" data-action-type="hover" data-user-id="647c590c91dc" dir="auto">Uday Hiwarale</a><div class="ui-caption u-fontSize12 u-baseColor--textNormal u-textColorNormal js-postMetaInlineSupplemental"><a class="link link--darken" href="https://medium.com/rungo/the-anatomy-of-slices-in-go-6450e3bb2b94?source=placement_card_footer_grid---------1-60" data-action="open-post" data-action-value="https://medium.com/rungo/the-anatomy-of-slices-in-go-6450e3bb2b94?source=placement_card_footer_grid---------1-60" data-action-source="preview-listing"><time datetime="2018-09-10T13:35:22.243Z">Sep 10, 2018</time></a><span class="middotDivider u-fontSize12"></span><span class="readingTime" title="13 min read"></span></div></div></div></div><div class="u-flex0 u-flexCenter"><div class="buttonSet"><div class="multirecommend js-actionMultirecommend u-flexCenter" data-post-id="6450e3bb2b94" data-is-label-padded="true" data-source="placement_card_footer_grid-----6450e3bb2b94----1-60----------------clap_preview"><div class="u-relative u-foreground"><button class="button button--primary button--chromeless u-accentColor--buttonNormal button--withIcon button--withSvgIcon clapButton js-actionMultirecommendButton clapButton--darker" data-action="multivote" data-action-value="6450e3bb2b94" data-action-type="long-press" data-action-source="placement_card_footer_grid-----6450e3bb2b94----1-60----------------clap_preview" aria-label="Clap"><span class="button-defaultState"><span class="svgIcon svgIcon--clap svgIcon--25px"><svg class="svgIcon-use" width="25" height="25"><g fill-rule="evenodd"><path d="M11.739 0l.761 2.966L13.261 0z"></path><path d="M14.815 3.776l1.84-2.551-1.43-.471z"></path><path d="M8.378 1.224l1.84 2.551L9.81.753z"></path><path d="M20.382 21.622c-1.04 1.04-2.115 1.507-3.166 1.608.168-.14.332-.29.492-.45 2.885-2.886 3.456-5.982 1.69-9.211l-1.101-1.937-.955-2.02c-.315-.676-.235-1.185.245-1.556a.836.836 0 0 1 .66-.16c.342.056.66.28.879.605l2.856 5.023c1.179 1.962 1.379 5.119-1.6 8.098m-13.29-.528l-5.02-5.02a1 1 0 0 1 .707-1.701c.255 0 .512.098.707.292l2.607 2.607a.442.442 0 0 0 .624-.624L4.11 14.04l-1.75-1.75a.998.998 0 1 1 1.41-1.413l4.154 4.156a.44.44 0 0 0 .624 0 .44.44 0 0 0 0-.624l-4.152-4.153-1.172-1.171a.998.998 0 0 1 0-1.41 1.018 1.018 0 0 1 1.41 0l1.172 1.17 4.153 4.152a.437.437 0 0 0 .624 0 .442.442 0 0 0 0-.624L6.43 8.222a.988.988 0 0 1-.291-.705.99.99 0 0 1 .29-.706 1 1 0 0 1 1.412 0l6.992 6.993a.443.443 0 0 0 .71-.501l-1.35-2.856c-.315-.676-.235-1.185.246-1.557a.85.85 0 0 1 .66-.16c.342.056.659.28.879.606L18.628 14c1.573 2.876 1.067 5.545-1.544 8.156-1.396 1.397-3.144 1.966-5.063 1.652-1.713-.286-3.463-1.248-4.928-2.714zM10.99 5.976l2.562 2.562c-.497.607-.563 1.414-.155 2.284l.265.562-4.257-4.257a.98.98 0 0 1-.117-.445c0-.267.104-.517.292-.706a1.023 1.023 0 0 1 1.41 0zm8.887 2.06c-.375-.557-.902-.916-1.486-1.011a1.738 1.738 0 0 0-1.342.332c-.376.29-.61.656-.712 1.065a2.1 2.1 0 0 0-1.095-.562 1.776 1.776 0 0 0-.992.128l-2.636-2.636a1.883 1.883 0 0 0-2.658 0 1.862 1.862 0 0 0-.478.847 1.886 1.886 0 0 0-2.671-.012 1.867 1.867 0 0 0-.503.909c-.754-.754-1.992-.754-2.703-.044a1.881 1.881 0 0 0 0 2.658c-.288.12-.605.288-.864.547a1.884 1.884 0 0 0 0 2.659l.624.622a1.879 1.879 0 0 0-.91 3.16l5.019 5.02c1.595 1.594 3.515 2.645 5.408 2.959a7.16 7.16 0 0 0 1.173.098c1.026 0 1.997-.24 2.892-.7.279.04.555.065.828.065 1.53 0 2.969-.628 4.236-1.894 3.338-3.338 3.083-6.928 1.738-9.166l-2.868-5.043z"></path></g></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--clapFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25"><g fill-rule="evenodd"><path d="M11.738 0l.762 2.966L13.262 0z"></path><path d="M16.634 1.224l-1.432-.47-.408 3.022z"></path><path d="M9.79.754l-1.431.47 1.84 2.552z"></path><path d="M22.472 13.307l-3.023-5.32c-.287-.426-.689-.705-1.123-.776a1.16 1.16 0 0 0-.911.221c-.297.231-.474.515-.535.84.017.022.036.04.053.063l2.843 5.001c1.95 3.564 1.328 6.973-1.843 10.144a8.46 8.46 0 0 1-.549.501c1.205-.156 2.328-.737 3.351-1.76 3.268-3.268 3.041-6.749 1.737-8.914"></path><path d="M12.58 9.887c-.156-.83.096-1.569.692-2.142L10.78 5.252c-.5-.504-1.378-.504-1.879 0-.178.18-.273.4-.329.63l4.008 4.005z"></path><path d="M15.812 9.04c-.218-.323-.539-.55-.88-.606a.814.814 0 0 0-.644.153c-.176.137-.713.553-.24 1.566l1.43 3.025a.539.539 0 1 1-.868.612L7.2 6.378a.986.986 0 1 0-1.395 1.395l4.401 4.403a.538.538 0 1 1-.762.762L5.046 8.54 3.802 7.295a.99.99 0 0 0-1.396 0 .981.981 0 0 0 0 1.394L3.647 9.93l4.402 4.403a.537.537 0 0 1 0 .761.535.535 0 0 1-.762 0L2.89 10.696a.992.992 0 0 0-1.399-.003.983.983 0 0 0 0 1.395l1.855 1.854 2.763 2.765a.538.538 0 0 1-.76.761l-2.765-2.764a.982.982 0 0 0-1.395 0 .989.989 0 0 0 0 1.395l5.32 5.32c3.371 3.372 6.64 4.977 10.49 1.126C19.74 19.8 20.271 17 18.62 13.982L15.812 9.04z"></path></g></svg></span></span></button></div><span class="u-relative u-background js-actionMultirecommendCount u-marginLeft5"><button class="button button--chromeless u-baseColor--buttonNormal js-multirecommendCountButton u-disablePointerEvents u-marginLeft4" data-action="show-recommends" data-action-value="6450e3bb2b94">1.1K</button></span></div></div><div class="u-height20 u-borderRightLighter u-inlineBlock u-relative u-marginRight10 u-marginLeft12"></div><div class="buttonSet"><button class="button button--chromeless is-touchIconFadeInPulse u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton" title="Bookmark this story to read later" aria-label="Bookmark this story to read later" data-action="add-to-bookmarks" data-action-value="6450e3bb2b94" data-action-source="placement_card_footer_grid-----6450e3bb2b94----1-60----------------bookmark_preview"><span class="button-defaultState"><span class="svgIcon svgIcon--bookmark svgIcon--25px"><svg class="svgIcon-use" width="25" height="25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126a.508.508 0 0 0 .708-.03.5.5 0 0 0 .118-.285H19V6zm-6.838 9.97L7 19.636V6c0-.55.45-1 1-1h9c.55 0 1 .45 1 1v13.637l-5.162-3.668a.49.49 0 0 0-.676 0z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--bookmarkFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126c.205.183.52.17.708-.03a.5.5 0 0 0 .118-.285H19V6z"></path></svg></span></span></button></div></div></div></div></div></div><div class="col u-padding8 u-xs-size12of12 u-size4of12"><div class="uiScale uiScale-ui--small uiScale-caption--regular u-height280 u-width100pct u-backgroundWhite u-borderCardBorder u-boxShadow u-borderBox u-borderRadius4 js-trackPostPresentation" data-post-id="f795b4b453aa" data-source="placement_card_footer_grid---------2-60" data-tracking-context="placement" data-scroll="native"><a class="link link--noUnderline u-baseColor--link" href="https://itnext.io/beautify-your-golang-project-f795b4b453aa?source=placement_card_footer_grid---------2-60" data-action-source="placement_card_footer_grid---------2-60"><div class="u-backgroundCover u-backgroundColorGrayLight u-height100 u-width100pct u-borderBottomLight u-borderRadiusTop4" style="background-image: url(&quot;https://cdn-images-1.medium.com/fit/c/400/120/1*vK1rtSjZ33WXtjwr0jLD8g.jpeg&quot;); background-position: 50% 50% !important;"></div></a><div class="u-padding15 u-borderBox u-flexColumn u-height180"><a class="link link--noUnderline u-baseColor--link u-flex1" href="https://itnext.io/beautify-your-golang-project-f795b4b453aa?source=placement_card_footer_grid---------2-60" data-action-source="placement_card_footer_grid---------2-60"><div class="uiScale uiScale-ui--regular uiScale-caption--small u-textColorNormal u-marginBottom7">Related reads</div><div class="ui-h3 ui-clamp2 u-textColorDarkest u-contentSansBold u-fontSize24 u-maxHeight2LineHeightTighter u-lineClamp2 u-textOverflowEllipsis u-letterSpacingTight u-paddingBottom2">Beautify your Golang project</div></a><div class="u-paddingBottom10 u-flex0 u-flexCenter"><div class="u-flex1 u-minWidth0 u-marginRight10"><div class="u-flexCenter"><div class="postMetaInline-avatar u-flex0"><a class="link u-baseColor--link avatar" href="https://itnext.io/@shaonshaonty" data-action="show-user-card" data-action-value="d93c2760c09a" data-action-type="hover" data-user-id="d93c2760c09a" data-collection-slug="itnext" dir="auto"><img src="./How we use gRPC to build a client_server system in Go_files/1_mUlrGbBwNRHwDpWcb-iXMA.jpeg" class="avatar-image u-size36x36 u-xs-size32x32" alt="Go to the profile of Shaon Shaonty"></a></div><div class="postMetaInline postMetaInline-authorLockup ui-captionStrong u-flex1 u-noWrapWithEllipsis"><a class="ds-link ds-link--styleSubtle link link--darken link--darker" href="https://itnext.io/@shaonshaonty?source=placement_card_footer_grid---------2-60" data-action="show-user-card" data-action-source="placement_card_footer_grid---------2-60" data-action-value="d93c2760c09a" data-action-type="hover" data-user-id="d93c2760c09a" data-collection-slug="itnext" dir="auto">Shaon Shaonty</a><div class="ui-caption u-fontSize12 u-baseColor--textNormal u-textColorNormal js-postMetaInlineSupplemental"><a class="link link--darken" href="https://itnext.io/beautify-your-golang-project-f795b4b453aa?source=placement_card_footer_grid---------2-60" data-action="open-post" data-action-value="https://itnext.io/beautify-your-golang-project-f795b4b453aa?source=placement_card_footer_grid---------2-60" data-action-source="preview-listing"><time datetime="2018-07-31T07:42:28.274Z">Jul 31, 2018</time></a><span class="middotDivider u-fontSize12"></span><span class="readingTime" title="4 min read"></span></div></div></div></div><div class="u-flex0 u-flexCenter"><div class="buttonSet"><div class="multirecommend js-actionMultirecommend u-flexCenter" data-post-id="f795b4b453aa" data-is-label-padded="true" data-source="placement_card_footer_grid-----f795b4b453aa----2-60----------------clap_preview"><div class="u-relative u-foreground"><button class="button button--primary button--chromeless u-accentColor--buttonNormal button--withIcon button--withSvgIcon clapButton js-actionMultirecommendButton clapButton--darker" data-action="multivote" data-action-value="f795b4b453aa" data-action-type="long-press" data-action-source="placement_card_footer_grid-----f795b4b453aa----2-60----------------clap_preview" aria-label="Clap"><span class="button-defaultState"><span class="svgIcon svgIcon--clap svgIcon--25px"><svg class="svgIcon-use" width="25" height="25"><g fill-rule="evenodd"><path d="M11.739 0l.761 2.966L13.261 0z"></path><path d="M14.815 3.776l1.84-2.551-1.43-.471z"></path><path d="M8.378 1.224l1.84 2.551L9.81.753z"></path><path d="M20.382 21.622c-1.04 1.04-2.115 1.507-3.166 1.608.168-.14.332-.29.492-.45 2.885-2.886 3.456-5.982 1.69-9.211l-1.101-1.937-.955-2.02c-.315-.676-.235-1.185.245-1.556a.836.836 0 0 1 .66-.16c.342.056.66.28.879.605l2.856 5.023c1.179 1.962 1.379 5.119-1.6 8.098m-13.29-.528l-5.02-5.02a1 1 0 0 1 .707-1.701c.255 0 .512.098.707.292l2.607 2.607a.442.442 0 0 0 .624-.624L4.11 14.04l-1.75-1.75a.998.998 0 1 1 1.41-1.413l4.154 4.156a.44.44 0 0 0 .624 0 .44.44 0 0 0 0-.624l-4.152-4.153-1.172-1.171a.998.998 0 0 1 0-1.41 1.018 1.018 0 0 1 1.41 0l1.172 1.17 4.153 4.152a.437.437 0 0 0 .624 0 .442.442 0 0 0 0-.624L6.43 8.222a.988.988 0 0 1-.291-.705.99.99 0 0 1 .29-.706 1 1 0 0 1 1.412 0l6.992 6.993a.443.443 0 0 0 .71-.501l-1.35-2.856c-.315-.676-.235-1.185.246-1.557a.85.85 0 0 1 .66-.16c.342.056.659.28.879.606L18.628 14c1.573 2.876 1.067 5.545-1.544 8.156-1.396 1.397-3.144 1.966-5.063 1.652-1.713-.286-3.463-1.248-4.928-2.714zM10.99 5.976l2.562 2.562c-.497.607-.563 1.414-.155 2.284l.265.562-4.257-4.257a.98.98 0 0 1-.117-.445c0-.267.104-.517.292-.706a1.023 1.023 0 0 1 1.41 0zm8.887 2.06c-.375-.557-.902-.916-1.486-1.011a1.738 1.738 0 0 0-1.342.332c-.376.29-.61.656-.712 1.065a2.1 2.1 0 0 0-1.095-.562 1.776 1.776 0 0 0-.992.128l-2.636-2.636a1.883 1.883 0 0 0-2.658 0 1.862 1.862 0 0 0-.478.847 1.886 1.886 0 0 0-2.671-.012 1.867 1.867 0 0 0-.503.909c-.754-.754-1.992-.754-2.703-.044a1.881 1.881 0 0 0 0 2.658c-.288.12-.605.288-.864.547a1.884 1.884 0 0 0 0 2.659l.624.622a1.879 1.879 0 0 0-.91 3.16l5.019 5.02c1.595 1.594 3.515 2.645 5.408 2.959a7.16 7.16 0 0 0 1.173.098c1.026 0 1.997-.24 2.892-.7.279.04.555.065.828.065 1.53 0 2.969-.628 4.236-1.894 3.338-3.338 3.083-6.928 1.738-9.166l-2.868-5.043z"></path></g></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--clapFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25"><g fill-rule="evenodd"><path d="M11.738 0l.762 2.966L13.262 0z"></path><path d="M16.634 1.224l-1.432-.47-.408 3.022z"></path><path d="M9.79.754l-1.431.47 1.84 2.552z"></path><path d="M22.472 13.307l-3.023-5.32c-.287-.426-.689-.705-1.123-.776a1.16 1.16 0 0 0-.911.221c-.297.231-.474.515-.535.84.017.022.036.04.053.063l2.843 5.001c1.95 3.564 1.328 6.973-1.843 10.144a8.46 8.46 0 0 1-.549.501c1.205-.156 2.328-.737 3.351-1.76 3.268-3.268 3.041-6.749 1.737-8.914"></path><path d="M12.58 9.887c-.156-.83.096-1.569.692-2.142L10.78 5.252c-.5-.504-1.378-.504-1.879 0-.178.18-.273.4-.329.63l4.008 4.005z"></path><path d="M15.812 9.04c-.218-.323-.539-.55-.88-.606a.814.814 0 0 0-.644.153c-.176.137-.713.553-.24 1.566l1.43 3.025a.539.539 0 1 1-.868.612L7.2 6.378a.986.986 0 1 0-1.395 1.395l4.401 4.403a.538.538 0 1 1-.762.762L5.046 8.54 3.802 7.295a.99.99 0 0 0-1.396 0 .981.981 0 0 0 0 1.394L3.647 9.93l4.402 4.403a.537.537 0 0 1 0 .761.535.535 0 0 1-.762 0L2.89 10.696a.992.992 0 0 0-1.399-.003.983.983 0 0 0 0 1.395l1.855 1.854 2.763 2.765a.538.538 0 0 1-.76.761l-2.765-2.764a.982.982 0 0 0-1.395 0 .989.989 0 0 0 0 1.395l5.32 5.32c3.371 3.372 6.64 4.977 10.49 1.126C19.74 19.8 20.271 17 18.62 13.982L15.812 9.04z"></path></g></svg></span></span></button></div><span class="u-relative u-background js-actionMultirecommendCount u-marginLeft5"><button class="button button--chromeless u-baseColor--buttonNormal js-multirecommendCountButton u-disablePointerEvents u-marginLeft4" data-action="show-recommends" data-action-value="f795b4b453aa">1.5K</button></span></div></div><div class="u-height20 u-borderRightLighter u-inlineBlock u-relative u-marginRight10 u-marginLeft12"></div><div class="buttonSet"><button class="button button--chromeless is-touchIconFadeInPulse u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton" title="Bookmark this story to read later" aria-label="Bookmark this story to read later" data-action="add-to-bookmarks" data-action-value="f795b4b453aa" data-action-source="placement_card_footer_grid-----f795b4b453aa----2-60----------------bookmark_preview"><span class="button-defaultState"><span class="svgIcon svgIcon--bookmark svgIcon--25px"><svg class="svgIcon-use" width="25" height="25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126a.508.508 0 0 0 .708-.03.5.5 0 0 0 .118-.285H19V6zm-6.838 9.97L7 19.636V6c0-.55.45-1 1-1h9c.55 0 1 .45 1 1v13.637l-5.162-3.668a.49.49 0 0 0-.676 0z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--bookmarkFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126c.205.183.52.17.708-.03a.5.5 0 0 0 .118-.285H19V6z"></path></svg></span></span></button></div></div></div></div></div></div></div></div></div></div><div class="u-padding0 u-clearfix u-backgroundGrayLightest u-print-hide supplementalPostContent js-responsesWrapper" data-action-scope="_actionscope_5"><div class="container u-maxWidth740"><div class="responsesStreamWrapper u-maxWidth640 js-responsesStreamWrapper"><div class="container responsesStream-title u-paddingTop15"><div class="row"><header class="heading"><div class="u-clearfix"><div class="heading-content u-floatLeft"><span class="heading-title heading-title--semibold">Responses</span></div></div></header></div></div><div class="responsesStream-editor cardChromeless u-marginBottom20 u-paddingLeft20 u-paddingRight20 js-responsesStreamEditor"><div class="inlineNewPostControl js-inlineNewPostControl" data-action-scope="_actionscope_6"><div class="inlineEditor is-collapsed is-postEditMode js-inlineEditor" data-action="focus-editor"><div class="u-paddingTop20 js-block js-inlineEditorContent"><div class="inlineEditor-header"><div class="inlineEditor-avatar u-paddingRight20"><div class="avatar u-inline"><img src="./How we use gRPC to build a client_server system in Go_files/0_mvxMeosUAuHk7G38(1).jpg" class="avatar-image u-size36x36 u-xs-size32x32" alt="Canhui WANG"></div></div><div class="inlineEditor-headerContent"><div class="inlineEditor-placeholder js-inlineEditorPrompt">Write a response…</div><div class="inlineEditor-author u-accentColor--textNormal">Canhui WANG</div></div></div></div></div></div></div><div class="responsesStream js-responsesStream"></div><div class="container js-showOtherResponses"><div class="row"><button class="button button--primary button--withChrome u-accentColor--buttonNormal responsesStream-showOtherResponses cardChromeless u-width100pct u-marginVertical20 u-heightAuto" data-action="show-other-responses">Show all responses</button></div></div><div class="responsesStream js-responsesStreamOther"></div></div></div></div><div class="supplementalPostContent js-heroPromo"></div></footer></article></main><aside class="u-marginAuto u-maxWidth1032 js-postLeftSidebar"><div class="u-foreground u-top0 u-sm-hide js-postShareWidget u-fixed u-transition--fadeOut300" data-scroll="fixed" style="transform: translateY(150px);"><div class="u-breakWord u-md-hide u-width131"><div class="u-width131 collection-title u-fontWeightBold u-fontSize18 u-lineHeightTight"><a href="https://medium.com/pantomath?source=logo-95d118929b4b">Pantomath</a></div><div class="u-width131 u-multiline-clamp u-textColorNormal u-fontSize14 u-lineHeightTight u-paddingTop3">Pantomath is a cutting edge monitoring solution</div><div class="u-paddingTop15 u-paddingBottom30 u-borderBottomLight u-marginBottom30"><button class="button button--primary button--small u-noUserSelect button--withChrome u-accentColor--buttonNormal js-relationshipButton" data-action="toggle-follow-collection" data-action-source="post_sidebar----cf62d19c744----------------------post_sidebar" data-collection-id="cf62d19c744"><span class="button-label  js-buttonLabel">Follow</span></button></div></div><ul><li class="u-marginVertical10"><div class="multirecommend js-actionMultirecommend u-flexCenter" data-post-id="dd20045fa1c2" data-is-icon-29px="true" data-has-recommend-list="true" data-source="post_share_widget-----dd20045fa1c2---------------------clap_sidebar"><div class="u-relative u-foreground"><button class="button button--primary button--large button--chromeless u-accentColor--buttonNormal button--withIcon button--withSvgIcon clapButton js-actionMultirecommendButton clapButton--darker" data-action="multivote" data-action-value="dd20045fa1c2" data-action-type="long-press" data-action-source="post_share_widget-----dd20045fa1c2---------------------clap_sidebar" aria-label="Clap"><span class="button-defaultState"><span class="svgIcon svgIcon--clap svgIcon--29px"><svg class="svgIcon-use" width="29" height="29"><g fill-rule="evenodd"><path d="M13.739 1l.761 2.966L15.261 1z"></path><path d="M16.815 4.776l1.84-2.551-1.43-.471z"></path><path d="M10.378 2.224l1.84 2.551-.408-3.022z"></path><path d="M22.382 22.622c-1.04 1.04-2.115 1.507-3.166 1.608.168-.14.332-.29.492-.45 2.885-2.886 3.456-5.982 1.69-9.211l-1.101-1.937-.955-2.02c-.315-.676-.235-1.185.245-1.556a.836.836 0 0 1 .66-.16c.342.056.66.28.879.605l2.856 5.023c1.179 1.962 1.379 5.119-1.6 8.098m-13.29-.528l-5.02-5.02a1 1 0 0 1 .707-1.701c.255 0 .512.098.707.292l2.607 2.607a.442.442 0 0 0 .624-.624L6.11 15.04l-1.75-1.75a.998.998 0 1 1 1.41-1.413l4.154 4.156a.44.44 0 0 0 .624 0 .44.44 0 0 0 0-.624l-4.152-4.153-1.172-1.171a.998.998 0 0 1 0-1.41 1.018 1.018 0 0 1 1.41 0l1.172 1.17 4.153 4.152a.437.437 0 0 0 .624 0 .442.442 0 0 0 0-.624L8.43 9.222a.988.988 0 0 1-.291-.705.99.99 0 0 1 .29-.706 1 1 0 0 1 1.412 0l6.992 6.993a.443.443 0 0 0 .71-.501l-1.35-2.856c-.315-.676-.235-1.185.246-1.557a.85.85 0 0 1 .66-.16c.342.056.659.28.879.606L20.628 15c1.573 2.876 1.067 5.545-1.544 8.156-1.396 1.397-3.144 1.966-5.063 1.652-1.713-.286-3.463-1.248-4.928-2.714zM12.99 6.976l2.562 2.562c-.497.607-.563 1.414-.155 2.284l.265.562-4.257-4.257a.98.98 0 0 1-.117-.445c0-.267.104-.517.292-.706a1.023 1.023 0 0 1 1.41 0zm8.887 2.06c-.375-.557-.902-.916-1.486-1.011a1.738 1.738 0 0 0-1.342.332c-.376.29-.61.656-.712 1.065a2.1 2.1 0 0 0-1.095-.562 1.776 1.776 0 0 0-.992.128l-2.636-2.636a1.883 1.883 0 0 0-2.658 0 1.862 1.862 0 0 0-.478.847 1.886 1.886 0 0 0-2.671-.012 1.867 1.867 0 0 0-.503.909c-.754-.754-1.992-.754-2.703-.044a1.881 1.881 0 0 0 0 2.658c-.288.12-.605.288-.864.547a1.884 1.884 0 0 0 0 2.659l.624.622a1.879 1.879 0 0 0-.91 3.16l5.019 5.02c1.595 1.594 3.515 2.645 5.408 2.959a7.16 7.16 0 0 0 1.173.098c1.026 0 1.997-.24 2.892-.7.279.04.555.065.828.065 1.53 0 2.969-.628 4.236-1.894 3.338-3.338 3.083-6.928 1.738-9.166l-2.868-5.043z"></path></g></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--clapFilled svgIcon--29px"><svg class="svgIcon-use" width="29" height="29"><g fill-rule="evenodd"><path d="M13.738 1l.762 2.966L15.262 1z"></path><path d="M18.634 2.224l-1.432-.47-.408 3.022z"></path><path d="M11.79 1.754l-1.431.47 1.84 2.552z"></path><path d="M24.472 14.307l-3.023-5.32c-.287-.426-.689-.705-1.123-.776a1.16 1.16 0 0 0-.911.221c-.297.231-.474.515-.535.84.017.022.036.04.053.063l2.843 5.001c1.95 3.564 1.328 6.973-1.843 10.144a8.46 8.46 0 0 1-.549.501c1.205-.156 2.328-.737 3.351-1.76 3.268-3.268 3.041-6.749 1.737-8.914"></path><path d="M14.58 10.887c-.156-.83.096-1.569.692-2.142L12.78 6.252c-.5-.504-1.378-.504-1.879 0-.178.18-.273.4-.329.63l4.008 4.005z"></path><path d="M17.812 10.04c-.218-.323-.539-.55-.88-.606a.814.814 0 0 0-.644.153c-.176.137-.713.553-.24 1.566l1.43 3.025a.539.539 0 1 1-.868.612L9.2 7.378a.986.986 0 1 0-1.395 1.395l4.401 4.403a.538.538 0 1 1-.762.762L7.046 9.54 5.802 8.295a.99.99 0 0 0-1.396 0 .981.981 0 0 0 0 1.394l1.241 1.241 4.402 4.403a.537.537 0 0 1 0 .761.535.535 0 0 1-.762 0L4.89 11.696a.992.992 0 0 0-1.399-.003.983.983 0 0 0 0 1.395l1.855 1.854 2.763 2.765a.538.538 0 0 1-.76.761l-2.765-2.764a.982.982 0 0 0-1.395 0 .989.989 0 0 0 0 1.395l5.32 5.32c3.371 3.372 6.64 4.977 10.49 1.126C21.74 20.8 22.271 18 20.62 14.982l-2.809-4.942z"></path></g></svg></span></span></button></div><span class="u-relative u-background js-actionMultirecommendCount u-marginLeft5"><button class="button button--chromeless u-baseColor--buttonNormal js-multirecommendCountButton" data-action="show-recommends" data-action-value="dd20045fa1c2">2K</button></span></div></li><li class="u-marginVertical10 u-marginLeft3"><button class="button button--large button--dark button--chromeless is-touchIconFadeInPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton" title="Bookmark this story to read later" aria-label="Bookmark this story to read later" data-action="add-to-bookmarks" data-action-value="dd20045fa1c2" data-action-source="post_share_widget-----dd20045fa1c2---------------------bookmark_sidebar"><span class="button-defaultState"><span class="svgIcon svgIcon--bookmark svgIcon--29px"><svg class="svgIcon-use" width="29" height="29"><path d="M19.385 4h-9.77A2.623 2.623 0 0 0 7 6.615V23.01a1.022 1.022 0 0 0 1.595.847l5.905-4.004 5.905 4.004A1.022 1.022 0 0 0 22 23.011V6.62A2.625 2.625 0 0 0 19.385 4zM21 23l-5.91-3.955-.148-.107a.751.751 0 0 0-.884 0l-.147.107L8 23V6.615C8 5.725 8.725 5 9.615 5h9.77C20.275 5 21 5.725 21 6.615V23z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--bookmarkFilled svgIcon--29px"><svg class="svgIcon-use" width="29" height="29"><path d="M19.385 4h-9.77A2.623 2.623 0 0 0 7 6.615V23.01a1.022 1.022 0 0 0 1.595.847l5.905-4.004 5.905 4.004A1.022 1.022 0 0 0 22 23.011V6.62A2.625 2.625 0 0 0 19.385 4z" fill-rule="evenodd"></path></svg></span></span></button></li><li class="u-marginVertical10 u-marginLeft3"><a class="button button--dark button--chromeless u-baseColor--buttonDark button--withIcon button--withSvgIcon button--dark button--chromeless" href="https://medium.com/p/dd20045fa1c2/share/twitter" title="Share on Twitter" aria-label="Share on Twitter" target="_blank" data-action-source="post_share_widget"><span class="button-defaultState"><span class="svgIcon svgIcon--twitterFilled svgIcon--29px"><svg class="svgIcon-use" width="29" height="29"><path d="M22.053 7.54a4.474 4.474 0 0 0-3.31-1.455 4.526 4.526 0 0 0-4.526 4.524c0 .35.04.7.082 1.05a12.9 12.9 0 0 1-9.3-4.77c-.39.69-.61 1.46-.65 2.26.03 1.6.83 2.99 2.02 3.79-.72-.02-1.41-.22-2.02-.57-.01.02-.01.04 0 .08-.01 2.17 1.55 4 3.63 4.44-.39.08-.79.13-1.21.16-.28-.03-.57-.05-.81-.08.54 1.77 2.21 3.08 4.2 3.15a9.564 9.564 0 0 1-5.66 1.94c-.34-.03-.7-.06-1.05-.08 2 1.27 4.38 2.02 6.94 2.02 8.31 0 12.86-6.9 12.84-12.85.02-.24.01-.43 0-.65.89-.62 1.65-1.42 2.26-2.34-.82.38-1.69.62-2.59.72a4.37 4.37 0 0 0 1.94-2.51c-.84.53-1.81.9-2.83 1.13z"></path></svg></span></span></a></li><li class="u-marginVertical10 u-marginLeft3"><a class="button button--dark button--chromeless u-baseColor--buttonDark button--withIcon button--withSvgIcon button--dark button--chromeless" href="https://medium.com/p/dd20045fa1c2/share/facebook" title="Share on Facebook" aria-label="Share on Facebook" target="_blank" data-action-source="post_share_widget"><span class="button-defaultState"><span class="svgIcon svgIcon--facebookSquare svgIcon--29px"><svg class="svgIcon-use" width="29" height="29"><path d="M23.209 5H5.792A.792.792 0 0 0 5 5.791V23.21c0 .437.354.791.792.791h9.303v-7.125H12.72v-2.968h2.375v-2.375c0-2.455 1.553-3.662 3.741-3.662 1.049 0 1.95.078 2.213.112v2.565h-1.517c-1.192 0-1.469.567-1.469 1.397v1.963h2.969l-.594 2.968h-2.375L18.11 24h5.099a.791.791 0 0 0 .791-.791V5.79a.791.791 0 0 0-.791-.79"></path></svg></span></span></a></li></ul></div></aside><style class="js-collectionStyle">
.u-accentColor--borderLight {border-color: #0090E4 !important;}
.u-accentColor--borderNormal {border-color: #0090E4 !important;}
.u-accentColor--borderDark {border-color: #087BBD !important;}
.u-accentColor--iconLight .svgIcon,.u-accentColor--iconLight.svgIcon {fill: #0090E4 !important;}
.u-accentColor--iconNormal .svgIcon,.u-accentColor--iconNormal.svgIcon {fill: #0090E4 !important;}
.u-accentColor--iconDark .svgIcon,.u-accentColor--iconDark.svgIcon {fill: #087BBD !important;}
.u-accentColor--textNormal {color: #087BBD !important;}
.u-accentColor--hoverTextNormal:hover {color: #087BBD !important;}
.u-accentColor--textNormal.u-accentColor--textDarken:hover {color: #1771AA !important;}
.u-accentColor--textDark {color: #1771AA !important;}
.u-accentColor--backgroundLight {background-color: #0090E4 !important;}
.u-accentColor--backgroundNormal {background-color: #0090E4 !important;}
.u-accentColor--backgroundDark {background-color: #087BBD !important;}
.u-accentColor--buttonDark {border-color: #087BBD !important; color: #1771AA !important;}
.u-accentColor--buttonDark:hover {border-color: #1771AA !important;}
.u-accentColor--buttonDark .icon:before,.u-accentColor--buttonDark .svgIcon{color: #087BBD !important; fill: #087BBD !important;}
.u-accentColor--buttonNormal:not(.clapButton--largePill) {border-color: #0090E4 !important; color: #087BBD !important;}
.u-accentColor--buttonNormal:hover {border-color: #087BBD !important;}
.u-accentColor--buttonNormal .icon:before,.u-accentColor--buttonNormal .svgIcon{color: #0090E4 !important; fill: #0090E4 !important;}
.u-accentColor--buttonNormal.button--filled .icon:before,.u-accentColor--buttonNormal.button--filled .svgIcon{color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-accentColor--buttonDark.button--filled,.u-accentColor--buttonDark.button--withChrome.is-active,.u-accentColor--fillWhenActive.is-active {background-color: #087BBD !important; border-color: #087BBD !important; color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-accentColor--buttonNormal.button--filled:not(.clapButton--largePill),.u-accentColor--buttonNormal.button--withChrome.is-active:not(.clapButton--largePill) {background-color: #0090E4 !important; border-color: #0090E4 !important; color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.postArticle.is-withAccentColors .markup--user,.postArticle.is-withAccentColors .markup--query {color: #087BBD !important;}.u-tintBgColor {background-color: rgba(36, 170, 255, 1) !important;}.u-tintBgColor .u-fadeLeft:before {background-image: linear-gradient(to right, rgba(36, 170, 255, 1) 0%, rgba(36, 170, 255, 0) 100%) !important;}.u-tintBgColor .u-fadeRight:after {background-image: linear-gradient(to right, rgba(36, 170, 255, 0) 0%, rgba(36, 170, 255, 1) 100%) !important;}
.u-tintSpectrum .u-baseColor--borderLight {border-color: #A1D9FF !important;}
.u-tintSpectrum .u-baseColor--borderNormal {border-color: #C3EAFF !important;}
.u-tintSpectrum .u-baseColor--borderDark {border-color: #E2FAFF !important;}
.u-tintSpectrum .u-baseColor--iconLight .svgIcon,.u-tintSpectrum .u-baseColor--iconLight.svgIcon {fill: #A1D9FF !important;}
.u-tintSpectrum .u-baseColor--iconNormal .svgIcon,.u-tintSpectrum .u-baseColor--iconNormal.svgIcon {fill: #C3EAFF !important;}
.u-tintSpectrum .u-baseColor--iconDark .svgIcon,.u-tintSpectrum .u-baseColor--iconDark.svgIcon {fill: #E2FAFF !important;}
.u-tintSpectrum .u-baseColor--textNormal {color: #C3EAFF !important;}
.u-tintSpectrum .u-baseColor--textNormal.u-baseColor--textDarken:hover {color: #F1FFFF !important;}
.u-tintSpectrum .u-baseColor--textDark {color: #F1FFFF !important;}
.u-tintSpectrum .u-baseColor--textDarker {color: #F1FFFF !important;}
.u-tintSpectrum .u-baseColor--backgroundLight {background-color: #A1D9FF !important;}
.u-tintSpectrum .u-baseColor--backgroundNormal {background-color: #C3EAFF !important;}
.u-tintSpectrum .u-baseColor--backgroundDark {background-color: #E2FAFF !important;}
.u-tintSpectrum .u-baseColor--buttonLight {border-color: #A1D9FF !important; color: #A1D9FF !important;}
.u-tintSpectrum .u-baseColor--buttonLight:hover {border-color: #A1D9FF !important;}
.u-tintSpectrum .u-baseColor--buttonLight .icon:before,.u-tintSpectrum .u-baseColor--buttonLight .svgIcon {color: #A1D9FF !important; fill: #A1D9FF !important;}
.u-tintSpectrum .u-baseColor--buttonDark {border-color: #E2FAFF !important; color: #F1FFFF !important;}
.u-tintSpectrum .u-baseColor--buttonDark:hover {border-color: #F1FFFF !important;}
.u-tintSpectrum .u-baseColor--buttonDark .icon:before,.u-tintSpectrum .u-baseColor--buttonDark .svgIcon {color: #E2FAFF !important; fill: #E2FAFF !important;}
.u-tintSpectrum .u-baseColor--buttonNormal {border-color: #C3EAFF !important; color: #C3EAFF !important;}
.u-tintSpectrum .u-baseColor--buttonNormal:hover {border-color: #E2FAFF !important;}
.u-tintSpectrum .u-baseColor--buttonNormal .icon:before,.u-tintSpectrum .u-baseColor--buttonNormal .svgIcon {color: #C3EAFF !important; fill: #C3EAFF !important;}
.u-tintSpectrum .u-baseColor--buttonDark.button--filled,.u-tintSpectrum .u-baseColor--buttonDark.button--withChrome.is-active {background-color: #E2FAFF !important; border-color: #E2FAFF !important; color: rgba(36, 170, 255, 1) !important; fill: rgba(36, 170, 255, 1) !important;}
.u-tintSpectrum .u-baseColor--buttonNormal.button--filled,.u-tintSpectrum .u-baseColor--buttonNormal.button--withChrome.is-active {background-color: #C3EAFF !important; border-color: #C3EAFF !important; color: rgba(36, 170, 255, 1) !important; fill: rgba(36, 170, 255, 1) !important;}
.u-tintSpectrum .u-baseColor--link {color: #C3EAFF !important;}
.u-tintSpectrum .u-baseColor--link.link--darkenOnHover:hover {color: #F1FFFF !important;}
.u-tintSpectrum .u-baseColor--link.link--darken:hover,.u-tintSpectrum .u-baseColor--link.link--darken:focus,.u-tintSpectrum .u-baseColor--link.link--darken:active {color: #F1FFFF !important;}
.u-tintSpectrum .u-baseColor--link.link--dark {color: #F1FFFF !important;}
.u-tintSpectrum .u-baseColor--link.link--dark.link--darken:hover,.u-tintSpectrum .u-baseColor--link.link--dark.link--darken:focus,.u-tintSpectrum .u-baseColor--link.link--dark.link--darken:active {color: #F1FFFF !important;}
.u-tintSpectrum .u-baseColor--link.link--darker {color: #F1FFFF !important;}
.u-tintSpectrum .u-baseColor--placeholderNormal ::-webkit-input-placeholder {color: #A1D9FF;}
.u-tintSpectrum .u-baseColor--placeholderNormal ::-moz-placeholder {color: #A1D9FF;}
.u-tintSpectrum .u-baseColor--placeholderNormal :-ms-input-placeholder {color: #A1D9FF;}
.u-tintSpectrum .svgIcon--logoWordmark {stroke: none !important; fill: #F1FFFF !important;}
.u-tintSpectrum .svgIcon--logoMonogram {stroke: none !important; fill: #F1FFFF !important;}
.u-tintSpectrum  .ui-h1,.u-tintSpectrum  .ui-h2,.u-tintSpectrum  .ui-h3,.u-tintSpectrum  .ui-h4,.u-tintSpectrum  .ui-brand1,.u-tintSpectrum  .ui-brand2,.u-tintSpectrum  .ui-captionStrong {color: #F1FFFF !important; fill: #F1FFFF !important;}
.u-tintSpectrum  .ui-body,.u-tintSpectrum  .ui-caps {color: #F1FFFF !important; fill: #F1FFFF !important;}
.u-tintSpectrum  .ui-summary,.u-tintSpectrum  .ui-caption {color: #A1D9FF !important; fill: #A1D9FF !important;}
.u-tintSpectrum .u-accentColor--borderLight {border-color: #A1D9FF !important;}
.u-tintSpectrum .u-accentColor--borderNormal {border-color: #C3EAFF !important;}
.u-tintSpectrum .u-accentColor--borderDark {border-color: #E2FAFF !important;}
.u-tintSpectrum .u-accentColor--iconLight .svgIcon,.u-tintSpectrum .u-accentColor--iconLight.svgIcon {fill: #A1D9FF !important;}
.u-tintSpectrum .u-accentColor--iconNormal .svgIcon,.u-tintSpectrum .u-accentColor--iconNormal.svgIcon {fill: #C3EAFF !important;}
.u-tintSpectrum .u-accentColor--iconDark .svgIcon,.u-tintSpectrum .u-accentColor--iconDark.svgIcon {fill: #E2FAFF !important;}
.u-tintSpectrum .u-accentColor--textNormal {color: #C3EAFF !important;}
.u-tintSpectrum .u-accentColor--hoverTextNormal:hover {color: #C3EAFF !important;}
.u-tintSpectrum .u-accentColor--textNormal.u-accentColor--textDarken:hover {color: #F1FFFF !important;}
.u-tintSpectrum .u-accentColor--textDark {color: #F1FFFF !important;}
.u-tintSpectrum .u-accentColor--backgroundLight {background-color: #A1D9FF !important;}
.u-tintSpectrum .u-accentColor--backgroundNormal {background-color: #C3EAFF !important;}
.u-tintSpectrum .u-accentColor--backgroundDark {background-color: #E2FAFF !important;}
.u-tintSpectrum .u-accentColor--buttonDark {border-color: #E2FAFF !important; color: #F1FFFF !important;}
.u-tintSpectrum .u-accentColor--buttonDark:hover {border-color: #F1FFFF !important;}
.u-tintSpectrum .u-accentColor--buttonDark .icon:before,.u-tintSpectrum .u-accentColor--buttonDark .svgIcon{color: #E2FAFF !important; fill: #E2FAFF !important;}
.u-tintSpectrum .u-accentColor--buttonNormal:not(.clapButton--largePill) {border-color: #C3EAFF !important; color: #C3EAFF !important;}
.u-tintSpectrum .u-accentColor--buttonNormal:hover {border-color: #E2FAFF !important;}
.u-tintSpectrum .u-accentColor--buttonNormal .icon:before,.u-tintSpectrum .u-accentColor--buttonNormal .svgIcon{color: #C3EAFF !important; fill: #C3EAFF !important;}
.u-tintSpectrum .u-accentColor--buttonNormal.button--filled .icon:before,.u-tintSpectrum .u-accentColor--buttonNormal.button--filled .svgIcon{color: rgba(36, 170, 255, 1) !important; fill: rgba(36, 170, 255, 1) !important;}
.u-tintSpectrum .u-accentColor--buttonDark.button--filled,.u-tintSpectrum .u-accentColor--buttonDark.button--withChrome.is-active,.u-tintSpectrum .u-accentColor--fillWhenActive.is-active {background-color: #E2FAFF !important; border-color: #E2FAFF !important; color: rgba(36, 170, 255, 1) !important; fill: rgba(36, 170, 255, 1) !important;}
.u-tintSpectrum .u-accentColor--buttonNormal.button--filled:not(.clapButton--largePill),.u-tintSpectrum .u-accentColor--buttonNormal.button--withChrome.is-active:not(.clapButton--largePill) {background-color: #C3EAFF !important; border-color: #C3EAFF !important; color: rgba(36, 170, 255, 1) !important; fill: rgba(36, 170, 255, 1) !important;}
.u-tintSpectrum .postArticle.is-withAccentColors .markup--user,.u-tintSpectrum .postArticle.is-withAccentColors .markup--query {color: #C3EAFF !important;}
.u-accentColor--highlightFaint {background-color: rgba(219, 245, 255, 1) !important;}
.u-accentColor--highlightStrong.is-active .svgIcon {fill: rgba(155, 235, 255, 1) !important;}
.postArticle.is-withAccentColors .markup--quote.is-other {background-color: rgba(219, 245, 255, 1) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .markup--quote.is-other {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(219, 245, 255, 1), rgba(219, 245, 255, 1));}
.postArticle.is-withAccentColors .markup--quote.is-me {background-color: rgba(187, 240, 255, 1) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .markup--quote.is-me {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(187, 240, 255, 1), rgba(187, 240, 255, 1));}
.postArticle.is-withAccentColors .markup--quote.is-targeted {background-color: rgba(155, 235, 255, 1) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .markup--quote.is-targeted {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(155, 235, 255, 1), rgba(155, 235, 255, 1));}
.postArticle.is-withAccentColors .markup--quote.is-selected {background-color: rgba(155, 235, 255, 1) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .markup--quote.is-selected {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(155, 235, 255, 1), rgba(155, 235, 255, 1));}
.postArticle.is-withAccentColors .markup--highlight {background-color: rgba(155, 235, 255, 1) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .markup--highlight {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(155, 235, 255, 1), rgba(155, 235, 255, 1));}.u-baseColor--iconNormal.avatar-halo {fill: rgba(0, 0, 0, 0.4980392156862745) !important;}</style><style class="js-collectionStyleConstant">.u-imageBgColor {background-color: rgba(0, 0, 0, 0.24705882352941178);}
.u-imageSpectrum .u-baseColor--borderLight {border-color: rgba(255, 255, 255, 0.6980392156862745) !important;}
.u-imageSpectrum .u-baseColor--borderNormal {border-color: rgba(255, 255, 255, 0.8980392156862745) !important;}
.u-imageSpectrum .u-baseColor--borderDark {border-color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-baseColor--iconLight .svgIcon,.u-imageSpectrum .u-baseColor--iconLight.svgIcon {fill: rgba(255, 255, 255, 0.8) !important;}
.u-imageSpectrum .u-baseColor--iconNormal .svgIcon,.u-imageSpectrum .u-baseColor--iconNormal.svgIcon {fill: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-baseColor--iconDark .svgIcon,.u-imageSpectrum .u-baseColor--iconDark.svgIcon {fill: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--textNormal {color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-baseColor--textNormal.u-baseColor--textDarken:hover {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--textDark {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--textDarker {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--backgroundLight {background-color: rgba(255, 255, 255, 0.8980392156862745) !important;}
.u-imageSpectrum .u-baseColor--backgroundNormal {background-color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-baseColor--backgroundDark {background-color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--buttonLight {border-color: rgba(255, 255, 255, 0.6980392156862745) !important; color: rgba(255, 255, 255, 0.8) !important;}
.u-imageSpectrum .u-baseColor--buttonLight:hover {border-color: rgba(255, 255, 255, 0.6980392156862745) !important;}
.u-imageSpectrum .u-baseColor--buttonLight .icon:before,.u-imageSpectrum .u-baseColor--buttonLight .svgIcon {color: rgba(255, 255, 255, 0.8) !important; fill: rgba(255, 255, 255, 0.8) !important;}
.u-imageSpectrum .u-baseColor--buttonDark {border-color: rgba(255, 255, 255, 0.9490196078431372) !important; color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--buttonDark:hover {border-color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--buttonDark .icon:before,.u-imageSpectrum .u-baseColor--buttonDark .svgIcon {color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--buttonNormal {border-color: rgba(255, 255, 255, 0.8980392156862745) !important; color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-baseColor--buttonNormal:hover {border-color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-baseColor--buttonNormal .icon:before,.u-imageSpectrum .u-baseColor--buttonNormal .svgIcon {color: rgba(255, 255, 255, 0.9490196078431372) !important; fill: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-baseColor--buttonDark.button--filled,.u-imageSpectrum .u-baseColor--buttonDark.button--withChrome.is-active {background-color: rgba(255, 255, 255, 1) !important; border-color: rgba(255, 255, 255, 1) !important; color: rgba(0, 0, 0, 0.24705882352941178) !important; fill: rgba(0, 0, 0, 0.24705882352941178) !important;}
.u-imageSpectrum .u-baseColor--buttonNormal.button--filled,.u-imageSpectrum .u-baseColor--buttonNormal.button--withChrome.is-active {background-color: rgba(255, 255, 255, 0.9490196078431372) !important; border-color: rgba(255, 255, 255, 0.9490196078431372) !important; color: rgba(0, 0, 0, 0.24705882352941178) !important; fill: rgba(0, 0, 0, 0.24705882352941178) !important;}
.u-imageSpectrum .u-baseColor--link {color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-baseColor--link.link--darkenOnHover:hover {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--link.link--darken:hover,.u-imageSpectrum .u-baseColor--link.link--darken:focus,.u-imageSpectrum .u-baseColor--link.link--darken:active {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--link.link--dark {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--link.link--dark.link--darken:hover,.u-imageSpectrum .u-baseColor--link.link--dark.link--darken:focus,.u-imageSpectrum .u-baseColor--link.link--dark.link--darken:active {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--link.link--darker {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--placeholderNormal ::-webkit-input-placeholder {color: rgba(255, 255, 255, 0.8);}
.u-imageSpectrum .u-baseColor--placeholderNormal ::-moz-placeholder {color: rgba(255, 255, 255, 0.8);}
.u-imageSpectrum .u-baseColor--placeholderNormal :-ms-input-placeholder {color: rgba(255, 255, 255, 0.8);}
.u-imageSpectrum .svgIcon--logoWordmark {stroke: none !important; fill: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .svgIcon--logoMonogram {stroke: none !important; fill: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum  .ui-h1,.u-imageSpectrum  .ui-h2,.u-imageSpectrum  .ui-h3,.u-imageSpectrum  .ui-h4,.u-imageSpectrum  .ui-brand1,.u-imageSpectrum  .ui-brand2,.u-imageSpectrum  .ui-captionStrong {color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum  .ui-body,.u-imageSpectrum  .ui-caps {color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum  .ui-summary,.u-imageSpectrum  .ui-caption {color: rgba(255, 255, 255, 0.8) !important; fill: rgba(255, 255, 255, 0.8) !important;}
.u-imageSpectrum .u-accentColor--borderLight {border-color: rgba(255, 255, 255, 0.6980392156862745) !important;}
.u-imageSpectrum .u-accentColor--borderNormal {border-color: rgba(255, 255, 255, 0.8980392156862745) !important;}
.u-imageSpectrum .u-accentColor--borderDark {border-color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--iconLight .svgIcon,.u-imageSpectrum .u-accentColor--iconLight.svgIcon {fill: rgba(255, 255, 255, 0.8) !important;}
.u-imageSpectrum .u-accentColor--iconNormal .svgIcon,.u-imageSpectrum .u-accentColor--iconNormal.svgIcon {fill: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--iconDark .svgIcon,.u-imageSpectrum .u-accentColor--iconDark.svgIcon {fill: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-accentColor--textNormal {color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--hoverTextNormal:hover {color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--textNormal.u-accentColor--textDarken:hover {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-accentColor--textDark {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-accentColor--backgroundLight {background-color: rgba(255, 255, 255, 0.8980392156862745) !important;}
.u-imageSpectrum .u-accentColor--backgroundNormal {background-color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--backgroundDark {background-color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-accentColor--buttonDark {border-color: rgba(255, 255, 255, 0.9490196078431372) !important; color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-accentColor--buttonDark:hover {border-color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-accentColor--buttonDark .icon:before,.u-imageSpectrum .u-accentColor--buttonDark .svgIcon{color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-accentColor--buttonNormal:not(.clapButton--largePill) {border-color: rgba(255, 255, 255, 0.8980392156862745) !important; color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--buttonNormal:hover {border-color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--buttonNormal .icon:before,.u-imageSpectrum .u-accentColor--buttonNormal .svgIcon{color: rgba(255, 255, 255, 0.9490196078431372) !important; fill: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--buttonNormal.button--filled .icon:before,.u-imageSpectrum .u-accentColor--buttonNormal.button--filled .svgIcon{color: rgba(0, 0, 0, 0.24705882352941178) !important; fill: rgba(0, 0, 0, 0.24705882352941178) !important;}
.u-imageSpectrum .u-accentColor--buttonDark.button--filled,.u-imageSpectrum .u-accentColor--buttonDark.button--withChrome.is-active,.u-imageSpectrum .u-accentColor--fillWhenActive.is-active {background-color: rgba(255, 255, 255, 1) !important; border-color: rgba(255, 255, 255, 1) !important; color: rgba(0, 0, 0, 0.24705882352941178) !important; fill: rgba(0, 0, 0, 0.24705882352941178) !important;}
.u-imageSpectrum .u-accentColor--buttonNormal.button--filled:not(.clapButton--largePill),.u-imageSpectrum .u-accentColor--buttonNormal.button--withChrome.is-active:not(.clapButton--largePill) {background-color: rgba(255, 255, 255, 0.9490196078431372) !important; border-color: rgba(255, 255, 255, 0.9490196078431372) !important; color: rgba(0, 0, 0, 0.24705882352941178) !important; fill: rgba(0, 0, 0, 0.24705882352941178) !important;}
.u-imageSpectrum .postArticle.is-withAccentColors .markup--user,.u-imageSpectrum .postArticle.is-withAccentColors .markup--query {color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--highlightFaint {background-color: rgba(255, 255, 255, 0.2) !important;}
.u-imageSpectrum .u-accentColor--highlightStrong.is-active .svgIcon {fill: rgba(255, 255, 255, 0.6) !important;}
.postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-other {background-color: rgba(255, 255, 255, 0.2) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-other {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(255, 255, 255, 0.2), rgba(255, 255, 255, 0.2));}
.postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-me {background-color: rgba(255, 255, 255, 0.4) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-me {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(255, 255, 255, 0.4), rgba(255, 255, 255, 0.4));}
.postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-targeted {background-color: rgba(255, 255, 255, 0.6) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-targeted {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(255, 255, 255, 0.6), rgba(255, 255, 255, 0.6));}
.postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-selected {background-color: rgba(255, 255, 255, 0.6) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-selected {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(255, 255, 255, 0.6), rgba(255, 255, 255, 0.6));}
.postArticle.is-withAccentColors .u-imageSpectrum .markup--highlight {background-color: rgba(255, 255, 255, 0.6) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .u-imageSpectrum .markup--highlight {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(255, 255, 255, 0.6), rgba(255, 255, 255, 0.6));}.u-resetSpectrum .u-tintBgColor {background-color: rgba(255, 255, 255, 1) !important;}.u-resetSpectrum .u-tintBgColor .u-fadeLeft:before {background-image: linear-gradient(to right, rgba(255, 255, 255, 1) 0%, rgba(255, 255, 255, 0) 100%) !important;}.u-resetSpectrum .u-tintBgColor .u-fadeRight:after {background-image: linear-gradient(to right, rgba(255, 255, 255, 0) 0%, rgba(255, 255, 255, 1) 100%) !important;}
.u-resetSpectrum .u-baseColor--borderLight {border-color: rgba(0, 0, 0, 0.2980392156862745) !important;}
.u-resetSpectrum .u-baseColor--borderNormal {border-color: rgba(0, 0, 0, 0.4980392156862745) !important;}
.u-resetSpectrum .u-baseColor--borderDark {border-color: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--iconLight .svgIcon,.u-resetSpectrum .u-baseColor--iconLight.svgIcon {fill: rgba(0, 0, 0, 0.2980392156862745) !important;}
.u-resetSpectrum .u-baseColor--iconNormal .svgIcon,.u-resetSpectrum .u-baseColor--iconNormal.svgIcon {fill: rgba(0, 0, 0, 0.4980392156862745) !important;}
.u-resetSpectrum .u-baseColor--iconDark .svgIcon,.u-resetSpectrum .u-baseColor--iconDark.svgIcon {fill: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--textNormal {color: rgba(0, 0, 0, 0.4980392156862745) !important;}
.u-resetSpectrum .u-baseColor--textNormal.u-baseColor--textDarken:hover {color: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--textDark {color: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--textDarker {color: rgba(0, 0, 0, 0.8) !important;}
.u-resetSpectrum .u-baseColor--backgroundLight {background-color: rgba(0, 0, 0, 0.09803921568627451) !important;}
.u-resetSpectrum .u-baseColor--backgroundNormal {background-color: rgba(0, 0, 0, 0.2) !important;}
.u-resetSpectrum .u-baseColor--backgroundDark {background-color: rgba(0, 0, 0, 0.2980392156862745) !important;}
.u-resetSpectrum .u-baseColor--buttonLight {border-color: rgba(0, 0, 0, 0.2980392156862745) !important; color: rgba(0, 0, 0, 0.2980392156862745) !important;}
.u-resetSpectrum .u-baseColor--buttonLight:hover {border-color: rgba(0, 0, 0, 0.2980392156862745) !important;}
.u-resetSpectrum .u-baseColor--buttonLight .icon:before,.u-resetSpectrum .u-baseColor--buttonLight .svgIcon {color: rgba(0, 0, 0, 0.2980392156862745) !important; fill: rgba(0, 0, 0, 0.2980392156862745) !important;}
.u-resetSpectrum .u-baseColor--buttonDark {border-color: rgba(0, 0, 0, 0.6) !important; color: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--buttonDark:hover {border-color: rgba(0, 0, 0, 0.8) !important;}
.u-resetSpectrum .u-baseColor--buttonDark .icon:before,.u-resetSpectrum .u-baseColor--buttonDark .svgIcon {color: rgba(0, 0, 0, 0.6) !important; fill: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--buttonNormal {border-color: rgba(0, 0, 0, 0.4980392156862745) !important; color: rgba(0, 0, 0, 0.4980392156862745) !important;}
.u-resetSpectrum .u-baseColor--buttonNormal:hover {border-color: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--buttonNormal .icon:before,.u-resetSpectrum .u-baseColor--buttonNormal .svgIcon {color: rgba(0, 0, 0, 0.4980392156862745) !important; fill: rgba(0, 0, 0, 0.4980392156862745) !important;}
.u-resetSpectrum .u-baseColor--buttonDark.button--filled,.u-resetSpectrum .u-baseColor--buttonDark.button--withChrome.is-active {background-color: rgba(0, 0, 0, 0.2980392156862745) !important; border-color: rgba(0, 0, 0, 0.2980392156862745) !important; color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-resetSpectrum .u-baseColor--buttonNormal.button--filled,.u-resetSpectrum .u-baseColor--buttonNormal.button--withChrome.is-active {background-color: rgba(0, 0, 0, 0.2) !important; border-color: rgba(0, 0, 0, 0.2) !important; color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-resetSpectrum .u-baseColor--link {color: rgba(0, 0, 0, 0.4980392156862745) !important;}
.u-resetSpectrum .u-baseColor--link.link--darkenOnHover:hover {color: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--link.link--darken:hover,.u-resetSpectrum .u-baseColor--link.link--darken:focus,.u-resetSpectrum .u-baseColor--link.link--darken:active {color: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--link.link--dark {color: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--link.link--dark.link--darken:hover,.u-resetSpectrum .u-baseColor--link.link--dark.link--darken:focus,.u-resetSpectrum .u-baseColor--link.link--dark.link--darken:active {color: rgba(0, 0, 0, 0.8) !important;}
.u-resetSpectrum .u-baseColor--link.link--darker {color: rgba(0, 0, 0, 0.8) !important;}
.u-resetSpectrum .u-baseColor--placeholderNormal ::-webkit-input-placeholder {color: rgba(0, 0, 0, 0.2980392156862745);}
.u-resetSpectrum .u-baseColor--placeholderNormal ::-moz-placeholder {color: rgba(0, 0, 0, 0.2980392156862745);}
.u-resetSpectrum .u-baseColor--placeholderNormal :-ms-input-placeholder {color: rgba(0, 0, 0, 0.2980392156862745);}
.u-resetSpectrum .svgIcon--logoWordmark {stroke: none !important; fill: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .svgIcon--logoMonogram {stroke: none !important; fill: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum  .ui-h1,.u-resetSpectrum  .ui-h2,.u-resetSpectrum  .ui-h3,.u-resetSpectrum  .ui-h4,.u-resetSpectrum  .ui-brand1,.u-resetSpectrum  .ui-brand2,.u-resetSpectrum  .ui-captionStrong {color: rgba(0, 0, 0, 0.8) !important; fill: rgba(0, 0, 0, 0.8) !important;}
.u-resetSpectrum  .ui-body,.u-resetSpectrum  .ui-caps {color: rgba(0, 0, 0, 0.6) !important; fill: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum  .ui-summary,.u-resetSpectrum  .ui-caption {color: rgba(0, 0, 0, 0.2980392156862745) !important; fill: rgba(0, 0, 0, 0.2980392156862745) !important;}
.u-resetSpectrum .u-accentColor--borderLight {border-color: rgba(2, 184, 117, 1) !important;}
.u-resetSpectrum .u-accentColor--borderNormal {border-color: rgba(2, 184, 117, 1) !important;}
.u-resetSpectrum .u-accentColor--borderDark {border-color: rgba(0, 171, 107, 1) !important;}
.u-resetSpectrum .u-accentColor--iconLight .svgIcon,.u-resetSpectrum .u-accentColor--iconLight.svgIcon {fill: rgba(2, 184, 117, 1) !important;}
.u-resetSpectrum .u-accentColor--iconNormal .svgIcon,.u-resetSpectrum .u-accentColor--iconNormal.svgIcon {fill: rgba(0, 171, 107, 1) !important;}
.u-resetSpectrum .u-accentColor--iconDark .svgIcon,.u-resetSpectrum .u-accentColor--iconDark.svgIcon {fill: rgba(28, 153, 99, 1) !important;}
.u-resetSpectrum .u-accentColor--textNormal {color: rgba(0, 171, 107, 1) !important;}
.u-resetSpectrum .u-accentColor--hoverTextNormal:hover {color: rgba(0, 171, 107, 1) !important;}
.u-resetSpectrum .u-accentColor--textNormal.u-accentColor--textDarken:hover {color: rgba(28, 153, 99, 1) !important;}
.u-resetSpectrum .u-accentColor--textDark {color: rgba(28, 153, 99, 1) !important;}
.u-resetSpectrum .u-accentColor--backgroundLight {background-color: rgba(2, 184, 117, 1) !important;}
.u-resetSpectrum .u-accentColor--backgroundNormal {background-color: rgba(0, 171, 107, 1) !important;}
.u-resetSpectrum .u-accentColor--backgroundDark {background-color: rgba(28, 153, 99, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonDark {border-color: rgba(0, 171, 107, 1) !important; color: rgba(28, 153, 99, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonDark:hover {border-color: rgba(28, 153, 99, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonDark .icon:before,.u-resetSpectrum .u-accentColor--buttonDark .svgIcon{color: rgba(28, 153, 99, 1) !important; fill: rgba(28, 153, 99, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonNormal:not(.clapButton--largePill) {border-color: rgba(2, 184, 117, 1) !important; color: rgba(0, 171, 107, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonNormal:hover {border-color: rgba(0, 171, 107, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonNormal .icon:before,.u-resetSpectrum .u-accentColor--buttonNormal .svgIcon{color: rgba(0, 171, 107, 1) !important; fill: rgba(0, 171, 107, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonNormal.button--filled .icon:before,.u-resetSpectrum .u-accentColor--buttonNormal.button--filled .svgIcon{color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonDark.button--filled,.u-resetSpectrum .u-accentColor--buttonDark.button--withChrome.is-active,.u-resetSpectrum .u-accentColor--fillWhenActive.is-active {background-color: rgba(28, 153, 99, 1) !important; border-color: rgba(28, 153, 99, 1) !important; color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonNormal.button--filled:not(.clapButton--largePill),.u-resetSpectrum .u-accentColor--buttonNormal.button--withChrome.is-active:not(.clapButton--largePill) {background-color: rgba(0, 171, 107, 1) !important; border-color: rgba(0, 171, 107, 1) !important; color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-resetSpectrum .postArticle.is-withAccentColors .markup--user,.u-resetSpectrum .postArticle.is-withAccentColors .markup--query {color: rgba(0, 171, 107, 1) !important;}</style><div class="highlightMenu" data-action-scope="_actionscope_3" style="left: 543px; top: 19549px;"><div class="highlightMenu-inner"><div class="buttonSet"><button class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--highlightMenu u-accentColor--highlightStrong js-highlightMenuQuoteButton" data-action="quote" data-action-source="quote_menu--------------------------highlight_text" data-skip-onboarding="true"><span class="svgIcon svgIcon--highlighter svgIcon--25px"><svg class="svgIcon-use" width="25" height="25"><path d="M13.7 15.964l5.204-9.387-4.726-2.62-5.204 9.387 4.726 2.62zm-.493.885l-1.313 2.37-1.252.54-.702 1.263-3.796-.865 1.228-2.213-.202-1.35 1.314-2.37 4.722 2.616z" fill-rule="evenodd"></path></svg></span></button><button class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--highlightMenu" data-action="quote-respond" data-action-source="quote_menu--------------------------respond_text" data-skip-onboarding="true"><span class="svgIcon svgIcon--responseFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25"><path d="M19.074 21.117c-1.244 0-2.432-.37-3.532-1.096a7.792 7.792 0 0 1-.703-.52c-.77.21-1.57.32-2.38.32-4.67 0-8.46-3.5-8.46-7.8C4 7.7 7.79 4.2 12.46 4.2c4.662 0 8.457 3.5 8.457 7.803 0 2.058-.85 3.984-2.403 5.448.023.17.06.35.118.55.192.69.537 1.38 1.026 2.04.15.21.172.48.058.7a.686.686 0 0 1-.613.38h-.03z" fill-rule="evenodd"></path></svg></span></button><a class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--chromeless button--highlightMenu js-highlightMenuTwitterShare" href="https://medium.com/p/dd20045fa1c2/share/twitter?type=highlight&amp;text=t%20is%20up%20to%20push%20extra%20data%20during%20its%20calls%20to%20the%20server%2C%20but%20the%20server%20does%20not%20care%2C%20right%20now.%20So%20you%20need%20to%20tell%20him%20to%20check%20these%20metadata.%20Open%20server%2Fmain.go%20and%20upda" title="Share on Twitter" aria-label="Share on Twitter" target="_blank" data-action="twitter"><span class="button-defaultState"><span class="svgIcon svgIcon--twitterFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25"><path d="M21.725 5.338c-.744.47-1.605.804-2.513 1.006a3.978 3.978 0 0 0-2.942-1.293c-2.22 0-4.02 1.81-4.02 4.02 0 .32.034.63.07.94-3.31-.18-6.27-1.78-8.255-4.23a4.544 4.544 0 0 0-.574 2.01c.04 1.43.74 2.66 1.8 3.38-.63-.01-1.25-.19-1.79-.5v.08c0 1.93 1.38 3.56 3.23 3.95-.34.07-.7.12-1.07.14-.25-.02-.5-.04-.72-.07.49 1.58 1.97 2.74 3.74 2.8a8.49 8.49 0 0 1-5.02 1.72c-.3-.03-.62-.04-.93-.07A11.447 11.447 0 0 0 8.88 21c7.386 0 11.43-6.13 11.414-11.414.015-.21.01-.38 0-.578a7.604 7.604 0 0 0 2.01-2.08 7.27 7.27 0 0 1-2.297.645 3.856 3.856 0 0 0 1.72-2.23"></path></svg></span></span></a><div class="buttonSet-separator"></div><button class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--highlightMenu" data-action="highlight" data-action-source="quote_menu--------------------------privatenote_text" data-skip-onboarding="true"><span class="svgIcon svgIcon--privatenoteFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25"><g fill-rule="evenodd"><path d="M17.662 4.552H7.346A4.36 4.36 0 0 0 3 8.898v5.685c0 2.168 1.614 3.962 3.697 4.28v2.77c0 .303.35.476.59.29l3.904-2.994h6.48c2.39 0 4.35-1.96 4.35-4.35V8.9c0-2.39-1.95-4.346-4.34-4.346zM16 14.31a.99.99 0 0 1-1.003.99h-4.994C9.45 15.3 9 14.85 9 14.31v-3.02a.99.99 0 0 1 1-.99v-.782a2.5 2.5 0 0 1 2.5-2.51c1.38 0 2.5 1.13 2.5 2.51v.782c.552.002 1 .452 1 .99v3.02z"></path><path d="M14 9.81c0-.832-.674-1.68-1.5-1.68-.833 0-1.5.84-1.5 1.68v.49h3v-.49z"></path></g></svg></span></button></div></div><div class="highlightMenu-arrowClip"><span class="highlightMenu-arrow"></span></div></div></div></div></div><div class="loadingBar"></div><script>// <![CDATA[
window["obvInit"] = function (opt_embedded) {window["obvInit"]["embedded"] = opt_embedded; window["obvInit"]["ready"] = true;}
// ]]></script><script>// <![CDATA[
var GLOBALS = {"audioUrl":"https://d1fcbxp97j4nb2.cloudfront.net","baseUrl":"https://medium.com","buildLabel":"38071-4c0614a","currentUser":{"userId":"95d118929b4b","username":"17481074","name":"Canhui WANG","email":"17481074@life.hkbu.edu.hk","imageId":"0*mvxMeosUAuHk7G38.jpg","createdAt":1555939235370,"lastPostCreatedAt":1556250435695,"isVerified":true,"subscriberEmail":"","onboardingStatus":2,"googleAccountId":"113739671887416995933","googleEmail":"17481074@life.hkbu.edu.hk","hasPastMemberships":false,"isEnrolledInHightower":false,"isEligibleForHightower":true,"hightowerLastLockedAt":0,"isWriterProgramEnrolled":true,"isWriterProgramInvited":true,"isWriterProgramOptedOut":false,"writerProgramVersion":5,"writerProgramEnrolledAt":1555939235370,"friendLinkOnboarding":0,"hasAdditionalUnlocks":false,"hasApiAccess":false,"isQuarantined":false,"writerProgramDistributionSettingOptedIn":true},"currentUserHasUnverifiedEmail":false,"isAuthenticated":true,"isCurrentUserVerified":true,"language":"zh-cn","miroUrl":"https://cdn-images-1.medium.com","moduleUrls":{"base":"https://cdn-static-1.medium.com/_/fp/gen-js/main-base.bundle.HGBQCOSshRHDcI3r4pjKpQ.js","common-async":"https://cdn-static-1.medium.com/_/fp/gen-js/main-common-async.bundle.6Y8HS1nZY2Zfeh0AFBQAyQ.js","hightower":"https://cdn-static-1.medium.com/_/fp/gen-js/main-hightower.bundle.6FOGY6ouqNMySk5yHMmW3A.js","home-screens":"https://cdn-static-1.medium.com/_/fp/gen-js/main-home-screens.bundle.d2Ua48DeSXmhnx6BikN_Iw.js","misc-screens":"https://cdn-static-1.medium.com/_/fp/gen-js/main-misc-screens.bundle.2g8uOjftS-52-MwU6gG3Fw.js","notes":"https://cdn-static-1.medium.com/_/fp/gen-js/main-notes.bundle.b0dpuNbavMdh8ZXWT4j2Aw.js","payments":"https://cdn-static-1.medium.com/_/fp/gen-js/main-payments.bundle.cg-IrTO8WysnMg0c__FJHA.js","posters":"https://cdn-static-1.medium.com/_/fp/gen-js/main-posters.bundle.b2XUkpbaZgVu0fuO48AaIw.js","power-readers":"https://cdn-static-1.medium.com/_/fp/gen-js/main-power-readers.bundle.wvhZeq_iZ2e-AecOAxjiBg.js","pubs":"https://cdn-static-1.medium.com/_/fp/gen-js/main-pubs.bundle.qf6Gl40snMZcEXwnIYeTVw.js","stats":"https://cdn-static-1.medium.com/_/fp/gen-js/main-stats.bundle.FlbCJW8r3qPxa-G9kjPBKw.js"},"previewConfig":{"weightThreshold":1,"weightImageParagraph":0.51,"weightIframeParagraph":0.8,"weightTextParagraph":0.08,"weightEmptyParagraph":0,"weightP":0.003,"weightH":0.005,"weightBq":0.003,"minPTextLength":60,"truncateBoundaryChars":20,"detectTitle":true,"detectTitleLevThreshold":0.15},"productName":"Medium","supportsEdit":true,"termsUrl":"//medium.com/policy/9db0094a1e0f","textshotHost":"textshot.medium.com","transactionId":"1562849858964:89ba0dc2c13c","useragent":{"browser":"chrome","family":"chrome","os":"windows","version":75,"supportsDesktopEdit":true,"supportsInteract":true,"supportsView":true,"isMobile":false,"isTablet":false,"isNative":false,"supportsFileAPI":true,"isTier1":true,"clientVersion":"","unknownParagraphsBad":false,"clientChannel":"","supportsRealScrollEvents":true,"supportsVhUnits":true,"ruinsViewportSections":false,"supportsHtml5Video":true,"supportsMagicUnderlines":true,"isWebView":false,"isFacebookWebView":false,"supportsProgressiveMedia":true,"supportsPromotedPosts":true,"isBot":false,"isNativeIphone":false,"supportsCssVariables":true,"supportsVideoSections":true,"emojiSupportLevel":1,"isSearchBot":false,"isSyndicationBot":false,"isNativeAndroid":false,"isNativeIos":false,"isSeoBot":false,"supportsScrollableMetabar":true},"variants":{"allow_access":true,"allow_signup":true,"allow_test_auth":"disallow","signin_services":"twitter,facebook,google,email,google-fastidv,google-one-tap","signup_services":"twitter,facebook,google,email,google-fastidv,google-one-tap","google_sign_in_android":true,"reengagement_notification_duration":3,"browsable_stream_config_bucket":"curated-topics","enable_dedicated_series_tab_api_ios":true,"enable_post_import":true,"available_monthly_plan":"60e220181034","available_annual_plan":"2c754bcc2995","disable_ios_resume_reading_toast":true,"is_not_medium_subscriber":true,"glyph_font_set":"m2","enable_branding":true,"enable_branding_fonts":true,"max_premium_content_per_user_under_metering":3,"enable_automated_mission_control_triggers":true,"enable_lite_profile":true,"enable_marketing_emails":true,"enable_topic_lifecycle_email":true,"enable_parsely":true,"enable_branch_io":true,"enable_ios_post_stats":true,"enable_lite_topics":true,"enable_lite_stories":true,"redis_read_write_splitting":true,"enable_tipalti_onboarding":true,"enable_international_tax_withholding":true,"enable_international_tax_withholding_documentation":true,"enable_revised_first_partner_program_distro_on_email":true,"enable_annual_renewal_reminder_email":true,"enable_janky_spam_rules":"users,posts","enable_new_collaborative_filtering_data":true,"android_rating_prompt_stories_read_threshold":2,"enable_google_one_tap":true,"enable_email_sign_in_captcha":true,"enable_primary_topic_for_mobile":true,"enable_logged_out_homepage_signup":true,"use_new_admin_topic_backend":true,"enable_quarantine_rules":true,"enable_patronus_on_kubernetes":true,"enable_digest_thirty":true,"pub_sidebar":true,"disable_mobile_featured_chunk":true,"enable_embedding_based_diversification":true,"enable_pub_newsletters":true,"enable_lite_pub_header_menu":true,"enable_lite_claps":true,"enable_lite_post_manager_gear_menu":true,"enable_live_user_post_scoring":true,"enable_lite_post_highlights":true,"enable_lite_post_highlights_view_only":true,"enable_tick_landing_page":true,"enable_lite_private_notes":true,"enable_lite_private_notes_li_100":true,"enable_trumpland_landing_page":true,"enable_lite_email_sign_in_flow":true,"enable_lite_paywall_alert":true,"enable_edit_alt_text":true,"enable_serve_recs_from_ml_rank_homepage":true,"enable_serve_recs_from_ml_rank_digest":true,"enable_serve_recs_from_ml_rank_app_highlights":true,"enable_lite_thanks_to":true,"enable_lite_google_captcha":true,"enable_lite_branch_io":true,"enable_lite_notifications":true,"enable_july_meter_email_test":true,"enable_lite_verify_email_butter_bar":true,"enable_lite_unread_notification_count":true},"xsrfToken":"3EWmSGFYYWIm","iosAppId":"828256236","supportEmail":"yourfriends@medium.com","fp":{"/icons/monogram-mask.svg":"https://cdn-static-1.medium.com/_/fp/icons/monogram-mask.KPLCSFEZviQN0jQ7veN2RQ.svg","/icons/favicon-dev-editor.ico":"https://cdn-static-1.medium.com/_/fp/icons/favicon-dev-editor.YKKRxBO8EMvIqhyCwIiJeQ.ico","/icons/favicon-hatch-editor.ico":"https://cdn-static-1.medium.com/_/fp/icons/favicon-hatch-editor.BuEyHIqlyh2s_XEk4Rl32Q.ico","/icons/favicon-medium-editor.ico":"https://cdn-static-1.medium.com/_/fp/icons/favicon-medium-editor.PiakrZWB7Yb80quUVQWM6g.ico"},"authBaseUrl":"https://medium.com","imageUploadSizeMb":25,"isAuthDomainRequest":true,"algoliaApiEndpoint":"https://MQ57UUUQZ2-dsn.algolia.net","algoliaAppId":"MQ57UUUQZ2","algoliaSearchOnlyApiKey":"394474ced050e3911ae2249ecc774921","iosAppStoreUrl":"https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8","iosAppLinkBaseUrl":"medium:","algoliaIndexPrefix":"medium_","androidPlayStoreUrl":"https://play.google.com/store/apps/details?id=com.medium.reader","googleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","androidPackage":"com.medium.reader","androidPlayStoreMarketScheme":"market://details?id=com.medium.reader","googleAuthUri":"https://accounts.google.com/o/oauth2/auth","androidScheme":"medium","layoutData":{"useDynamicScripts":false,"googleAnalyticsTrackingCode":"UA-24232453-2","jsShivUrl":"https://cdn-static-1.medium.com/_/fp/js/shiv.RI2ePTZ5gFmMgLzG5bEVAA.js","useDynamicCss":false,"faviconUrl":"https://cdn-static-1.medium.com/_/fp/icons/favicon-rebrand-medium.3Y6xpZ-0FSdWDnPM3hSBIA.ico","faviconImageId":"1*8I-HPL0bfoIzGied-dzOvA.png","fontSets":[{"id":8,"url":"https://glyph.medium.com/css/e/sr/latin/e/ssr/latin/e/ssb/latin/m2.css"},{"id":11,"url":"https://glyph.medium.com/css/m2.css"},{"id":9,"url":"https://glyph.medium.com/css/mkt.css"}],"editorFaviconUrl":"https://cdn-static-1.medium.com/_/fp/icons/favicon-rebrand-medium-editor.3Y6xpZ-0FSdWDnPM3hSBIA.ico","glyphUrl":"https://glyph.medium.com"},"authBaseUrlRev":"moc.muidem//:sptth","isDnt":false,"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","archiveUploadSizeMb":100,"paymentData":{"currencies":{"1":{"label":"US Dollar","external":"usd"}},"countries":{"1":{"label":"United States of America","external":"US"}},"accountTypes":{"1":{"label":"Individual","external":"individual"},"2":{"label":"Company","external":"company"}}},"previewConfig2":{"weightThreshold":1,"weightImageParagraph":0.05,"raiseImage":true,"enforceHeaderHierarchy":true,"isImageInsetRight":true},"isAmp":false,"iosScheme":"medium","isSwBoot":false,"lightstep":{"accessToken":"ce5be895bef60919541332990ac9fef2","carrier":"{\"ot-tracer-spanid\":\"4642873f430287a5\",\"ot-tracer-traceid\":\"0892ee744e206ac4\",\"ot-tracer-sampled\":\"true\"}","host":"collector-medium.lightstep.com"},"facebook":{"key":"542599432471018","namespace":"medium-com","scope":{"default":["public_profile","email"],"connect":["public_profile","email"],"login":["public_profile","email"],"share":["public_profile","email"]}},"editorsPicksTopicId":"3985d2a191c5","popularOnMediumTopicId":"9d34e48ecf94","memberContentTopicId":"13d7efd82fb2","audioContentTopicId":"3792abbd134","brandedSequenceId":"7d337ddf1941","isDoNotAuth":false,"buggle":{"url":"https://buggle.medium.com","videoUrl":"https://cdn-videos-1.medium.com","audioUrl":"https://cdn-audio-1.medium.com"},"referrerType":5,"isMeteredOut":true,"meterConfig":{"maxUnlockCount":3,"windowLength":"MONTHLY"},"partnerProgramEmail":"partnerprogram@medium.com","userResearchPrompts":[{"promptId":"li_post_page","type":0,"url":"www.calendly.com"},{"promptId":"li_home_page","type":1,"url":"mediumuserfeedback.typeform.com/to/GcFjEO"},{"promptId":"li_profile_page","type":2,"url":"www.calendly.com"}],"recaptchaKey":"6LdAokEUAAAAAC7seICd4vtC8chDb3jIXDQulyUJ","signinWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"countryCode":"HK","bypassMeter":false,"branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","paypal":{"clientMode":"production","oneYearGift":{"name":"Medium Membership (1 Year, Digital Gift Code)","description":"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com/redeem.","price":"50.00","currency":"USD","sku":"membership-gift-1-yr"}},"collectionConfig":{"mediumOwnedAndOperatedCollectionIds":["544c7006046e","bcc38c8f6edf","444d13b52878","8d6b8a439e32","92d2092dc598","1285ba81cada","cb8577c9149e","8ccfed20cbb2","ae2a65f35510","3f6ecf56618"]}}
// ]]></script><script charset="UTF-8" src="./How we use gRPC to build a client_server system in Go_files/main-base.bundle.HGBQCOSshRHDcI3r4pjKpQ.js.download" async=""></script><script>// <![CDATA[
window["obvInit"]({"value":{"id":"dd20045fa1c2","versionId":"c1fba592b90d","creatorId":"2f5a2cbeb497","creator":{"userId":"2f5a2cbeb497","name":"Julien Andrieux","username":"chilladx","createdAt":1451376456948,"imageId":"1*uZ56OzX2vlJdTqfmMIruUg.jpeg","backgroundImageId":"","bio":"CTO & Entrepreneur, trying-to-be digital nomad, learner","twitterScreenName":"chilladx","socialStats":{"userId":"2f5a2cbeb497","usersFollowedCount":39,"usersFollowedByCount":185,"type":"SocialStats"},"social":{"userId":"95d118929b4b","targetUserId":"2f5a2cbeb497","type":"Social"},"facebookAccountId":"","allowNotes":1,"mediumMemberAt":0,"isNsfw":false,"isWriterProgramEnrolled":true,"isQuarantined":false,"type":"User"},"homeCollection":{"id":"cf62d19c744","name":"Pantomath","slug":"pantomath","tags":["MONITORING","GO","ENGINEERING","STARTUP"],"creatorId":"4ecb125a3651","description":"Pantomath is a cutting edge monitoring solution","shortDescription":"Pantomath is a cutting edge monitoring solution","image":{"imageId":"1*3UOXOjhNOVBhUEeFY6s-aQ.png","filter":"","backgroundSize":"","originalWidth":200,"originalHeight":200,"strategy":"resample","height":0,"width":0},"metadata":{"followerCount":128,"activeAt":1521122462343},"virtuals":{"permissions":{"canPublish":false,"canPublishAll":false,"canRepublish":false,"canRemove":false,"canManageAll":false,"canSubmit":false,"canEditPosts":false,"canAddWriters":false,"canViewStats":false,"canSendNewsletter":false,"canViewLockedPosts":false,"canViewCloaked":false,"canEditOwnPosts":false,"canBeAssignedAuthor":false,"canEnrollInHightower":false,"canLockPostsForMediumMembers":false,"canLockOwnPostsForMediumMembers":false},"isSubscribed":false,"isNewsletterSubscribed":false,"isEnrolledInHightower":false,"isEligibleForHightower":false,"mediumNewsletterId":"","isSubscribedToMediumNewsletter":false},"logo":{"imageId":"1*pDRgSnGnZl4rzF0vBdo1FA.png","filter":"","backgroundSize":"","originalWidth":1535,"originalHeight":600,"strategy":"resample","height":0,"width":0},"twitterUsername":"pantomathIO","publicEmail":"hello@pantomath.io","collectionMastheadId":"4403e3a280d8","sections":[{"type":2,"collectionHeaderMetadata":{"title":"Pantomath","description":"Cutting edge monitoring","backgroundImage":{"id":"1*jT2Y4dK-bpqdPC-ae6s8mw.png","originalWidth":1699,"originalHeight":737},"logoImage":{},"alignment":2,"layout":6}},{"type":1,"postListMetadata":{"source":1,"layout":2,"number":7,"postIds":[]}},{"type":3,"promoMetadata":{"sectionHeader":"","promoId":"24df7b285a38"}}],"tintColor":"#FF24AAFF","lightText":false,"favicon":{"imageId":"","filter":"","backgroundSize":"","originalWidth":0,"originalHeight":0,"strategy":"resample","height":0,"width":0},"colorPalette":{"defaultBackgroundSpectrum":{"colorPoints":[{"color":"#FF0090E4","point":0},{"color":"#FF0086D1","point":0.1},{"color":"#FF087BBD","point":0.2},{"color":"#FF1771AA","point":0.3},{"color":"#FF1D6698","point":0.4},{"color":"#FF205B85","point":0.5},{"color":"#FF204F72","point":0.6},{"color":"#FF1E4360","point":0.7},{"color":"#FF1A374D","point":0.8},{"color":"#FF152A3B","point":0.9},{"color":"#FF0E1C28","point":1}],"backgroundColor":"#FFFFFFFF"},"tintBackgroundSpectrum":{"colorPoints":[{"color":"#FF24AAFF","point":0},{"color":"#FF4BB4FF","point":0.1},{"color":"#FF65BDFF","point":0.2},{"color":"#FF7BC7FF","point":0.3},{"color":"#FF8FD0FF","point":0.4},{"color":"#FFA1D9FF","point":0.5},{"color":"#FFB2E1FF","point":0.6},{"color":"#FFC3EAFF","point":0.7},{"color":"#FFD3F2FF","point":0.8},{"color":"#FFE2FAFF","point":0.9},{"color":"#FFF1FFFF","point":1}],"backgroundColor":"#FF24AAFF"},"highlightSpectrum":{"colorPoints":[{"color":"#FFE1F6FF","point":0},{"color":"#FFDBF5FF","point":0.1},{"color":"#FFD5F4FF","point":0.2},{"color":"#FFCFF3FF","point":0.3},{"color":"#FFC8F2FF","point":0.4},{"color":"#FFC2F1FF","point":0.5},{"color":"#FFBBF0FF","point":0.6},{"color":"#FFB3EFFF","point":0.7},{"color":"#FFACEEFF","point":0.8},{"color":"#FFA4ECFF","point":0.9},{"color":"#FF9BEBFF","point":1}],"backgroundColor":"#FFFFFFFF"}},"navItems":[],"colorBehavior":1,"instantArticlesState":0,"acceleratedMobilePagesState":0,"ampLogo":{"imageId":"","filter":"","backgroundSize":"","originalWidth":0,"originalHeight":0,"strategy":"resample","height":0,"width":0},"header":{"title":"Pantomath","description":"Cutting edge monitoring","backgroundImage":{"id":"1*jT2Y4dK-bpqdPC-ae6s8mw.png","originalWidth":1699,"originalHeight":737},"logoImage":{},"alignment":2,"layout":6},"type":"Collection"},"homeCollectionId":"cf62d19c744","title":"How we use gRPC to build a client/server system in Go","detectedLanguage":"en","latestVersion":"c1fba592b90d","latestPublishedVersion":"c1fba592b90d","hasUnpublishedEdits":false,"latestRev":3485,"createdAt":1507067675027,"updatedAt":1529459110767,"acceptedAt":0,"firstPublishedAt":1507564861651,"latestPublishedAt":1515401993148,"vote":false,"experimentalCss":"","displayAuthor":"","content":{"subtitle":"This post is a technical presentation on how we use gRPC (and Protobuf) to build a robust client/server system.","bodyModel":{"paragraphs":[{"name":"68d3","type":3,"text":"How we use gRPC to build a client/server system in Go","markups":[]},{"name":"2de7","type":4,"text":"Photo by Igor Ovsyannykov on Unsplash","markups":[{"type":3,"start":9,"end":25,"href":"https://unsplash.com/photos/6uWHZ74S5Rk?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText","title":"","rel":"","anchorType":0},{"type":3,"start":29,"end":37,"href":"https://unsplash.com/?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText","title":"","rel":"","anchorType":0}],"layout":3,"metadata":{"id":"1*QIjD685SfIfFV-xXtdIofg.jpeg","originalWidth":5607,"originalHeight":3738}},{"name":"1734","type":1,"text":"This post is a technical presentation on how we use gRPC (and Protobuf) to build a robust client/server system.","markups":[{"type":3,"start":52,"end":56,"href":"https://grpc.io/","title":"","rel":"nofollow","anchorType":0},{"type":3,"start":62,"end":70,"href":"https://developers.google.com/protocol-buffers/","title":"","rel":"nofollow","anchorType":0}]},{"name":"890a","type":1,"text":"I won’t go into the details of why we chose gRPC as the main communication protocol between our client and server, a lot of great posts already cover the subject (like this one, this one or this one). But just to get the big picture: we are building a client-server system, using Go, that needs to be fast, reliable, and that scales (thus we chose gRPC). We wanted the communication between the client and the server to be as small as possible, as secure as possible and fully compliant with both ends (thus we chose Protobuf).","markups":[{"type":3,"start":168,"end":176,"href":"https://grpc.io/blog/vendastagrpc","title":"","rel":"nofollow","anchorType":0},{"type":3,"start":178,"end":186,"href":"https://stackoverflow.com/questions/43682366/how-is-grpc-different-from-rest","title":"","rel":"nofollow","anchorType":0},{"type":3,"start":190,"end":198,"href":"https://thenewstack.io/grpc-lean-mean-communication-protocol-microservices/","title":"","rel":"nofollow","anchorType":0},{"type":3,"start":280,"end":282,"href":"https://golang.org/","title":"","rel":"nofollow","anchorType":0},{"type":3,"start":517,"end":525,"href":"https://developers.google.com/protocol-buffers/","title":"","rel":"","anchorType":0}]},{"name":"e13c","type":1,"text":"We also wanted to expose another interface on the server side, just in case we add a client that has no compatible gRPC implementation: a traditional REST interface. And we wanted that at (almost) no cost.","markups":[]},{"name":"fd49","type":3,"text":"Context","markups":[]},{"name":"db00","type":1,"text":"We will start building a very simple client/server system, in Go, that will just exchange dummy messages. Once both communicate and understand each other, we’ll add extra features, such as TLS support, authentication, and a REST API.","markups":[]},{"name":"fb14","type":1,"text":"The rest of this articles assumes you understand basic Go programming. It also assumes that you have protobuf package installed, and the protoccommand available (once again, many posts cover that topic, and there’s the official documentation).\nYou will also need to install Go dependencies, such as the go implementation for protobuf, and grpc-gateway.","markups":[{"type":10,"start":101,"end":109,"href":"","title":"","rel":"","name":"","anchorType":0,"creatorIds":[],"userId":""},{"type":10,"start":137,"end":143,"href":"","title":"","rel":"","name":"","anchorType":0,"creatorIds":[],"userId":""},{"type":3,"start":219,"end":241,"href":"https://developers.google.com/protocol-buffers/docs/proto3","title":"","rel":"","name":"","anchorType":0,"creatorIds":[],"userId":""},{"type":3,"start":303,"end":333,"href":"http://github.com/golang/protobuf","title":"","rel":"","name":"","anchorType":0,"creatorIds":[],"userId":""},{"type":3,"start":339,"end":351,"href":"https://github.com/grpc-ecosystem/grpc-gateway","title":"","rel":"","name":"","anchorType":0,"creatorIds":[],"userId":""}]},{"name":"809c","type":1,"text":"All the code shown in this post is available at https://gitlab.com/pantomath-io/demo-grpc. So feel free to get the repository, and use the tags to navigate in it. The repository should be placed in the src folder of your $GOPATH:","markups":[{"type":10,"start":202,"end":205,"href":"","title":"","rel":"","name":"","anchorType":0,"creatorIds":[],"userId":""},{"type":10,"start":221,"end":228,"href":"","title":"","rel":"","name":"","anchorType":0,"creatorIds":[],"userId":""},{"type":3,"start":48,"end":89,"href":"https://gitlab.com/pantomath-io/demo-grpc","title":"","rel":"nofollow","name":"","anchorType":0,"creatorIds":[],"userId":""}]},{"name":"957b","type":8,"text":"$ go get -v -d gitlab.com/pantomath-io/demo-grpc\n$ cd $GOPATH/src/gitlab.com/pantomath-io/demo-grpc","markups":[]},{"name":"d85d","type":3,"text":"Defining the protocol","markups":[]},{"name":"dd92","type":1,"text":"git tag: init-protobuf-definition","markups":[{"type":3,"start":9,"end":33,"href":"https://gitlab.com/pantomath-io/demo-grpc/tree/init-protobuf-definiton","title":"","rel":"","anchorType":0},{"type":2,"start":0,"end":33}]},{"name":"c539","type":4,"text":"Photo by Mark Rasmuson on Unsplash","markups":[{"type":3,"start":9,"end":22,"href":"https://unsplash.com/photos/yri82tuk2TQ?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText","title":"","rel":"","anchorType":0},{"type":3,"start":26,"end":34,"href":"https://unsplash.com/?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText","title":"","rel":"","anchorType":0}],"layout":1,"metadata":{"id":"1*N8g6AM5x4n64RCXYUjwtYQ.jpeg","originalWidth":4672,"originalHeight":3104}},{"name":"b3fb","type":1,"text":"First of all, you need to define the protocol, i.e. to define what can be said between client and server, and how. This is where Protobuf comes into play. It allows you to define two things: Services and Messages. A service is a collection of actions the server can perform at the client’s request, a message is the content of this request. To simplify, you can say that service defines actions, while message defines objects.","markups":[{"type":10,"start":216,"end":223},{"type":10,"start":301,"end":308},{"type":10,"start":371,"end":378},{"type":10,"start":402,"end":409},{"type":1,"start":387,"end":395},{"type":1,"start":418,"end":425}]},{"name":"7cb0","type":1,"text":"Write the following in api/api.proto:","markups":[{"type":10,"start":23,"end":36,"href":"","title":"","rel":"","name":"","anchorType":0,"creatorIds":[],"userId":""},{"type":3,"start":23,"end":36,"href":"https://gitlab.com/pantomath-io/demo-grpc/blob/init-protobuf-definition/api/api.proto","title":"","rel":"","name":"","anchorType":0,"creatorIds":[],"userId":""}]},{"name":"46bd","type":8,"text":"syntax = \"proto3\";\npackage api;","markups":[]},{"name":"2b97","type":8,"text":"message PingMessage {\n  string greeting = 1;\n}","markups":[]},{"name":"f6ed","type":8,"text":"service Ping {\n  rpc SayHello(PingMessage) returns (PingMessage) {}\n}","markups":[]},{"name":"8b80","type":1,"text":"So, you defined 2 things: a service called Ping that exposes a function called SayHello with an incoming PingMessage and returns a PingMessage ; and a message called PingMessage that consists in a single field called greeting which is a string.\nYou also specified that you are using the proto3 syntax, as opposed to proto2 (see documentation).","markups":[{"type":10,"start":28,"end":35,"href":"","title":"","rel":"","name":"","anchorType":0,"creatorIds":[],"userId":""},{"type":10,"start":43,"end":47,"href":"","title":"","rel":"","name":"","anchorType":0,"creatorIds":[],"userId":""},{"type":10,"start":79,"end":87,"href":"","title":"","rel":"","name":"","anchorType":0,"creatorIds":[],"userId":""},{"type":10,"start":105,"end":116,"href":"","title":"","rel":"","name":"","anchorType":0,"creatorIds":[],"userId":""},{"type":10,"start":131,"end":142,"href":"","title":"","rel":"","name":"","anchorType":0,"creatorIds":[],"userId":""},{"type":10,"start":151,"end":158,"href":"","title":"","rel":"","name":"","anchorType":0,"creatorIds":[],"userId":""},{"type":10,"start":166,"end":177,"href":"","title":"","rel":"","name":"","anchorType":0,"creatorIds":[],"userId":""},{"type":10,"start":217,"end":225,"href":"","title":"","rel":"","name":"","anchorType":0,"creatorIds":[],"userId":""},{"type":10,"start":237,"end":243,"href":"","title":"","rel":"","name":"","anchorType":0,"creatorIds":[],"userId":""},{"type":10,"start":287,"end":293,"href":"","title":"","rel":"","name":"","anchorType":0,"creatorIds":[],"userId":""},{"type":10,"start":316,"end":323,"href":"","title":"","rel":"","name":"","anchorType":0,"creatorIds":[],"userId":""},{"type":3,"start":328,"end":341,"href":"https://developers.google.com/protocol-buffers/docs/proto3","title":"","rel":"nofollow","name":"","anchorType":0,"creatorIds":[],"userId":""}]},{"name":"36e3","type":1,"text":"This file is not usable like this: it needs to get compiled. Compiling the proto file means generating code for your chosen language, that your application will actually call.\nIn a shell, cd to the root directory of your project, and run the following command:","markups":[{"type":10,"start":188,"end":190}]},{"name":"a2a7","type":8,"text":"$ protoc -I api/ \\\n    -I${GOPATH}/src \\\n    --go_out=plugins=grpc:api \\\n    api/api.proto","markups":[]},{"name":"bf6c","type":1,"text":"This command generates the file api/api.pb.go, a Go source file that implements the gRPC code your application will use. You can look at it, but you shouldn’t change it (as it will be overwritten every time you run protoc).","markups":[{"type":10,"start":32,"end":45},{"type":10,"start":215,"end":221}]},{"name":"80d3","type":1,"text":"You also need to define the function called by the service Ping, so create a file named api/handler.go:","markups":[{"type":10,"start":51,"end":63},{"type":10,"start":88,"end":102}]},{"name":"0f0f","type":8,"text":"package api","markups":[]},{"name":"573e","type":8,"text":"import (\n  \"log\"","markups":[]},{"name":"46f7","type":8,"text":"  \"golang.org/x/net/context\"\n)","markups":[]},{"name":"8ce2","type":8,"text":"// Server represents the gRPC server\ntype Server struct {\n}","markups":[]},{"name":"83c8","type":8,"text":"// SayHello generates response to a Ping request\nfunc (s *Server) SayHello(ctx context.Context, in *PingMessage) (*PingMessage, error) {\n  log.Printf(\"Receive message %s\", in.Greeting)\n  return &PingMessage{Greeting: \"bar\"}, nil\n}","markups":[]},{"name":"6a99","type":9,"text":"the Server struct is just an abstraction of the server. It allows to “attach” some resources to your server, making them available during the RPC calls;","markups":[{"type":10,"start":4,"end":10},{"type":10,"start":11,"end":17}]},{"name":"9ce8","type":9,"text":"the SayHello function is the one defined in the Protobuf file, as the rpc call for the Ping service. If you don’t define it, you won’t be able to create the gRPC server;","markups":[{"type":10,"start":4,"end":12},{"type":10,"start":70,"end":73},{"type":10,"start":87,"end":91},{"type":10,"start":92,"end":99}]},{"name":"215e","type":9,"text":"SayHello takes a PingMessage as parameter, and returns a PingMessage. The PingMessage struct is defined in the api.pb.go file auto-generated from the api.proto definition. The function also has a Context parameter (see further presentation in the official blog post). You’ll see later what use you can do of the Context. On the other side, it also returns an error, in case something bad happens.","markups":[{"type":10,"start":0,"end":8,"href":"","title":"","rel":"","name":"","anchorType":0,"creatorIds":[],"userId":""},{"type":10,"start":17,"end":28,"href":"","title":"","rel":"","name":"","anchorType":0,"creatorIds":[],"userId":""},{"type":10,"start":57,"end":68,"href":"","title":"","rel":"","name":"","anchorType":0,"creatorIds":[],"userId":""},{"type":10,"start":74,"end":85,"href":"","title":"","rel":"","name":"","anchorType":0,"creatorIds":[],"userId":""},{"type":10,"start":86,"end":92,"href":"","title":"","rel":"","name":"","anchorType":0,"creatorIds":[],"userId":""},{"type":10,"start":111,"end":120,"href":"","title":"","rel":"","name":"","anchorType":0,"creatorIds":[],"userId":""},{"type":10,"start":150,"end":159,"href":"","title":"","rel":"","name":"","anchorType":0,"creatorIds":[],"userId":""},{"type":10,"start":196,"end":203,"href":"","title":"","rel":"","name":"","anchorType":0,"creatorIds":[],"userId":""},{"type":10,"start":312,"end":319,"href":"","title":"","rel":"","name":"","anchorType":0,"creatorIds":[],"userId":""},{"type":10,"start":359,"end":364,"href":"","title":"","rel":"","name":"","anchorType":0,"creatorIds":[],"userId":""},{"type":3,"start":256,"end":265,"href":"https://blog.golang.org/context","title":"","rel":"","name":"","anchorType":0,"creatorIds":[],"userId":""}]},{"name":"3995","type":3,"text":"Creating the simplest server","markups":[]},{"name":"3df4","type":1,"text":"git tag: init-server","markups":[{"type":3,"start":9,"end":20,"href":"https://gitlab.com/pantomath-io/demo-grpc/tags/init-server","title":"","rel":"","anchorType":0},{"type":2,"start":0,"end":20}]},{"name":"66f3","type":4,"text":"Photo by Nathan Dumlao on Unsplash","markups":[{"type":3,"start":9,"end":22,"href":"https://unsplash.com/photos/3CS0Ne4wBPw?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText","title":"","rel":"","anchorType":0},{"type":3,"start":26,"end":34,"href":"https://unsplash.com/?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText","title":"","rel":"","anchorType":0}],"layout":1,"metadata":{"id":"1*Gy5Z3hBbB3r1GUkB75D_eg.jpeg","originalWidth":5461,"originalHeight":3641}},{"name":"6b58","type":1,"text":"Now you have a protocol in place, you can create a simple server that implements the service and understands the message. Take your favorite editor and create the file server/main.go:","markups":[{"type":10,"start":85,"end":92},{"type":10,"start":113,"end":120},{"type":10,"start":168,"end":182},{"type":3,"start":168,"end":182,"href":"https://gitlab.com/pantomath-io/demo-grpc/blob/init-server/server/main.go","title":"","rel":"","anchorType":0}]},{"name":"b958","type":8,"text":"package main","markups":[]},{"name":"500e","type":8,"text":"import (\n  \"fmt\"\n  \"log\"\n  \"net\"","markups":[]},{"name":"ae11","type":8,"text":"  \"gitlab.com/pantomath-io/demo-grpc/api\"\n  \"google.golang.org/grpc\"\n)","markups":[]},{"name":"cc0a","type":8,"text":"// main start a gRPC server and waits for connection\nfunc main() {\n  // create a listener on TCP port 7777\n  lis, err := net.Listen(\"tcp\", fmt.Sprintf(\":%d\", 7777))\n  if err != nil {\n    log.Fatalf(\"failed to listen: %v\", err)\n  }","markups":[]},{"name":"bac7","type":8,"text":"  // create a server instance\n  s := api.Server{}","markups":[]},{"name":"938a","type":8,"text":"  // create a gRPC server object\n  grpcServer := grpc.NewServer()","markups":[]},{"name":"11a7","type":8,"text":"  // attach the Ping service to the server\n  api.RegisterPingServer(grpcServer, &s)","markups":[]},{"name":"7051","type":8,"text":"  // start the server\n  if err := grpcServer.Serve(lis); err != nil {\n    log.Fatalf(\"failed to serve: %s\", err)\n  }\n}","markups":[]},{"name":"6889","type":1,"text":"Let me break down to code to make it clearer:","markups":[]},{"name":"11f3","type":9,"text":"note that you import the api package, so that the Protobuf service handlers and theServer struct are available;","markups":[{"type":10,"start":25,"end":28},{"type":10,"start":59,"end":66},{"type":10,"start":83,"end":89},{"type":10,"start":90,"end":96}]},{"name":"9948","type":9,"text":"the main function starts by creating a TCP listener on the port you want to bind your gRPC server to;","markups":[{"type":10,"start":4,"end":8}]},{"name":"c292","type":9,"text":"then the rest is pretty straight forward: you create an instance of your Server, create an instance of a gRPC server, register the service, and start the gRPC server.","markups":[{"type":10,"start":73,"end":79},{"type":10,"start":131,"end":138}]},{"name":"f5c6","type":1,"text":"You can compile your code to get a server binary:","markups":[]},{"name":"55a2","type":8,"text":"$ go build -i -v -o bin/server gitlab.com/pantomath-io/demo-grpc/server","markups":[]},{"name":"950a","type":3,"text":"Creating the simplest client","markups":[]},{"name":"9a4f","type":1,"text":"git tag: init-client","markups":[{"type":3,"start":9,"end":20,"href":"https://gitlab.com/pantomath-io/demo-grpc/tree/init-client","title":"","rel":"","anchorType":0},{"type":2,"start":0,"end":20}]},{"name":"ca7c","type":4,"text":"Photo by Clem Onojeghuo on Unsplash","markups":[{"type":3,"start":9,"end":23,"href":"https://unsplash.com/photos/RLJnH4Mt9A0?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText","title":"","rel":"","anchorType":0},{"type":3,"start":27,"end":35,"href":"https://unsplash.com/?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText","title":"","rel":"","anchorType":0}],"layout":1,"metadata":{"id":"1*c6G6qANKUoyZn3awfRii1g.jpeg","originalWidth":5400,"originalHeight":3841}},{"name":"f005","type":1,"text":"The client also imports the api package, so that the message and the service are available. So create the file client/main.go:","markups":[{"type":10,"start":28,"end":31},{"type":10,"start":53,"end":60},{"type":10,"start":69,"end":76},{"type":10,"start":111,"end":125}]},{"name":"0983","type":8,"text":"package main","markups":[]},{"name":"47dd","type":8,"text":"import (\n  \"log\"","markups":[]},{"name":"0dbd","type":8,"text":"  \"gitlab.com/pantomath-io/demo-grpc/api\"\n  \"golang.org/x/net/context\"\n  \"google.golang.org/grpc\"\n)","markups":[]},{"name":"56fb","type":8,"text":"func main() {\n  var conn *grpc.ClientConn","markups":[]},{"name":"57b2","type":8,"text":"  conn, err := grpc.Dial(\":7777\", grpc.WithInsecure())\n  if err != nil {\n    log.Fatalf(\"did not connect: %s\", err)\n  }\n  defer conn.Close()","markups":[]},{"name":"eb5f","type":8,"text":"  c := api.NewPingClient(conn)","markups":[]},{"name":"dbae","type":8,"text":"  response, err := c.SayHello(context.Background(), &api.PingMessage{Greeting: \"foo\"})\n  if err != nil {\n    log.Fatalf(\"Error when calling SayHello: %s\", err)\n  }\n  log.Printf(\"Response from server: %s\", response.Greeting)\n}","markups":[]},{"name":"9981","type":1,"text":"Once again, the break down is pretty straight forward:","markups":[]},{"name":"8771","type":9,"text":"the main function instantiates a client connection, on the TCP port the server is bound to;","markups":[{"type":10,"start":4,"end":8}]},{"name":"a408","type":9,"text":"note the defer call to properly close the connection when the function returns;","markups":[{"type":10,"start":9,"end":14}]},{"name":"6c5a","type":9,"text":"the c variable is a client for the the Ping service, that calls the SayHello function, passing a PingMessage to it.","markups":[{"type":10,"start":4,"end":5},{"type":10,"start":39,"end":43},{"type":10,"start":68,"end":76},{"type":10,"start":97,"end":108}]},{"name":"fd9b","type":1,"text":"You can compile your code to get a client binary:","markups":[]},{"name":"8b13","type":8,"text":"$ go build -i -v -o bin/client gitlab.com/pantomath-io/demo-grpc/client","markups":[]},{"name":"9eac","type":3,"text":"Make them talk","markups":[]},{"name":"a2b5","type":1,"text":"You’ve just built a client and a server, so fire them in two terminals to test them:","markups":[]},{"name":"d84f","type":8,"text":"$ bin/server\n2006/01/02 15:04:05 Receive message foo","markups":[]},{"name":"8818","type":8,"text":"$ bin/client\n2006/01/02 15:04:05 Response from server: bar","markups":[]},{"name":"2ed5","type":3,"text":"Tool to ease your life","markups":[]},{"name":"1705","type":1,"text":"git tag: init-makefile","markups":[{"type":3,"start":9,"end":22,"href":"https://gitlab.com/pantomath-io/demo-grpc/blob/init-makefile/Makefile","title":"","rel":"","anchorType":0},{"type":2,"start":0,"end":22}]},{"name":"9cd9","type":1,"text":"Now the API, the client and the server are working, you may prefer to have a Makefile to compile the code, clean your folder, manage dependencies, etc.","markups":[]},{"name":"9c60","type":1,"text":"So create this Makefile at the root of the project folder. Explaining this file is beyond the scope of this post, and it mostly uses compile command you already spawned previously.","markups":[{"type":10,"start":15,"end":23,"href":"","title":"","rel":"","name":"","anchorType":0,"creatorIds":[],"userId":""},{"type":3,"start":15,"end":23,"href":"https://gitlab.com/pantomath-io/demo-grpc/blob/init-makefile/Makefile","title":"","rel":"","name":"","anchorType":0,"creatorIds":[],"userId":""}]},{"name":"f77e","type":1,"text":"To use the Makefile , try calling the following:","markups":[{"type":10,"start":11,"end":19}]},{"name":"a2eb","type":8,"text":"$ make help\napi                            Auto-generate grpc go sources\nbuild_client                   Build the binary file for client\nbuild_server                   Build the binary file for server\nclean                          Remove previous builds\ndep                            Get the dependencies\nhelp                           Display this help screen","markups":[]},{"name":"9a2d","type":3,"text":"Secure the communication","markups":[]},{"name":"2e9b","type":1,"text":"git tag: add-ssl","markups":[{"type":3,"start":9,"end":16,"href":"https://gitlab.com/pantomath-io/demo-grpc/tree/add-ssl","title":"","rel":"","anchorType":0},{"type":2,"start":0,"end":16}]},{"name":"467c","type":4,"text":"Photo by Nathaniel Tetteh on Unsplash","markups":[{"type":3,"start":9,"end":25,"href":"https://unsplash.com/photos/-4AFJ5yujcE?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText","title":"","rel":"","anchorType":0},{"type":3,"start":29,"end":37,"href":"https://unsplash.com/?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText","title":"","rel":"","anchorType":0}],"layout":1,"metadata":{"id":"1*k_WFayrFR6ciCOLn8fWI7g.jpeg","originalWidth":4469,"originalHeight":3072}},{"name":"84dc","type":1,"text":"The client and the servers talk to each other, over HTTP/2 (transport layer on gRPC). The messages are binary data(thanks to Protobuf), but the communication is in plaintext. Fortunately, gRPC has SSL/TLS integration, that can be used to authenticate the server (from the client’s perspective), and to encrypt message exchanges.","markups":[{"type":3,"start":52,"end":58,"href":"https://http2.github.io/","title":"","rel":"","anchorType":0}]},{"name":"29f5","type":1,"text":"You don’t need to change anything to the protocol: it remains the same. The changes take place in the gRPC object creation, on both client and server side. Note that if you change only one side, the connection won’t work.","markups":[]},{"name":"bde2","type":1,"text":"Before you change anything in the code, you need to create a self-signed SSL certificate. The purpose of this post is not to explain how to do that, but the official OpenSSL documentation (genrsa, req, x509) can answer your question about it (DigitalOcean also has a nice and complete tutorial about it). Meanwhile, you can just use the files provided in the cert folder. The following commands have been used to generate the files:","markups":[{"type":10,"start":189,"end":195},{"type":10,"start":197,"end":200},{"type":10,"start":202,"end":206},{"type":10,"start":359,"end":363},{"type":3,"start":61,"end":88,"href":"https://en.wikipedia.org/wiki/Self-signed_certificate","title":"","rel":"","anchorType":0},{"type":3,"start":157,"end":187,"href":"https://www.openssl.org/docs/manmaster/man1/","title":"","rel":"","anchorType":0},{"type":3,"start":189,"end":195,"href":"https://www.openssl.org/docs/manmaster/man1/genrsa.html","title":"","rel":"","anchorType":0},{"type":3,"start":197,"end":200,"href":"https://www.openssl.org/docs/manmaster/man1/req.html","title":"","rel":"","anchorType":0},{"type":3,"start":202,"end":206,"href":"https://www.openssl.org/docs/manmaster/man1/x509.html","title":"","rel":"","anchorType":0},{"type":3,"start":267,"end":293,"href":"https://www.digitalocean.com/community/tutorials/openssl-essentials-working-with-ssl-certificates-private-keys-and-csrs","title":"","rel":"","anchorType":0},{"type":3,"start":359,"end":363,"href":"https://gitlab.com/pantomath-io/demo-grpc/tree/add-ssl/cert","title":"","rel":"","anchorType":0}]},{"name":"5bbb","type":8,"text":"$ openssl genrsa -out cert/server.key 2048\n$ openssl req -new -x509 -sha256 -key cert/server.key -out cert/server.crt -days 3650\n$ openssl req -new -sha256 -key cert/server.key -out cert/server.csr\n$ openssl x509 -req -sha256 -in cert/server.csr -signkey cert/server.key -out cert/server.crt -days 3650","markups":[]},{"name":"29f3","type":1,"text":"You can proceed and update the server definition to use the certificate and the key:","markups":[]},{"name":"db4f","type":8,"text":"package main","markups":[]},{"name":"3c90","type":8,"text":"import (\n  \"fmt\"\n  \"log\"\n  \"net\"","markups":[]},{"name":"105c","type":8,"text":"  \"gitlab.com/pantomath-io/demo-grpc/api\"\n  \"google.golang.org/grpc\"\n  \"google.golang.org/grpc/credentials\"\n)","markups":[]},{"name":"9b9f","type":8,"text":"// main starts a gRPC server and waits for connection\nfunc main() {\n  // create a listener on TCP port 7777\n  lis, err := net.Listen(\"tcp\", fmt.Sprintf(\"%s:%d\", \"localhost\", 7777))\n  if err != nil {\n    log.Fatalf(\"failed to listen: %v\", err)\n  }","markups":[]},{"name":"936b","type":8,"text":"  // create a server instance\n  s := api.Server{}","markups":[]},{"name":"ba8c","type":8,"text":"  // Create the TLS credentials\n  creds, err := credentials.NewServerTLSFromFile(\"cert/server.crt\", \"cert/server.key\")\n  if err != nil {\n    log.Fatalf(\"could not load TLS keys: %s\", err)\n  }","markups":[]},{"name":"c02d","type":8,"text":"  // Create an array of gRPC options with the credentials\n  opts := []grpc.ServerOption{grpc.Creds(creds)}","markups":[]},{"name":"ad85","type":8,"text":"  // create a gRPC server object\n  grpcServer := grpc.NewServer(opts...)","markups":[]},{"name":"6a90","type":8,"text":"  // attach the Ping service to the server\n  api.RegisterPingServer(grpcServer, &s)","markups":[]},{"name":"af1b","type":8,"text":"  // start the server\n  if err := grpcServer.Serve(lis); err != nil {\n    log.Fatalf(\"failed to serve: %s\", err)\n  }\n}","markups":[]},{"name":"925b","type":1,"text":"So what changed?","markups":[]},{"name":"2e16","type":9,"text":"you created a credentials object (called creds) from your certificate and key files;","markups":[{"type":10,"start":41,"end":46,"href":"","title":"","rel":"","name":"","anchorType":0,"creatorIds":[],"userId":""},{"type":3,"start":14,"end":25,"href":"https://godoc.org/google.golang.org/grpc/credentials","title":"","rel":"","name":"","anchorType":0,"creatorIds":[],"userId":""}]},{"name":"1e2a","type":9,"text":"you created a grpc.ServerOption array and placed your credentials object in it;","markups":[{"type":10,"start":14,"end":31,"href":"","title":"","rel":"","name":"","anchorType":0,"creatorIds":[],"userId":""},{"type":3,"start":14,"end":31,"href":"https://godoc.org/google.golang.org/grpc#ServerOption","title":"","rel":"","name":"","anchorType":0,"creatorIds":[],"userId":""}]},{"name":"3beb","type":9,"text":"when creating the grpc server, you provided the constructor with you array of grpc.ServerOption;","markups":[{"type":10,"start":78,"end":95}]},{"name":"e92b","type":9,"text":"you must have noticed that you need to precisely specify the IP you bind your server to, so that the IP matches the FQDN used in the certificate.","markups":[]},{"name":"f540","type":1,"text":"Note that grpc.NewServer() is a variadic function, so you can pass it any number of trailing arguments. You created an array of options so that we can add other options later on.","markups":[{"type":10,"start":10,"end":26}]},{"name":"b3dd","type":1,"text":"If you compile your server now, and use the client you already have, the connection won’t work, and both sides will throw an error.","markups":[{"type":10,"start":20,"end":26},{"type":10,"start":44,"end":50}]},{"name":"de70","type":9,"text":"the server report the client is not handshaking with TLS:","markups":[]},{"name":"ca26","type":8,"text":"2006/01/02 15:04:05 grpc: Server.Serve failed to complete security handshake from \"localhost:64018\": tls: first record does not look like a TLS handshake","markups":[]},{"name":"cb77","type":9,"text":"the client has its connection closed before it can do anything:","markups":[]},{"name":"e67a","type":8,"text":"2006/01/02 15:04:05 transport: http2Client.notifyError got notified that the client transport was broken read tcp localhost:64018-\x3e127.0.0.1:7777: read: connection reset by peer.\n2006/01/02 15:04:05 Error when calling SayHello: rpc error: code = Internal desc = transport is closing","markups":[]},{"name":"bbf1","type":1,"text":"You need to use the exact same certificate file on the client side. So edit the client/main.go file:","markups":[{"type":10,"start":80,"end":94}]},{"name":"160a","type":8,"text":"package main","markups":[]},{"name":"de9b","type":8,"text":"import (\n  \"log\"","markups":[]},{"name":"7e5f","type":8,"text":"  \"gitlab.com/pantomath-io/demo-grpc/api\"\n  \"golang.org/x/net/context\"\n  \"google.golang.org/grpc\"\n  \"google.golang.org/grpc/credentials\"\n)","markups":[]},{"name":"76df","type":8,"text":"func main() {\n  var conn *grpc.ClientConn","markups":[]},{"name":"fa88","type":8,"text":"// Create the client TLS credentials\n  creds, err := credentials.NewClientTLSFromFile(\"cert/server.crt\", \"\")\n  if err != nil {\n    log.Fatalf(\"could not load tls cert: %s\", err)\n  }","markups":[]},{"name":"80fe","type":8,"text":"  // Initiate a connection with the server\n  conn, err = grpc.Dial(\"localhost:7777\", grpc.WithTransportCredentials(creds))\n  if err != nil {\n    log.Fatalf(\"did not connect: %s\", err)\n  }\n  defer conn.Close()","markups":[]},{"name":"4483","type":8,"text":"  c := api.NewPingClient(conn)","markups":[]},{"name":"e230","type":8,"text":"  response, err := c.SayHello(context.Background(), &api.PingMessage{Greeting: \"foo\"})\n  if err != nil {\n    log.Fatalf(\"error when calling SayHello: %s\", err)\n  }\n  log.Printf(\"Response from server: %s\", response.Greeting)\n}","markups":[]},{"name":"170e","type":1,"text":"The changes on the client side are pretty much the same as on the server:","markups":[]},{"name":"c01d","type":9,"text":"you created a credentials object with the certificate file. Note that the client do not use the certificate key, the key is private to the server;","markups":[{"type":3,"start":14,"end":25,"href":"https://godoc.org/google.golang.org/grpc/credentials","title":"","rel":"","anchorType":0},{"type":1,"start":81,"end":91}]},{"name":"d1f9","type":9,"text":"you added an option to the grpc.Dial() function, using your credentials object. Note that the grpc.Dial() function is also a variadic function, so it accepts any number of options;","markups":[{"type":10,"start":27,"end":38,"href":"","title":"","rel":"","name":"","anchorType":0,"creatorIds":[],"userId":""},{"type":10,"start":94,"end":105,"href":"","title":"","rel":"","name":"","anchorType":0,"creatorIds":[],"userId":""},{"type":3,"start":94,"end":105,"href":"https://godoc.org/google.golang.org/grpc#Dial","title":"","rel":"","name":"","anchorType":0,"creatorIds":[],"userId":""}]},{"name":"e6db","type":9,"text":"same server note applies for the client: you need to use the same FQDN to connect to the server as the one used in the certificate, or the transport authentication handshake will fail.","markups":[]},{"name":"5686","type":1,"text":"Both sides use credentials, so they should be able to talk just as before, but in an encrypted way. You can compile the code:","markups":[]},{"name":"7c0d","type":8,"text":"$ make","markups":[]},{"name":"fa67","type":1,"text":"And run both sides in separate terminals:","markups":[]},{"name":"161a","type":8,"text":"$ bin/server\n2006/01/02 15:04:05 Receive message foo","markups":[]},{"name":"5cce","type":8,"text":"$ bin/client\n2006/01/02 15:04:05 Response from server: bar","markups":[]},{"name":"771a","type":3,"text":"Identify the client","markups":[]},{"name":"632d","type":1,"text":"git tag: add-auth","markups":[{"type":3,"start":9,"end":17,"href":"https://gitlab.com/pantomath-io/demo-grpc/tree/add-auth","title":"","rel":"","anchorType":0},{"type":2,"start":0,"end":17}]},{"name":"3fa1","type":4,"text":"Photo by chuttersnap on Unsplash","markups":[{"type":3,"start":9,"end":20,"href":"https://unsplash.com/photos/984e1Fk4E04?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText","title":"","rel":"","anchorType":0},{"type":3,"start":24,"end":32,"href":"https://unsplash.com/?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText","title":"","rel":"","anchorType":0}],"layout":1,"metadata":{"id":"1*9hIUb4TpxYkHehxMb7KpEw.jpeg","originalWidth":6016,"originalHeight":4016}},{"name":"def1","type":1,"text":"Another interesting feature of the gRPC server is the ability to intercept a request from the client. The client can inject information on the transport layer. You can use that feature to identify your client, because the SSL implementation authenticates the server (via the certificate), but not the client (all your clients are using the same certificate).","markups":[]},{"name":"f173","type":1,"text":"So you’ll update the client side to inject metadata on every call (like a login and password), and the server side to check these credentials for every incoming call.","markups":[]},{"name":"9b50","type":1,"text":"On the client side, you just need to specify a DialOption on your grpc.Dial() call. But that DialOptionhas some constraints. Edit your client/main.go file:","markups":[{"type":10,"start":47,"end":57},{"type":10,"start":66,"end":77},{"type":10,"start":93,"end":103},{"type":10,"start":135,"end":149}]},{"name":"f503","type":8,"text":"package main","markups":[]},{"name":"b709","type":8,"text":"import (\n  \"log\"","markups":[]},{"name":"a705","type":8,"text":"  \"gitlab.com/pantomath-io/demo-grpc/api\"\n  \"golang.org/x/net/context\"\n  \"google.golang.org/grpc\"\n  \"google.golang.org/grpc/credentials\"\n)","markups":[]},{"name":"5f10","type":8,"text":"// Authentication holds the login/password\ntype Authentication struct {\n  Login    string\n  Password string\n}","markups":[]},{"name":"a79e","type":8,"text":"// GetRequestMetadata gets the current request metadata\nfunc (a *Authentication) GetRequestMetadata(context.Context, ...string) (map[string]string, error) {\n  return map[string]string{\n    \"login\":    a.Login,\n    \"password\": a.Password,\n  }, nil\n}","markups":[]},{"name":"3889","type":8,"text":"// RequireTransportSecurity indicates whether the credentials requires transport security\nfunc (a *Authentication) RequireTransportSecurity() bool {\n  return true\n}","markups":[]},{"name":"7aac","type":8,"text":"func main() {\n  var conn *grpc.ClientConn","markups":[]},{"name":"b411","type":8,"text":"// Create the client TLS credentials\n  creds, err := credentials.NewClientTLSFromFile(\"cert/server.crt\", \"\")\n  if err != nil {\n    log.Fatalf(\"could not load tls cert: %s\", err)\n }","markups":[]},{"name":"0a66","type":8,"text":"  // Setup the login/pass\n  auth := Authentication{\n    Login:    \"john\",\n    Password: \"doe\",\n  }","markups":[]},{"name":"9bb5","type":8,"text":"  // Initiate a connection with the server\n  conn, err = grpc.Dial(\"localhost:7777\", grpc.WithTransportCredentials(creds), grpc.WithPerRPCCredentials(&auth))\n  if err != nil {\n    log.Fatalf(\"did not connect: %s\", err)\n   }\n   defer conn.Close()","markups":[]},{"name":"c5c1","type":8,"text":"  c := api.NewPingClient(conn)","markups":[]},{"name":"bd00","type":8,"text":"  response, err := c.SayHello(context.Background(), &api.PingMessage{Greeting: \"foo\"})\n  if err != nil {\n    log.Fatalf(\"error when calling SayHello: %s\", err)\n  }\n  log.Printf(\"Response from server: %s\", response.Greeting)\n}","markups":[]},{"name":"c0cf","type":9,"text":"You define a struct to hold the collection on fields you want to inject in your rcp calls. In our case, just a login and password, but you can imagine any fields you want;","markups":[]},{"name":"df2f","type":9,"text":"The auth variable holds the values you’ll be using;","markups":[{"type":10,"start":4,"end":8}]},{"name":"2dca","type":9,"text":"You use grpc.WithPerRPCCredentials() function to create a DialOption object to the grpc.Dial() function;","markups":[{"type":10,"start":8,"end":36},{"type":10,"start":58,"end":68},{"type":10,"start":83,"end":94}]},{"name":"725e","type":9,"text":"Note that the grpc.WithPerRPCCredentials() function takes an interface as parameter, so your Authentication structure should comply to that interface. From the documentation, you know you should implement 2 methods on your structure: GetRequestMetadata and RequireTransportSecurity.","markups":[{"type":10,"start":14,"end":42},{"type":10,"start":93,"end":107},{"type":10,"start":234,"end":252},{"type":10,"start":257,"end":281},{"type":3,"start":14,"end":42,"href":"https://godoc.org/google.golang.org/grpc#WithPerRPCCredentials","title":"","rel":"","anchorType":0},{"type":3,"start":160,"end":173,"href":"https://godoc.org/google.golang.org/grpc/credentials#PerRPCCredentials","title":"","rel":"","anchorType":0}]},{"name":"aa00","type":9,"text":"So you define GetRequestMetadata function that just returns a map of your Authentication structure;","markups":[{"type":10,"start":14,"end":32},{"type":10,"start":74,"end":88}]},{"name":"7ba1","type":9,"text":"And finally, you define RequireTransportSecurity function, that tells your grpc client if it should inject metadata at the transport level. In our current case, it always returns true, but you could have it return the value of a configuration boolean, for instance.","markups":[{"type":10,"start":24,"end":48},{"type":10,"start":75,"end":79}]},{"name":"bf95","type":1,"text":"The client is up to push extra data during its calls to the server, but the server does not care, right now. So you need to tell him to check these metadata. Open server/main.go and update it:","markups":[{"type":10,"start":163,"end":177}]},{"name":"2cb4","type":8,"text":"package main","markups":[]},{"name":"d0d6","type":8,"text":"import (\n  \"fmt\"\n  \"log\"\n  \"net\"\n  \"strings\"","markups":[]},{"name":"400a","type":8,"text":"  \"golang.org/x/net/context\"","markups":[]},{"name":"88a0","type":8,"text":"  \"gitlab.com/pantomath-io/demo-grpc/api\"\n  \"google.golang.org/grpc\"\n  \"google.golang.org/grpc/credentials\"\n  \"google.golang.org/grpc/metadata\"\n)","markups":[]},{"name":"9c78","type":8,"text":"// private type for Context keys\ntype contextKey int","markups":[]},{"name":"437f","type":8,"text":"const (\n  clientIDKey contextKey = iota\n)","markups":[]},{"name":"b6b0","type":8,"text":"// authenticateAgent check the client credentials\nfunc authenticateClient(ctx context.Context, s *api.Server) (string, error) {\n  if md, ok := metadata.FromIncomingContext(ctx); ok {\n    clientLogin := strings.Join(md[\"login\"], \"\")\n    clientPassword := strings.Join(md[\"password\"], \"\")","markups":[]},{"name":"c9f4","type":8,"text":"    if clientLogin != \"john\" {\n      return \"\", fmt.Errorf(\"unknown user %s\", clientLogin)\n    }\n    if clientPassword != \"doe\" {\n      return \"\", fmt.Errorf(\"bad password %s\", clientPassword)\n    }","markups":[]},{"name":"bdf6","type":8,"text":"    log.Printf(\"authenticated client: %s\", clientLogin)\n    return \"42\", nil\n  }","markups":[]},{"name":"91ec","type":8,"text":"  return \"\", fmt.Errorf(\"missing credentials\")\n}","markups":[]},{"name":"8de8","type":8,"text":"// unaryInterceptor calls authenticateClient with current context\nfunc unaryInterceptor(ctx context.Context, req interface{}, info *grpc.UnaryServerInfo, handler grpc.UnaryHandler) (interface{}, error) {\n  s, ok := info.Server.(*api.Server)\n  if !ok {\n    return nil, fmt.Errorf(\"unable to cast server\")\n  }\n  clientID, err := authenticateClient(ctx, s)\n  if err != nil {\n    return nil, err\n  }","markups":[]},{"name":"15cc","type":8,"text":"  ctx = context.WithValue(ctx, clientIDKey, clientID)\n  return handler(ctx, req)\n}","markups":[]},{"name":"edc7","type":8,"text":"// main start a gRPC server and waits for connection\nfunc main() {\n  // create a listener on TCP port 7777\n  lis, err := net.Listen(\"tcp\", fmt.Sprintf(\"%s:%d\", \"localhost\", 7777))\n  if err != nil {\n    log.Fatalf(\"failed to listen: %v\", err)\n  }","markups":[]},{"name":"3c7a","type":8,"text":"  // create a server instance\n  s := api.Server{}","markups":[]},{"name":"3a0d","type":8,"text":"  // Create the TLS credentials\n  creds, err := credentials.NewServerTLSFromFile(\"cert/server.crt\", \"cert/server.key\")\n  if err != nil {\n    log.Fatalf(\"could not load TLS keys: %s\", err)\n  }","markups":[]},{"name":"cc13","type":8,"text":"  // Create an array of gRPC options with the credentials\n  opts := []grpc.ServerOption{grpc.Creds(creds),\n    grpc.UnaryInterceptor(unaryInterceptor)}","markups":[]},{"name":"a608","type":8,"text":"  // create a gRPC server object\n  grpcServer := grpc.NewServer(opts...)","markups":[]},{"name":"fb80","type":8,"text":"  // attach the Ping service to the server\n  api.RegisterPingServer(grpcServer, &s)","markups":[]},{"name":"5abb","type":8,"text":"  // start the server\n  if err := grpcServer.Serve(lis); err != nil {\n    log.Fatalf(\"failed to serve: %s\", err)\n  }\n}","markups":[]},{"name":"6d99","type":1,"text":"Once again, let me break down this for you:","markups":[]},{"name":"a860","type":9,"text":"you add a new grpc.ServerOption to the array you created before (see why it’s an array, now?): grpc.UnaryInterceptor. And you pass a reference to a function to that function, so it knows who to call. The rest of the main code does not change;","markups":[{"type":10,"start":14,"end":31},{"type":10,"start":95,"end":116},{"type":3,"start":95,"end":116,"href":"https://godoc.org/google.golang.org/grpc#UnaryInterceptor","title":"","rel":"","anchorType":0},{"type":3,"start":133,"end":156,"href":"https://godoc.org/google.golang.org/grpc#UnaryServerInterceptor","title":"","rel":"","anchorType":0}]},{"name":"8804","type":9,"text":"you have to define the unaryInterceptor function, considering it gets a bunch of parameters:","markups":[{"type":10,"start":23,"end":39}]},{"name":"0e22","type":10,"text":"a context.Context object, containing your data, and that will exist during all the lifetime of the request;","markups":[{"type":10,"start":2,"end":17},{"type":3,"start":2,"end":17,"href":"https://godoc.org/golang.org/x/net/context","title":"","rel":"","anchorType":0}]},{"name":"1b8b","type":10,"text":"an interface{} which is the inbound parameter of the RPC call;","markups":[{"type":10,"start":3,"end":14}]},{"name":"7d20","type":10,"text":"a UnaryServerInfo struct which contains a bunch of information about the call (such as the Server abstraction object, and the method call by the client);","markups":[{"type":10,"start":2,"end":17},{"type":10,"start":91,"end":97},{"type":3,"start":2,"end":17,"href":"https://godoc.org/google.golang.org/grpc#UnaryServerInfo","title":"","rel":"","anchorType":0}]},{"name":"37eb","type":10,"text":"a UnaryHandler struct which is the handler invoked by UnaryServerInterceptor to complete the normal execution of a unary RPC (i.e. an handler to what happens when the UnaryInterceptor returns).","markups":[{"type":10,"start":2,"end":14},{"type":10,"start":54,"end":76},{"type":10,"start":167,"end":183},{"type":3,"start":2,"end":14,"href":"https://godoc.org/google.golang.org/grpc#UnaryHandler","title":"","rel":"","anchorType":0}]},{"name":"fecb","type":9,"text":"the unaryInterceptor function makes sure the grpc.UnaryServerInfo has the right server abstraction, and call the authentication function, authenticateClient;","markups":[{"type":10,"start":4,"end":20},{"type":10,"start":45,"end":65},{"type":10,"start":138,"end":156}]},{"name":"346d","type":9,"text":"you define the authenticateClient function with your authentication logic — very very simple in this example. Note that it receives the context.Context as parameter, and extract the metadata from it. It checks the user, and returns its ID (in the form of a string, with a hypothetical error.","markups":[{"type":10,"start":15,"end":33},{"type":10,"start":136,"end":151},{"type":10,"start":257,"end":263}]},{"name":"69c8","type":9,"text":"if the unaryInterceptor gets no error from the authenticateClient function, it pushes the clientID in the context.Context object, so that the rest of the execution chain can use it (remember the handler gets the context.Context object as parameter?);","markups":[{"type":10,"start":7,"end":23},{"type":10,"start":47,"end":65},{"type":10,"start":90,"end":98},{"type":10,"start":106,"end":121},{"type":10,"start":195,"end":202},{"type":10,"start":212,"end":227}]},{"name":"828a","type":9,"text":"Note that you created your type and const to reference the clientID in the context.Context map. This is just an handy way to avoid naming conflict and to allow constant reference.","markups":[{"type":10,"start":27,"end":31},{"type":10,"start":36,"end":41},{"type":10,"start":59,"end":67},{"type":10,"start":75,"end":90}]},{"name":"fa0d","type":1,"text":"You can compile the code:","markups":[]},{"name":"ab49","type":8,"text":"$ make","markups":[]},{"name":"77bf","type":1,"text":"And run both sides in separate terminals:","markups":[]},{"name":"801e","type":8,"text":"$ bin/server\n2006/01/02 15:04:05 authenticated client: john\n2006/01/02 15:04:05 Receive message foo","markups":[]},{"name":"3596","type":8,"text":"$ bin/client\n2006/01/02 15:04:05 Response from server: bar","markups":[]},{"name":"f9ec","type":1,"text":"Obviously, your authentication logic will probably be smarter, comparing credentials against a database. The easy part of it is: your authentication function gets your abstraction of a Server, and this structure can hold your database handler.","markups":[{"type":10,"start":185,"end":191}]},{"name":"6be6","type":3,"text":"Open to REST","markups":[]},{"name":"42df","type":1,"text":"git tag: add-rest","markups":[{"type":3,"start":9,"end":17,"href":"https://gitlab.com/pantomath-io/demo-grpc/tree/add-rest","title":"","rel":"","anchorType":0},{"type":2,"start":0,"end":17}]},{"name":"3ba3","type":4,"text":"Photo by Rio Hodges on Unsplash","markups":[{"type":3,"start":9,"end":19,"href":"https://unsplash.com/photos/nNPONh2aXeQ?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText","title":"","rel":"","anchorType":0},{"type":3,"start":23,"end":31,"href":"https://unsplash.com/?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText","title":"","rel":"","anchorType":0}],"layout":1,"metadata":{"id":"1*dpCAELNImICQxw8UxA0bsA.jpeg","originalWidth":6000,"originalHeight":4000}},{"name":"7b17","type":1,"text":"One last thing: you have a pretty neat server, client and protocol; serialized, encrypted and authenticated. But there is a important limit: your client needs to be gRPC compliant, that is be in the list of supported platforms. To avoid that limit, we can open the server to a REST gateway, allowing REST clients to perform requests it. Luckily, there is a gRPC protoc plugin to generate a reverse-proxy server which translates a RESTful JSON API into gRPC. We can use a few line of pure Go code to serve that reverse-proxy.","markups":[{"type":3,"start":207,"end":226,"href":"https://grpc.io/about/#osp","title":"","rel":"","anchorType":0},{"type":3,"start":362,"end":375,"href":"https://github.com/grpc-ecosystem/grpc-gateway","title":"","rel":"","anchorType":0}]},{"name":"bb49","type":1,"text":"So edit your api/api.proto file to add some extra information:","markups":[{"type":10,"start":13,"end":26},{"type":3,"start":13,"end":26,"href":"https://gitlab.com/pantomath-io/demo-grpc/blob/add-rest/api/api.proto","title":"","rel":"","anchorType":0}]},{"name":"23f1","type":8,"text":"syntax = \"proto3\";\npackage api;","markups":[]},{"name":"94d2","type":8,"text":"import \"google/api/annotations.proto\";","markups":[]},{"name":"ea83","type":8,"text":"message PingMessage {\n  string greeting = 1;\n}","markups":[]},{"name":"0923","type":8,"text":"service Ping {\n  rpc SayHello(PingMessage) returns (PingMessage) {\n    option (google.api.http) = {\n      post: \"/1/ping\"\n      body: \"*\"\n    };\n  }\n}","markups":[]},{"name":"8334","type":1,"text":"The annotations.proto import allows protoc to understand the option set later in the file. And the option defines that method and the path to the endpoint.","markups":[{"type":10,"start":4,"end":21},{"type":10,"start":36,"end":42},{"type":10,"start":61,"end":67},{"type":10,"start":99,"end":105}]},{"name":"a553","type":1,"text":"Update the Makefile to add a target for this new Protobuf compilation:","markups":[{"type":10,"start":11,"end":19},{"type":10,"start":49,"end":57},{"type":3,"start":11,"end":19,"href":"https://gitlab.com/pantomath-io/demo-grpc/blob/add-rest/Makefile","title":"","rel":"","anchorType":0}]},{"name":"7edc","type":8,"text":"SERVER_OUT := \"bin/server\"\nCLIENT_OUT := \"bin/client\"\nAPI_OUT := \"api/api.pb.go\"\nAPI_REST_OUT := \"api/api.pb.gw.go\"\nPKG := \"gitlab.com/pantomath-io/demo-grpc\"\nSERVER_PKG_BUILD := \"${PKG}/server\"\nCLIENT_PKG_BUILD := \"${PKG}/client\"\nPKG_LIST := $(shell go list ${PKG}/... | grep -v /vendor/)","markups":[]},{"name":"e959","type":8,"text":".PHONY: all api server client","markups":[]},{"name":"5865","type":8,"text":"all: server client","markups":[]},{"name":"4ca7","type":8,"text":"api/api.pb.go: api/api.proto\n  @protoc -I api/ \\\n    -I${GOPATH}/src \\\n    -I${GOPATH}/src/github.com/grpc-ecosystem/grpc-gateway/third_party/googleapis \\\n    --go_out=plugins=grpc:api \\\n    api/api.proto","markups":[{"type":3,"start":31,"end":38,"href":"http://twitter.com/protoc","title":"Twitter profile for @protoc","rel":"","anchorType":0}]},{"name":"8d74","type":8,"text":"api/api.pb.gw.go: api/api.proto\n  @protoc -I api/ \\\n    -I${GOPATH}/src \\\n    -I${GOPATH}/src/github.com/grpc-ecosystem/grpc-gateway/third_party/googleapis \\\n    --grpc-gateway_out=logtostderr=true:api \\\n    api/api.proto","markups":[{"type":3,"start":34,"end":41,"href":"http://twitter.com/protoc","title":"Twitter profile for @protoc","rel":"","anchorType":0}]},{"name":"f9bc","type":8,"text":"api: api/api.pb.go api/api.pb.gw.go ## Auto-generate grpc go sources","markups":[]},{"name":"7d43","type":8,"text":"dep: ## Get the dependencies\n  @go get -v -d ./...","markups":[{"type":3,"start":31,"end":34,"href":"http://twitter.com/go","title":"Twitter profile for @go","rel":"","anchorType":0}]},{"name":"dc25","type":8,"text":"server: dep api ## Build the binary file for server\n  @go build -i -v -o $(SERVER_OUT) $(SERVER_PKG_BUILD)","markups":[{"type":3,"start":54,"end":57,"href":"http://twitter.com/go","title":"Twitter profile for @go","rel":"","anchorType":0}]},{"name":"a709","type":8,"text":"client: dep api ## Build the binary file for client\n  @go build -i -v -o $(CLIENT_OUT) $(CLIENT_PKG_BUILD)","markups":[{"type":3,"start":54,"end":57,"href":"http://twitter.com/go","title":"Twitter profile for @go","rel":"","anchorType":0}]},{"name":"de0e","type":8,"text":"clean: ## Remove previous builds\n  @rm $(SERVER_OUT) $(CLIENT_OUT) $(API_OUT) $(API_REST_OUT)","markups":[{"type":3,"start":35,"end":38,"href":"http://twitter.com/rm","title":"Twitter profile for @rm","rel":"","anchorType":0}]},{"name":"a664","type":8,"text":"help: ## Display this help screen\n  @grep -E '^[a-zA-Z_-]+:.*?## .*$$' $(MAKEFILE_LIST) | sort | awk 'BEGIN {FS = \":.*?## \"}; {printf \"\\033[36m%-30s\\033[0m %s\\n\", $$1, $$2}'","markups":[{"type":3,"start":36,"end":41,"href":"http://twitter.com/grep","title":"Twitter profile for @grep","rel":"","anchorType":0}]},{"name":"4f52","type":1,"text":"Generate the Go code for the gateway (the file api/api.pb.gw.go will be generated — just as api/api.pb.go, don’t edit it, it will be updated by compilation):","markups":[{"type":10,"start":47,"end":63},{"type":10,"start":92,"end":105}]},{"name":"7be8","type":8,"text":"$ make api","markups":[]},{"name":"868c","type":1,"text":"The change on the server side is more important. The grpc.Serve() function is a blocking function, that returns only on error (or can get killed by a signal). As we need to start another server (the REST interface), we need this call to be non-blocking. Fortunately, we have goroutines just for that. And there is a trick on the authentication. As the REST gateway is just a reverse-proxy, it acts as a client from the gRPC perspective. Thus it needs to use a WithPerRPCCredentials option when dialing the server.","markups":[{"type":10,"start":53,"end":65},{"type":10,"start":460,"end":481},{"type":1,"start":275,"end":285}]},{"name":"efae","type":1,"text":"Head to your server/main.go file:","markups":[{"type":10,"start":13,"end":27},{"type":3,"start":13,"end":27,"href":"https://gitlab.com/pantomath-io/demo-grpc/blob/add-rest/server/main.go","title":"","rel":"","anchorType":0}]},{"name":"ec62","type":8,"text":"package main","markups":[]},{"name":"0919","type":8,"text":"import (\n  \"fmt\"\n  \"log\"\n  \"net\"\n  \"net/http\"\n  \"strings\"","markups":[]},{"name":"2cc3","type":8,"text":"  \"github.com/grpc-ecosystem/grpc-gateway/runtime\"\n  \"golang.org/x/net/context\"\n  \"gitlab.com/pantomath-io/demo-grpc/api\"\n  \"google.golang.org/grpc\"\n  \"google.golang.org/grpc/credentials\"\n  \"google.golang.org/grpc/metadata\"\n)","markups":[]},{"name":"0450","type":8,"text":"// private type for Context keys\ntype contextKey int","markups":[]},{"name":"712d","type":8,"text":"const (\n  clientIDKey contextKey = iota\n)","markups":[]},{"name":"3e51","type":8,"text":"func credMatcher(headerName string) (mdName string, ok bool) {\n  if headerName == \"Login\" || headerName == \"Password\" {\n    return headerName, true\n  }\n  return \"\", false\n}","markups":[]},{"name":"f645","type":8,"text":"// authenticateAgent check the client credentials\nfunc authenticateClient(ctx context.Context, s *api.Server) (string, error) {\n  if md, ok := metadata.FromIncomingContext(ctx); ok {\n    clientLogin := strings.Join(md[\"login\"], \"\")\n    clientPassword := strings.Join(md[\"password\"], \"\")","markups":[]},{"name":"fec5","type":8,"text":"    if clientLogin != \"john\" {\n      return \"\", fmt.Errorf(\"unknown user %s\", clientLogin)\n    }\n    if clientPassword != \"doe\" {\n      return \"\", fmt.Errorf(\"bad password %s\", clientPassword)\n    }","markups":[]},{"name":"5dfa","type":8,"text":"    log.Printf(\"authenticated client: %s\", clientLogin)\n    return \"42\", nil\n  }\n  return \"\", fmt.Errorf(\"missing credentials\")\n}","markups":[]},{"name":"2c1c","type":8,"text":"// unaryInterceptor call authenticateClient with current context\nfunc unaryInterceptor(ctx context.Context, req interface{}, info *grpc.UnaryServerInfo, handler grpc.UnaryHandler) (interface{}, error) {\n  s, ok := info.Server.(*api.Server)\n  if !ok {\n    return nil, fmt.Errorf(\"unable to cast server\")\n  }\n  clientID, err := authenticateClient(ctx, s)\n  if err != nil {\n    return nil, err\n  }","markups":[]},{"name":"805e","type":8,"text":"  ctx = context.WithValue(ctx, clientIDKey, clientID)\n  return handler(ctx, req)\n}","markups":[]},{"name":"a9b4","type":8,"text":"func startGRPCServer(address, certFile, keyFile string) error {\n  // create a listener on TCP port\n  lis, err := net.Listen(\"tcp\", address)\n  if err != nil {\n    return fmt.Errorf(\"failed to listen: %v\", err)\n  }","markups":[]},{"name":"42ca","type":8,"text":"  // create a server instance\n  s := api.Server{}","markups":[]},{"name":"55ec","type":8,"text":"  // Create the TLS credentials\n  creds, err := credentials.NewServerTLSFromFile(certFile, keyFile)\n  if err != nil {\n    return fmt.Errorf(\"could not load TLS keys: %s\", err)\n  }","markups":[]},{"name":"0762","type":8,"text":"  // Create an array of gRPC options with the credentials\n  opts := []grpc.ServerOption{grpc.Creds(creds),\n    grpc.UnaryInterceptor(unaryInterceptor)}","markups":[]},{"name":"ec19","type":8,"text":"  // create a gRPC server object\n  grpcServer := grpc.NewServer(opts...)","markups":[]},{"name":"6788","type":8,"text":"  // attach the Ping service to the server\n  api.RegisterPingServer(grpcServer, &s)","markups":[]},{"name":"96a7","type":8,"text":"  // start the server\n  log.Printf(\"starting HTTP/2 gRPC server on %s\", address)\n  if err := grpcServer.Serve(lis); err != nil {\n    return fmt.Errorf(\"failed to serve: %s\", err)\n  }","markups":[]},{"name":"a82b","type":8,"text":"  return nil\n}","markups":[]},{"name":"dae7","type":8,"text":"func startRESTServer(address, grpcAddress, certFile string) error {\n  ctx := context.Background()\n  ctx, cancel := context.WithCancel(ctx)\n  defer cancel()","markups":[]},{"name":"2ade","type":8,"text":"  mux := runtime.NewServeMux(runtime.WithIncomingHeaderMatcher(credMatcher))","markups":[]},{"name":"bb8c","type":8,"text":"  creds, err := credentials.NewClientTLSFromFile(certFile, \"\")\n  if err != nil {\n    return fmt.Errorf(\"could not load TLS certificate: %s\", err)\n  }","markups":[]},{"name":"0820","type":8,"text":"  // Setup the client gRPC options\n  opts := []grpc.DialOption{grpc.WithTransportCredentials(creds)}","markups":[]},{"name":"cd36","type":8,"text":"  // Register ping\n  err = api.RegisterPingHandlerFromEndpoint(ctx, mux, grpcAddress, opts)\n  if err != nil {\n    return fmt.Errorf(\"could not register service Ping: %s\", err)\n  }","markups":[]},{"name":"7f0b","type":8,"text":"  log.Printf(\"starting HTTP/1.1 REST server on %s\", address)\n  http.ListenAndServe(address, mux)","markups":[]},{"name":"1b50","type":8,"text":"  return nil\n}","markups":[]},{"name":"872b","type":8,"text":"// main start a gRPC server and waits for connection\nfunc main() {\n  grpcAddress := fmt.Sprintf(\"%s:%d\", \"localhost\", 7777)\n  restAddress := fmt.Sprintf(\"%s:%d\", \"localhost\", 7778)\n  certFile := \"cert/server.crt\"\n  keyFile := \"cert/server.key\"","markups":[]},{"name":"c96f","type":8,"text":"  // fire the gRPC server in a goroutine\n  go func() {\n    err := startGRPCServer(grpcAddress, certFile, keyFile)\n    if err != nil {\n      log.Fatalf(\"failed to start gRPC server: %s\", err)\n    }\n  }()","markups":[]},{"name":"7670","type":8,"text":"  // fire the REST server in a goroutine\n  go func() {\n    err := startRESTServer(restAddress, grpcAddress, certFile)\n    if err != nil {\n      log.Fatalf(\"failed to start gRPC server: %s\", err)\n    }\n  }()","markups":[]},{"name":"3793","type":8,"text":"  // infinite loop\n  log.Printf(\"Entering infinite loop\")\n  select {}\n}","markups":[]},{"name":"b471","type":1,"text":"So what happened?","markups":[]},{"name":"9601","type":9,"text":"you moved all the code for the gRPC server creation in a goroutine with a dedicated function (startGRPCServer), so it does not block the main;","markups":[{"type":10,"start":94,"end":109},{"type":10,"start":137,"end":141}]},{"name":"a5bc","type":9,"text":"you create a new goroutine with a dedicated function (startRESTServer) where you create an HTTP/1.1 server;","markups":[{"type":10,"start":54,"end":69}]},{"name":"9df8","type":9,"text":"in startRESTServer where you create the REST gateway, you start by getting the context.Context background object (i.e. the root of the context tree). Then, you create a request multiplexer object, mux, with an option: runtime.WithIncomingHeaderMatcher. This option takes a function reference as parameter, credMatch, and is called for every HTTP header from the incoming request. The function evaluates whether or not the HTTP header should be passed to the gRPC context;","markups":[{"type":10,"start":3,"end":18},{"type":10,"start":79,"end":94},{"type":10,"start":197,"end":200},{"type":10,"start":218,"end":251},{"type":10,"start":306,"end":315}]},{"name":"615f","type":9,"text":"you defined the credMatch function to match the credentials header, allowing them to be metadata in the gRPC context. This is how you have your authentication working, because the reverse-proxy uses the HTTP headers it receives when it connects to the gRPC server;","markups":[{"type":10,"start":16,"end":25}]},{"name":"d29e","type":9,"text":"you also create a credentials.NewClientTLSFromFile, to be used as a grpc.DialOption, just like you did in the client side;","markups":[{"type":10,"start":18,"end":50},{"type":10,"start":68,"end":83}]},{"name":"9caf","type":9,"text":"you register your api endpoint, i.e. you make the link between your multiplexer, you gRPC server, using the context and the gRPC options;","markups":[]},{"name":"869b","type":9,"text":"and finally, you start an HTTP/1.1 server, and wait for incoming connections;","markups":[]},{"name":"2c30","type":9,"text":"aside to your goroutine, you use a blocking select call, so that your program does not end right away.","markups":[{"type":10,"start":44,"end":50}]},{"name":"b097","type":1,"text":"Now build the whole project, so you can test the REST interface:","markups":[]},{"name":"9f92","type":8,"text":"$ make","markups":[]},{"name":"139f","type":1,"text":"And run both sides in separate terminals:","markups":[]},{"name":"e284","type":8,"text":"$ bin/server\n2006/01/02 15:04:05 Entering infinite loop\n2006/01/02 15:04:05 starting HTTP/1.1 REST server on localhost:7778\n2006/01/02 15:04:05 starting HTTP/2 gRPC server on localhost:7777\n2006/01/02 15:04:05 authenticated client: john\n2006/01/02 15:04:05 Receive message foo","markups":[]},{"name":"b0f0","type":8,"text":"$ curl -H \"login:john\" -H \"password:doe\" -X POST -d '{\"greeting\":\"foo\"}' 'http://localhost:7778/1/ping'\n{\"greeting\":\"bar\"}","markups":[{"type":3,"start":74,"end":103,"href":"http://localhost:7778/1/ping'","title":"","rel":"nofollow","anchorType":0}]},{"name":"f6e3","type":3,"text":"One last swag…","markups":[]},{"name":"c4d2","type":1,"text":"git tag: add-swagger","markups":[{"type":3,"start":9,"end":20,"href":"https://gitlab.com/pantomath-io/demo-grpc/tree/add-swagger","title":"","rel":"","anchorType":0},{"type":2,"start":0,"end":20}]},{"name":"940f","type":4,"text":"Photo by Lorenzo Castagnone on Unsplash","markups":[{"type":3,"start":9,"end":27,"href":"https://unsplash.com/photos/ETNcibiiWOs?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText","title":"","rel":"","anchorType":0},{"type":3,"start":31,"end":39,"href":"https://unsplash.com/?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText","title":"","rel":"","anchorType":0}],"layout":1,"metadata":{"id":"1*lg78b_518eFveLDKDsA5hQ.jpeg","originalWidth":5472,"originalHeight":3648}},{"name":"a08f","type":1,"text":"The REST gateway is cool, but it would be even cooler to generate documentation from it, right?","markups":[]},{"name":"bc9e","type":1,"text":"You can do that for free, using a protoc plugin to generate a swagger json file:","markups":[{"type":3,"start":34,"end":47,"href":"https://github.com/grpc-ecosystem/grpc-gateway","title":"","rel":"noopener","anchorType":0},{"type":3,"start":62,"end":69,"href":"https://swagger.io/","title":"","rel":"","anchorType":0}]},{"name":"23c1","type":8,"text":"protoc -I api/ \\\n  -I${GOPATH}/src \\\n  -I${GOPATH}/src/github.com/grpc-ecosystem/grpc-gateway/third_party/googleapis \\\n  --swagger_out=logtostderr=true:api \\\n  api/api.proto","markups":[]},{"name":"9b4a","type":1,"text":"This will generate a api/api.swagger.json file. As all generated code from Protobuf compilation, you should not edit it, but you can use it, and it can update it when you change your definition file.","markups":[{"type":10,"start":21,"end":41}]},{"name":"93f7","type":1,"text":"You can add the compilation command in the Makefile.","markups":[{"type":10,"start":43,"end":51},{"type":3,"start":43,"end":51,"href":"https://gitlab.com/pantomath-io/demo-grpc/blob/add-swagger/Makefile","title":"","rel":"","anchorType":0}]},{"name":"0d18","type":3,"text":"Conclusion","markups":[]},{"name":"917a","type":1,"text":"You have a fully functional gRPC client and server, with SSL encryption & authentication, client identification, and a REST gateway (with its swagger file). Where to go from here?","markups":[]},{"name":"13d3","type":1,"text":"You can push a little on the REST gateway, to make it HTTPS instead of HTTP. You can obviously add more complex data structure on your Protobuf, alongside with more service. You can benefit from HTTP/2 features, such as streaming, either from client to server, or from server to client, or bidirectional (but that’s only for gRPC, not for the REST, based on HTTP/1.1).","markups":[{"type":10,"start":165,"end":172},{"type":3,"start":220,"end":229,"href":"https://grpc.io/docs/guides/concepts.html#bidirectional-streaming-rpc","title":"","rel":"","anchorType":0}]},{"name":"deb2","type":1,"text":"Many thanks to Charles Francoise who co-wrote this paper and https://gitlab.com/pantomath-io/demo-grpc.","markups":[{"type":3,"start":15,"end":32,"anchorType":2,"userId":"177d8b64f64f"},{"type":3,"start":61,"end":102,"href":"https://gitlab.com/pantomath-io/demo-grpc","title":"","rel":"nofollow","anchorType":0},{"type":2,"start":0,"end":103}]},{"name":"04a4","type":1,"text":"We are currently working on Pantomath. Pantomath is a modern, open-source monitoring solution, built for performance, that bridges the gaps across all levels of your company. The well-being of your infrastructure is everyone’s business. Keep up with the project : goo.gl/tcxtXq","markups":[{"type":3,"start":264,"end":277,"href":"http://goo.gl/tcxtXq","title":"","rel":"","anchorType":0},{"type":2,"start":0,"end":277}]}],"sections":[{"name":"a6ac","startIndex":0},{"name":"8c8c","startIndex":266}]},"postDisplay":{"coverless":true}},"virtuals":{"statusForCollection":"APPROVED","allowNotes":true,"previewImage":{"imageId":"1*QIjD685SfIfFV-xXtdIofg.jpeg","filter":"","backgroundSize":"","originalWidth":5607,"originalHeight":3738,"strategy":"resample","height":0,"width":0},"wordCount":4732,"imageCount":8,"readingTime":18.989937106918237,"subtitle":"This post is a technical presentation on how we use gRPC (and Protobuf) to build a robust client/server system.","publishedInCount":1,"usersBySocialRecommends":[],"noIndex":false,"recommends":307,"socialRecommends":[],"isBookmarked":false,"tags":[{"slug":"golang","name":"Golang","postCount":6759,"metadata":{"postCount":6759,"coverImage":{"id":"1*G4kD68gYM1J1Fu-J7qvSSA.png","originalWidth":1600,"originalHeight":480,"isFeatured":true}},"type":"Tag"},{"slug":"grpc","name":"Grpc","postCount":359,"metadata":{"postCount":359,"coverImage":{"id":"1*bldf6VALPr-8ivuvYyi4dw.png","originalWidth":1920,"originalHeight":1152,"isFeatured":true}},"type":"Tag"},{"slug":"protobuf","name":"Protobuf","postCount":142,"metadata":{"postCount":142,"coverImage":{"id":"1*YCVCaHDh86Ez9YP3VKlWrg.png","originalWidth":1347,"originalHeight":600,"isFeatured":true}},"type":"Tag"},{"slug":"tutorial","name":"Tutorial","postCount":14896,"metadata":{"postCount":14896,"coverImage":{"id":"1*J8-5VgoWtMsIJhyHAuljSw.png","originalWidth":5000,"originalHeight":3328,"backgroundSize":"","filter":"","isFeatured":true,"externalSrc":"","focusPercentX":-1,"focusPercentY":-1,"alt":"","repairedAt":0}},"type":"Tag"},{"slug":"api","name":"API","postCount":15132,"metadata":{"postCount":15132,"coverImage":{"id":"1*UeQzs8_G8_vIgt9c1Vsg1Q.gif","originalWidth":800,"originalHeight":481,"isFeatured":true}},"type":"Tag"}],"socialRecommendsCount":0,"responsesCreatedCount":9,"links":{"entries":[{"url":"https://unsplash.com/?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText","alts":[],"httpStatus":200},{"url":"http://localhost:7778/1/ping'","alts":[],"httpStatus":0},{"url":"https://en.wikipedia.org/wiki/Self-signed_certificate","alts":[],"httpStatus":200},{"url":"https://http2.github.io/","alts":[],"httpStatus":200},{"url":"https://blog.golang.org/context","alts":[],"httpStatus":200},{"url":"https://stackoverflow.com/questions/43682366/how-is-grpc-different-from-rest","alts":[],"httpStatus":200},{"url":"https://thenewstack.io/grpc-lean-mean-communication-protocol-microservices/","alts":[],"httpStatus":200},{"url":"https://golang.org/","alts":[],"httpStatus":200},{"url":"https://godoc.org/golang.org/x/net/context","alts":[],"httpStatus":200},{"url":"https://swagger.io/","alts":[],"httpStatus":200},{"url":"https://grpc.io/","alts":[],"httpStatus":200},{"url":"https://grpc.io/docs/guides/concepts.html#bidirectional-streaming-rpc","alts":[],"httpStatus":200},{"url":"https://grpc.io/blog/vendastagrpc","alts":[],"httpStatus":200},{"url":"https://godoc.org/google.golang.org/grpc/credentials","alts":[],"httpStatus":200},{"url":"https://grpc.io/about/#osp","alts":[],"httpStatus":200},{"url":"https://godoc.org/google.golang.org/grpc/credentials#PerRPCCredentials","alts":[],"httpStatus":200},{"url":"https://godoc.org/google.golang.org/grpc#UnaryServerInfo","alts":[],"httpStatus":200},{"url":"https://godoc.org/google.golang.org/grpc#Dial","alts":[],"httpStatus":200},{"url":"https://gitlab.com/pantomath-io/demo-grpc/tree/init-protobuf-definiton","alts":[],"httpStatus":404},{"url":"https://developers.google.com/protocol-buffers/","alts":[],"httpStatus":200},{"url":"https://www.openssl.org/docs/manmaster/man1/genrsa.html","alts":[],"httpStatus":200},{"url":"https://www.openssl.org/docs/manmaster/man1/","alts":[],"httpStatus":200},{"url":"https://www.openssl.org/docs/manmaster/man1/x509.html","alts":[],"httpStatus":200},{"url":"https://www.openssl.org/docs/manmaster/man1/req.html","alts":[],"httpStatus":200},{"url":"https://godoc.org/google.golang.org/grpc#UnaryInterceptor","alts":[],"httpStatus":200},{"url":"http://twitter.com/go","alts":[{"type":2,"url":"twitter://user?screen_name=go"},{"type":3,"url":"twitter://user?screen_name=go"}],"httpStatus":200},{"url":"https://github.com/grpc-ecosystem/grpc-gateway","alts":[],"httpStatus":200},{"url":"https://godoc.org/google.golang.org/grpc#UnaryHandler","alts":[],"httpStatus":200},{"url":"https://godoc.org/google.golang.org/grpc#UnaryServerInterceptor","alts":[],"httpStatus":200},{"url":"http://github.com/golang/protobuf","alts":[],"httpStatus":200},{"url":"https://developers.google.com/protocol-buffers/docs/proto3","alts":[],"httpStatus":200},{"url":"http://twitter.com/rm","alts":[{"type":2,"url":"twitter://user?screen_name=rm"},{"type":3,"url":"twitter://user?screen_name=rm"}],"httpStatus":200},{"url":"https://godoc.org/google.golang.org/grpc#WithPerRPCCredentials","alts":[],"httpStatus":200},{"url":"https://godoc.org/google.golang.org/grpc#ServerOption","alts":[],"httpStatus":200},{"url":"http://twitter.com/protoc","alts":[{"type":2,"url":"twitter://user?screen_name=protoc"},{"type":3,"url":"twitter://user?screen_name=protoc"}],"httpStatus":200},{"url":"http://twitter.com/grep","alts":[{"type":2,"url":"twitter://user?screen_name=grep"},{"type":3,"url":"twitter://user?screen_name=grep"}],"httpStatus":200},{"url":"https://gitlab.com/pantomath-io/demo-grpc/blob/init-makefile/Makefile","alts":[],"httpStatus":200},{"url":"https://gitlab.com/pantomath-io/demo-grpc/blob/init-server/server/main.go","alts":[],"httpStatus":200},{"url":"https://gitlab.com/pantomath-io/demo-grpc/tags/init-server","alts":[],"httpStatus":200},{"url":"https://gitlab.com/pantomath-io/demo-grpc/blob/init-protobuf-definition/api/api.proto","alts":[],"httpStatus":200},{"url":"https://gitlab.com/pantomath-io/demo-grpc/tree/add-ssl/cert","alts":[],"httpStatus":200},{"url":"https://gitlab.com/pantomath-io/demo-grpc/blob/add-rest/api/api.proto","alts":[],"httpStatus":200},{"url":"https://gitlab.com/pantomath-io/demo-grpc/tree/init-client","alts":[],"httpStatus":200},{"url":"https://gitlab.com/pantomath-io/demo-grpc/blob/add-rest/Makefile","alts":[],"httpStatus":200},{"url":"https://gitlab.com/pantomath-io/demo-grpc/tree/add-rest","alts":[],"httpStatus":200},{"url":"https://gitlab.com/pantomath-io/demo-grpc/blob/add-swagger/Makefile","alts":[],"httpStatus":200},{"url":"https://gitlab.com/pantomath-io/demo-grpc/tree/add-auth","alts":[],"httpStatus":200},{"url":"https://gitlab.com/pantomath-io/demo-grpc/tree/add-ssl","alts":[],"httpStatus":200},{"url":"https://gitlab.com/pantomath-io/demo-grpc/tree/add-swagger","alts":[],"httpStatus":200},{"url":"https://unsplash.com/photos/RLJnH4Mt9A0?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText","alts":[],"httpStatus":200},{"url":"https://gitlab.com/pantomath-io/demo-grpc","alts":[],"httpStatus":200},{"url":"https://unsplash.com/photos/-4AFJ5yujcE?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText","alts":[],"httpStatus":200},{"url":"https://gitlab.com/pantomath-io/demo-grpc/blob/add-rest/server/main.go","alts":[],"httpStatus":200},{"url":"https://www.digitalocean.com/community/tutorials/openssl-essentials-working-with-ssl-certificates-private-keys-and-csrs","alts":[],"httpStatus":200},{"url":"http://goo.gl/tcxtXq","alts":[],"httpStatus":200},{"url":"https://unsplash.com/photos/984e1Fk4E04?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText","alts":[],"httpStatus":200},{"url":"https://unsplash.com/photos/ETNcibiiWOs?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText","alts":[],"httpStatus":200},{"url":"https://unsplash.com/photos/6uWHZ74S5Rk?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText","alts":[],"httpStatus":200},{"url":"https://unsplash.com/photos/yri82tuk2TQ?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText","alts":[],"httpStatus":200},{"url":"https://unsplash.com/photos/nNPONh2aXeQ?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText","alts":[],"httpStatus":200},{"url":"https://unsplash.com/photos/3CS0Ne4wBPw?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText","alts":[],"httpStatus":200}],"version":"0.3","generatedAt":1515401994828},"isLockedPreviewOnly":false,"metaDescription":"","totalClapCount":2058,"sectionCount":2,"readingList":0,"topics":[]},"coverless":true,"slug":"how-we-use-grpc-to-build-a-client-server-system-in-go","translationSourcePostId":"","translationSourceCreatorId":"","isApprovedTranslation":false,"inResponseToPostId":"","inResponseToRemovedAt":0,"isTitleSynthesized":true,"allowResponses":true,"importedUrl":"","importedPublishedAt":0,"visibility":0,"uniqueSlug":"how-we-use-grpc-to-build-a-client-server-system-in-go-dd20045fa1c2","previewContent":{"bodyModel":{"paragraphs":[{"name":"68d3","type":3,"text":"How we use gRPC to build a client/server system in Go","markups":[],"alignment":1},{"name":"2de7","type":4,"text":"","markups":[{"type":3,"start":9,"end":25,"href":"https://unsplash.com/photos/6uWHZ74S5Rk?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText","title":"","rel":"","anchorType":0},{"type":3,"start":29,"end":37,"href":"https://unsplash.com/?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText","title":"","rel":"","anchorType":0}],"layout":10,"metadata":{"id":"1*QIjD685SfIfFV-xXtdIofg.jpeg","originalWidth":5607,"originalHeight":3738}}],"sections":[{"startIndex":0}]},"isFullContent":false,"subtitle":"This post is a technical presentation on how we use gRPC (and Protobuf) to build a robust client/server system."},"license":0,"inResponseToMediaResourceId":"","canonicalUrl":"https://medium.com/pantomath/how-we-use-grpc-to-build-a-client-server-system-in-go-dd20045fa1c2","approvedHomeCollectionId":"cf62d19c744","approvedHomeCollection":{"id":"cf62d19c744","name":"Pantomath","slug":"pantomath","tags":["MONITORING","GO","ENGINEERING","STARTUP"],"creatorId":"4ecb125a3651","description":"Pantomath is a cutting edge monitoring solution","shortDescription":"Pantomath is a cutting edge monitoring solution","image":{"imageId":"1*3UOXOjhNOVBhUEeFY6s-aQ.png","filter":"","backgroundSize":"","originalWidth":200,"originalHeight":200,"strategy":"resample","height":0,"width":0},"metadata":{"followerCount":128,"activeAt":1521122462343},"virtuals":{"permissions":{"canPublish":false,"canPublishAll":false,"canRepublish":false,"canRemove":false,"canManageAll":false,"canSubmit":false,"canEditPosts":false,"canAddWriters":false,"canViewStats":false,"canSendNewsletter":false,"canViewLockedPosts":false,"canViewCloaked":false,"canEditOwnPosts":false,"canBeAssignedAuthor":false,"canEnrollInHightower":false,"canLockPostsForMediumMembers":false,"canLockOwnPostsForMediumMembers":false},"isSubscribed":false,"isNewsletterSubscribed":false,"isEnrolledInHightower":false,"isEligibleForHightower":false,"mediumNewsletterId":"","isSubscribedToMediumNewsletter":false},"logo":{"imageId":"1*pDRgSnGnZl4rzF0vBdo1FA.png","filter":"","backgroundSize":"","originalWidth":1535,"originalHeight":600,"strategy":"resample","height":0,"width":0},"twitterUsername":"pantomathIO","publicEmail":"hello@pantomath.io","collectionMastheadId":"4403e3a280d8","sections":[{"type":2,"collectionHeaderMetadata":{"title":"Pantomath","description":"Cutting edge monitoring","backgroundImage":{"id":"1*jT2Y4dK-bpqdPC-ae6s8mw.png","originalWidth":1699,"originalHeight":737},"logoImage":{},"alignment":2,"layout":6}},{"type":1,"postListMetadata":{"source":1,"layout":2,"number":7,"postIds":[]}},{"type":3,"promoMetadata":{"sectionHeader":"","promoId":"24df7b285a38"}}],"tintColor":"#FF24AAFF","lightText":false,"favicon":{"imageId":"","filter":"","backgroundSize":"","originalWidth":0,"originalHeight":0,"strategy":"resample","height":0,"width":0},"colorPalette":{"defaultBackgroundSpectrum":{"colorPoints":[{"color":"#FF0090E4","point":0},{"color":"#FF0086D1","point":0.1},{"color":"#FF087BBD","point":0.2},{"color":"#FF1771AA","point":0.3},{"color":"#FF1D6698","point":0.4},{"color":"#FF205B85","point":0.5},{"color":"#FF204F72","point":0.6},{"color":"#FF1E4360","point":0.7},{"color":"#FF1A374D","point":0.8},{"color":"#FF152A3B","point":0.9},{"color":"#FF0E1C28","point":1}],"backgroundColor":"#FFFFFFFF"},"tintBackgroundSpectrum":{"colorPoints":[{"color":"#FF24AAFF","point":0},{"color":"#FF4BB4FF","point":0.1},{"color":"#FF65BDFF","point":0.2},{"color":"#FF7BC7FF","point":0.3},{"color":"#FF8FD0FF","point":0.4},{"color":"#FFA1D9FF","point":0.5},{"color":"#FFB2E1FF","point":0.6},{"color":"#FFC3EAFF","point":0.7},{"color":"#FFD3F2FF","point":0.8},{"color":"#FFE2FAFF","point":0.9},{"color":"#FFF1FFFF","point":1}],"backgroundColor":"#FF24AAFF"},"highlightSpectrum":{"colorPoints":[{"color":"#FFE1F6FF","point":0},{"color":"#FFDBF5FF","point":0.1},{"color":"#FFD5F4FF","point":0.2},{"color":"#FFCFF3FF","point":0.3},{"color":"#FFC8F2FF","point":0.4},{"color":"#FFC2F1FF","point":0.5},{"color":"#FFBBF0FF","point":0.6},{"color":"#FFB3EFFF","point":0.7},{"color":"#FFACEEFF","point":0.8},{"color":"#FFA4ECFF","point":0.9},{"color":"#FF9BEBFF","point":1}],"backgroundColor":"#FFFFFFFF"}},"navItems":[],"colorBehavior":1,"instantArticlesState":0,"acceleratedMobilePagesState":0,"ampLogo":{"imageId":"","filter":"","backgroundSize":"","originalWidth":0,"originalHeight":0,"strategy":"resample","height":0,"width":0},"header":{"title":"Pantomath","description":"Cutting edge monitoring","backgroundImage":{"id":"1*jT2Y4dK-bpqdPC-ae6s8mw.png","originalWidth":1699,"originalHeight":737},"logoImage":{},"alignment":2,"layout":6},"type":"Collection"},"newsletterId":"","webCanonicalUrl":"https://medium.com/pantomath/how-we-use-grpc-to-build-a-client-server-system-in-go-dd20045fa1c2","mediumUrl":"https://medium.com/pantomath/how-we-use-grpc-to-build-a-client-server-system-in-go-dd20045fa1c2","migrationId":"","notifyFollowers":true,"notifyTwitter":true,"notifyFacebook":false,"responseHiddenOnParentPostAt":0,"isSeries":false,"isSubscriptionLocked":false,"seriesLastAppendedAt":0,"audioVersionDurationSec":0,"sequenceId":"","isNsfw":false,"isEligibleForRevenue":false,"isBlockedFromHightower":false,"deletedAt":0,"lockedPostSource":0,"hightowerMinimumGuaranteeStartsAt":0,"hightowerMinimumGuaranteeEndsAt":0,"featureLockRequestAcceptedAt":0,"mongerRequestType":1,"layerCake":0,"socialTitle":"","socialDek":"","editorialPreviewTitle":"","editorialPreviewDek":"","curationEligibleAt":0,"isProxyPost":false,"proxyPostFaviconUrl":"","proxyPostProviderName":"","proxyPostType":0,"type":"Post"},"mentionedUsers":[{"userId":"177d8b64f64f","name":"Charles Francoise","username":"loderunnr","createdAt":1468831312073,"imageId":"1*q2ZP7XViiOd73C53wrNaBQ.png","backgroundImageId":"","bio":"I write code, I cook food, I make music, I sometimes write about these things.","twitterScreenName":"loderunnr","facebookAccountId":"","allowNotes":1,"mediumMemberAt":0,"isNsfw":false,"isWriterProgramEnrolled":true,"isQuarantined":false,"type":"User"}],"collaborators":[],"hideMeter":false,"collectionUserRelations":[],"mode":null,"references":{"User":{"2f5a2cbeb497":{"userId":"2f5a2cbeb497","name":"Julien Andrieux","username":"chilladx","createdAt":1451376456948,"imageId":"1*uZ56OzX2vlJdTqfmMIruUg.jpeg","backgroundImageId":"","bio":"CTO & Entrepreneur, trying-to-be digital nomad, learner","twitterScreenName":"chilladx","socialStats":{"userId":"2f5a2cbeb497","usersFollowedCount":39,"usersFollowedByCount":185,"type":"SocialStats"},"social":{"userId":"95d118929b4b","targetUserId":"2f5a2cbeb497","type":"Social"},"facebookAccountId":"","allowNotes":1,"mediumMemberAt":0,"isNsfw":false,"isWriterProgramEnrolled":true,"isQuarantined":false,"type":"User"}},"Collection":{"cf62d19c744":{"id":"cf62d19c744","name":"Pantomath","slug":"pantomath","tags":["MONITORING","GO","ENGINEERING","STARTUP"],"creatorId":"4ecb125a3651","description":"Pantomath is a cutting edge monitoring solution","shortDescription":"Pantomath is a cutting edge monitoring solution","image":{"imageId":"1*3UOXOjhNOVBhUEeFY6s-aQ.png","filter":"","backgroundSize":"","originalWidth":200,"originalHeight":200,"strategy":"resample","height":0,"width":0},"metadata":{"followerCount":128,"activeAt":1521122462343},"virtuals":{"permissions":{"canPublish":false,"canPublishAll":false,"canRepublish":false,"canRemove":false,"canManageAll":false,"canSubmit":false,"canEditPosts":false,"canAddWriters":false,"canViewStats":false,"canSendNewsletter":false,"canViewLockedPosts":false,"canViewCloaked":false,"canEditOwnPosts":false,"canBeAssignedAuthor":false,"canEnrollInHightower":false,"canLockPostsForMediumMembers":false,"canLockOwnPostsForMediumMembers":false},"isSubscribed":false,"isNewsletterSubscribed":false,"isEnrolledInHightower":false,"isEligibleForHightower":false,"mediumNewsletterId":"","isSubscribedToMediumNewsletter":false},"logo":{"imageId":"1*pDRgSnGnZl4rzF0vBdo1FA.png","filter":"","backgroundSize":"","originalWidth":1535,"originalHeight":600,"strategy":"resample","height":0,"width":0},"twitterUsername":"pantomathIO","publicEmail":"hello@pantomath.io","collectionMastheadId":"4403e3a280d8","sections":[{"type":2,"collectionHeaderMetadata":{"title":"Pantomath","description":"Cutting edge monitoring","backgroundImage":{"id":"1*jT2Y4dK-bpqdPC-ae6s8mw.png","originalWidth":1699,"originalHeight":737},"logoImage":{},"alignment":2,"layout":6}},{"type":1,"postListMetadata":{"source":1,"layout":2,"number":7,"postIds":[]}},{"type":3,"promoMetadata":{"sectionHeader":"","promoId":"24df7b285a38"}}],"tintColor":"#FF24AAFF","lightText":false,"favicon":{"imageId":"","filter":"","backgroundSize":"","originalWidth":0,"originalHeight":0,"strategy":"resample","height":0,"width":0},"colorPalette":{"defaultBackgroundSpectrum":{"colorPoints":[{"color":"#FF0090E4","point":0},{"color":"#FF0086D1","point":0.1},{"color":"#FF087BBD","point":0.2},{"color":"#FF1771AA","point":0.3},{"color":"#FF1D6698","point":0.4},{"color":"#FF205B85","point":0.5},{"color":"#FF204F72","point":0.6},{"color":"#FF1E4360","point":0.7},{"color":"#FF1A374D","point":0.8},{"color":"#FF152A3B","point":0.9},{"color":"#FF0E1C28","point":1}],"backgroundColor":"#FFFFFFFF"},"tintBackgroundSpectrum":{"colorPoints":[{"color":"#FF24AAFF","point":0},{"color":"#FF4BB4FF","point":0.1},{"color":"#FF65BDFF","point":0.2},{"color":"#FF7BC7FF","point":0.3},{"color":"#FF8FD0FF","point":0.4},{"color":"#FFA1D9FF","point":0.5},{"color":"#FFB2E1FF","point":0.6},{"color":"#FFC3EAFF","point":0.7},{"color":"#FFD3F2FF","point":0.8},{"color":"#FFE2FAFF","point":0.9},{"color":"#FFF1FFFF","point":1}],"backgroundColor":"#FF24AAFF"},"highlightSpectrum":{"colorPoints":[{"color":"#FFE1F6FF","point":0},{"color":"#FFDBF5FF","point":0.1},{"color":"#FFD5F4FF","point":0.2},{"color":"#FFCFF3FF","point":0.3},{"color":"#FFC8F2FF","point":0.4},{"color":"#FFC2F1FF","point":0.5},{"color":"#FFBBF0FF","point":0.6},{"color":"#FFB3EFFF","point":0.7},{"color":"#FFACEEFF","point":0.8},{"color":"#FFA4ECFF","point":0.9},{"color":"#FF9BEBFF","point":1}],"backgroundColor":"#FFFFFFFF"}},"navItems":[],"colorBehavior":1,"instantArticlesState":0,"acceleratedMobilePagesState":0,"ampLogo":{"imageId":"","filter":"","backgroundSize":"","originalWidth":0,"originalHeight":0,"strategy":"resample","height":0,"width":0},"header":{"title":"Pantomath","description":"Cutting edge monitoring","backgroundImage":{"id":"1*jT2Y4dK-bpqdPC-ae6s8mw.png","originalWidth":1699,"originalHeight":737},"logoImage":{},"alignment":2,"layout":6},"type":"Collection"}},"Social":{"2f5a2cbeb497":{"userId":"95d118929b4b","targetUserId":"2f5a2cbeb497","type":"Social"}},"SocialStats":{"2f5a2cbeb497":{"userId":"2f5a2cbeb497","usersFollowedCount":39,"usersFollowedByCount":185,"type":"SocialStats"}}}})
// ]]></script><script>window.PARSELY = window.PARSELY || { autotrack: false }</script><script id="parsely-cfg" src="./How we use gRPC to build a client_server system in Go_files/p.js.download"></script><script type="text/javascript">(function(b,r,a,n,c,h,_,s,d,k){if(!b[n]||!b[n]._q){for(;s<_.length;)c(h,_[s++]);d=r.createElement(a);d.async=1;d.src="https://cdn.branch.io/branch-latest.min.js";k=r.getElementsByTagName(a)[0];k.parentNode.insertBefore(d,k);b[n]=h}})(window,document,"script","branch",function(b,r){b[r]=function(){b._q.push([r,arguments])}},{_q:[],_v:1},"addListener applyCode autoAppIndex banner closeBanner closeJourney creditHistory credits data deepview deepviewCta first getCode init link logout redeem referrals removeListener sendSMS setBranchViewData setIdentity track validateCode trackCommerceEvent logEvent".split(" "), 0); branch.init('key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm', {'no_journeys': true, 'disable_exit_animation': true, 'disable_entry_animation': true, 'tracking_disabled':  false }, function(err, data) {});</script><div class="surface-scrollOverlay"></div><script charset="UTF-8" src="./How we use gRPC to build a client_server system in Go_files/main-common-async.bundle.6Y8HS1nZY2Zfeh0AFBQAyQ.js.download"></script><script charset="UTF-8" src="./How we use gRPC to build a client_server system in Go_files/main-notes.bundle.b0dpuNbavMdh8ZXWT4j2Aw.js.download"></script></body></html>